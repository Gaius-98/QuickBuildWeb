var W=Object.defineProperty;var H=(l,e,t)=>e in l?W(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t;var w=(l,e,t)=>(H(l,typeof e!="symbol"?e+"":e,t),t);import{_ as J}from"./CodeEditor.vue_vue_type_script_setup_true_name_EvCode_lang-1fkh9THP.js";import{R as X,V as Y,g as k,C as E,r as h,o as s,t as g,l as b,w as v,M as C,T as U,h as m,i as d,U as Q,W as Z,J as R,K as I,O as D,X as V,D as S,Y as M,$,a0 as ee,E as te,L as N,H as q,a1 as ae,a2 as ne,a3 as L,a4 as B,a5 as oe,a6 as le,a7 as se,a8 as ce,a9 as ue,aa as ie,ab as re,x as j,ac as A,ad as de,F as pe}from"./.pnpm-Df0qOu1O.js";import{_ as T}from"./_plugin-vue_export-helper-DlAUqK2U.js";class _e{constructor(e){w(this,"state",{});e&&(this.state=e)}getValue(e){const{_value:t,_mode:n,_dynExp:a}=e;return n==="static"?t:this.resolveDynamicValue(a)}createDynamicConfigData(e){return{_value:e||"",_mode:"static",_dynExp:""}}resolveDynamicValue(e){try{return new Function("state",`return ${e}`)(this.state)}catch(t){return console.error("评估动态表达式时出错:",t),null}}isDynamicConfigData(e){return typeof e=="object"&&e!==null&&["static","dynamic"].includes(e._mode)}processObject(e){const t=X(e);if(Array.isArray(t))return t.map(n=>this.processObject(n));if(typeof t=="object"&&t!==null){const n={};for(const a in t){const o=t[a];this.isDynamicConfigData(o)?n[a]=this.getValue(o):typeof o=="object"&&o!==null?n[a]=this.processObject(o):n[a]=o}return n}else return t}}class me{constructor(e){w(this,"libs");w(this,"scripts",[]);w(this,"styles",[]);w(this,"componentsMap",new Map);w(this,"components",{});this.libs=e,this.init()}init(){window.Vue||(window.Vue=Y),this.handleLibs(),this.handleUrls()}handleUrls(){this.libs.map(t=>t.urls).flat().forEach(t=>{t.endsWith("js")?this.scripts.push(t):t.endsWith("css")&&this.styles.push(t)})}load(){return new Promise((e,t)=>{Promise.allSettled([...this.styles.map(n=>this.loadStyle(n)),...this.scripts.map(n=>this.loadScript(n))]).then(()=>{this.registerComponents(),e(this.components)}).catch(n=>{t(n)})})}registerComponents(){for(const[e,t]of this.componentsMap)Array.isArray(t)?t.forEach(n=>{this.components[n.componentName]=window[e][n.exportName]}):this.components[t.componentName]=window[t.exportName]}handleLibChildren(e){const t=e.children.map(n=>({exportName:n.exportName,componentName:n.componentName}));this.componentsMap.set(e.exportName,t)}handleLibs(e=this.libs){e.forEach(t=>{this.isLibTree(t)?this.handleLibChildren(t):this.componentsMap.set(t.exportName,{exportName:t.exportName,componentName:t.componentName})})}isLibTree(e){return"children"in e}loadScript(e){return new Promise((t,n)=>{const a=document.createElement("script");a.src=e,a.async=!1,a.onload=t,a.onerror=n,document.body.appendChild(a)})}loadStyle(e){return new Promise((t,n)=>{const a=document.createElement("link");a.rel="stylesheet",a.href=e,a.onload=t,a.onerror=n,document.head.appendChild(a)})}}const ve={class:"config-array"},ye=k({__name:"ConfigArray",props:{title:{default:"标题"},closable:{type:Boolean,default:!0},schema:{default:()=>({})},data:{}},setup(l){const e=l,{title:t,closable:n,data:a}=E(e),o=h(0),f=()=>{o.value=a.value.length||0,a.value.push({})},u=c=>{let p=0;a.value.forEach((r,y)=>{r.key===c&&(p=y-1)}),a.value=a.value.filter(r=>r.key!==c),a.value.length&&o.value===c&&(p>=0?o.value=a.value[p].key:o.value=a.value[0].key)},i=(c,p)=>{p==="add"?f():u(c)};return(c,p)=>{const r=Q,y=Z;return s(),g("div",ve,[b(y,{activeKey:o.value,"onUpdate:activeKey":p[0]||(p[0]=_=>o.value=_),type:"editable-card",onEdit:i,class:"config-array-tab",size:"small"},{default:v(()=>[(s(!0),g(C,null,U(d(a),(_,x)=>(s(),m(r,{key:x+1,tab:`${d(t)}${x+1}`,closable:d(n)},{default:v(()=>[b(O,{schema:c.schema,data:d(a)[x],"onUpdate:data":z=>d(a)[x]=z},null,8,["schema","data","onUpdate:data"])]),_:2},1032,["tab","closable"]))),128))]),_:1},8,["activeKey"])])}}}),fe=S("div",{class:"iconfont icon-brackets-curly"},null,-1),F=k({__name:"ConfigInput",props:R({compact:{type:Boolean,default:!0},size:{default:"default"}},{data:{required:!0,default:{_value:"",_mode:"static",_dynExp:""}},dataModifiers:{}}),emits:["update:data"],setup(l){const e=I(l,"data"),t=l,{size:n,compact:a}=E(t),o=D(()=>e.value._mode==="dynamic"),f=()=>{e.value._mode=e.value._mode==="dynamic"?"static":"dynamic"},u=i=>{e.value._mode==="dynamic"?e.value._dynExp=i.target.value:e.value._value=i.target.value};return(i,c)=>{const p=M,r=$,y=ee;return s(),m(y,{size:d(n),compact:d(a)},{default:v(()=>[b(p,V({value:o.value?e.value._dynExp:e.value._value,onChange:u,style:{width:"calc(100% - 35px)"},prefix:o.value?"{":"",suffix:o.value?"}":""},i.$attrs),null,16,["value","prefix","suffix"]),b(r,{title:o.value?`绑定中:${e.value._dynExp}`:"变量绑定",type:o.value?"primary":"",onClick:c[0]||(c[0]=_=>f())},{icon:v(()=>[fe]),_:1},8,["title","type"])]),_:1},8,["size","compact"])}}}),he=l=>(L("data-v-8fc419f7"),l=l(),B(),l),be={class:"config-radio"},ge=he(()=>S("div",{class:"iconfont icon-brackets-curly"},null,-1)),xe=k({__name:"ConfigRadio",props:R({options:{default:()=>[]},fields:{default:()=>({label:"label",value:"value",title:"title"})},icon:{type:Boolean,default:!1}},{data:{required:!0,default:{_value:"",_mode:"static",_dynExp:""}},dataModifiers:{}}),emits:["update:data"],setup(l){const e=I(l,"data"),t=l,{options:n,fields:a}=E(t),o=D(()=>e.value._mode==="dynamic"),f=()=>{e.value._mode=e.value._mode==="dynamic"?"static":"dynamic"};return(u,i)=>{const c=ae,p=ne,r=M,y=$;return s(),g("div",be,[o.value?(s(),m(r,{key:1,value:e.value._dynExp,"onUpdate:value":i[1]||(i[1]=_=>e.value._dynExp=_),style:{width:"calc(100% - 35px)"},prefix:"{",suffix:"}"},null,8,["value"])):(s(),m(p,V({key:0},u.$attrs,{style:{width:"calc(100% - 35px)"},value:e.value._value,"onUpdate:value":i[0]||(i[0]=_=>e.value._value=_),"button-style":"solid"}),{default:v(()=>[(s(!0),g(C,null,U(d(n),_=>(s(),m(c,{key:_[d(a).value],title:_[d(a).title]||_[d(a).label],value:_[d(a).value]},{default:v(()=>[u.icon?(s(),g("div",{key:0,class:te(["iconfont",_.label])},null,2)):(s(),g(C,{key:1},[N(q(_[d(a).label]),1)],64))]),_:2},1032,["title","value"]))),128))]),_:1},16,["value"])),b(y,{title:o.value?`绑定中:${e.value._dynExp}`:"变量绑定",type:o.value?"primary":"",onClick:i[2]||(i[2]=_=>f())},{icon:v(()=>[ge]),_:1},8,["title","type"])])}}}),ke=T(xe,[["__scopeId","data-v-8fc419f7"]]),we=l=>(L("data-v-dcd1c0f1"),l=l(),B(),l),Ce={class:"config-select"},Ee=we(()=>S("div",{class:"iconfont icon-brackets-curly"},null,-1)),Se=k({__name:"ConfigSelect",props:{data:{required:!0,default:{_value:"",_mode:"static",_dynExp:""}},dataModifiers:{}},emits:["update:data"],setup(l){const e=I(l,"data"),t=D(()=>e.value._mode==="dynamic"),n=()=>{e.value._mode=e.value._mode==="dynamic"?"static":"dynamic"};return(a,o)=>{const f=oe,u=M,i=$;return s(),g("div",Ce,[t.value?(s(),m(u,{key:1,value:e.value._dynExp,"onUpdate:value":o[1]||(o[1]=c=>e.value._dynExp=c),style:{width:"calc(100% - 35px)"},prefix:"{",suffix:"}"},null,8,["value"])):(s(),m(f,V({key:0,style:{width:"calc(100% - 35px)"}},a.$attrs,{value:e.value._value,"onUpdate:value":o[0]||(o[0]=c=>e.value._value=c)}),null,16,["value"])),b(i,{title:t.value?`绑定中:${e.value._dynExp}`:"变量绑定",type:t.value?"primary":"",onClick:o[2]||(o[2]=c=>n())},{icon:v(()=>[Ee]),_:1},8,["title","type"])])}}}),$e=T(Se,[["__scopeId","data-v-dcd1c0f1"]]),Ne=l=>(L("data-v-4206e5c3"),l=l(),B(),l),je={class:"config-switch"},Ie=Ne(()=>S("div",{class:"iconfont icon-brackets-curly"},null,-1)),De=k({__name:"ConfigSwitch",props:{data:{required:!0,default:{__value:!1,_mode:"static",_dynExp:""}},dataModifiers:{}},emits:["update:data"],setup(l){const e=I(l,"data"),t=D(()=>e.value._mode==="dynamic"),n=()=>{e.value._mode=e.value._mode==="dynamic"?"static":"dynamic"};return(a,o)=>{const f=le,u=M,i=$;return s(),g("div",je,[t.value?(s(),m(u,{key:1,value:e.value._dynExp,"onUpdate:value":o[1]||(o[1]=c=>e.value._dynExp=c),style:{width:"calc(100% - 35px)"},prefix:"{",suffix:"}"},null,8,["value"])):(s(),m(f,V({key:0},a.$attrs,{checked:e.value._value,"onUpdate:checked":o[0]||(o[0]=c=>e.value._value=c)}),null,16,["checked"])),b(i,{title:t.value?`绑定中:${e.value._dynExp}`:"变量绑定",type:t.value?"primary":"",onClick:o[2]||(o[2]=c=>n())},{icon:v(()=>[Ie]),_:1},8,["title","type"])])}}}),Ve=T(De,[["__scopeId","data-v-4206e5c3"]]),Me={class:"config-array"},Ue=k({__name:"ConfigObject",props:{title:{default:"标题"},field:{default:""},schema:{default:()=>({})},data:{}},setup(l){const e=l,{title:t,field:n,data:a}=E(e),o=se()+n.value;return(f,u)=>{const i=ue,c=ie;return s(),g("div",Me,[b(c,null,{default:v(()=>[(s(),m(i,{key:o,header:d(t)},{default:v(()=>[b(O,{schema:f.schema,data:d(a),"onUpdate:data":u[0]||(u[0]=p=>ce(a)?a.value=p:null)},null,8,["schema","data"])]),_:1},8,["header"]))]),_:1})])}}}),O=k({__name:"ConfigForm",props:{schema:{default:()=>({})},data:{default:()=>({})}},setup(l){const e=l,{schema:t,data:n}=E(e),a=()=>{Object.keys(t.value).forEach(u=>{n.value[u]||(n.value[u]=o(t.value[u].type))})},o=u=>{switch(u){case"array":return[];case"object":return{};case"input":case"select":case"radio":return{_value:"",_mode:"static",_dynExp:""};case"switch":return{_value:!1,_mode:"static",_dynExp:""};default:return{_value:"",_mode:"static",_dynExp:""}}};a();const f=u=>{switch(u){case"input":return F;case"radio":return ke;case"select":return $e;case"switch":return Ve;default:return F}};return(u,i)=>{const c=de,p=re;return s(),m(p,{model:d(n)},{default:v(()=>[(s(!0),g(C,null,U(d(t),(r,y)=>(s(),g(C,{key:y},[r.type!=="object"?(s(),m(c,{key:0,label:r.label,name:y},{default:v(()=>[r.type==="array"?(s(),m(ye,{key:0,schema:r.items,data:d(n)[y]},null,8,["schema","data"])):(s(),m(j(f(r.type)),{key:1,data:d(n)[y],"onUpdate:data":_=>d(n)[y]=_},null,40,["data","onUpdate:data"]))]),_:2},1032,["label","name"])):A("",!0),r.type==="object"?(s(),m(Ue,{key:1,schema:r.properties,data:d(n)[y],title:r.label},null,8,["schema","data","title"])):A("",!0)],64))),128))]),_:1},8,["model"])}}}),ze=k({__name:"HomeView",setup(l){const e=h({}),t=h({input:{type:"input",label:"输入框"},select:{type:"select",label:"选择框"},arr:{type:"array",label:"数组",items:{title:{type:"input",label:"标题"}}},arr2:{type:"array",label:"数组",items:{test:{type:"input",label:"测试"}}},test:{type:"object",label:"测试对象",properties:{a:{type:"input",label:"a"},b:{type:"input",label:"b"}}}}),n=h({string:"配置表单",arr:[1,2,3,4],number:125654});h([{label:"1",value:"1"},{label:"2",value:"2"}]),h([{label:"icon-lock1",value:"1",title:"锁定"},{label:"icon-unlock1",value:"2",title:"解锁"}]);const a=h(!1),o=()=>{a.value=!0},f=()=>{new _e(n.value).processObject(e.value)},u=h("测试");h({package:"ConfigInput",version:"",exportName:"",main:"",cdn:"",componentName:""});const i=[{title:"element",package:"element-plus",version:"1.0.2",exportName:"ElementPlus",urls:["https://cdn.jsdelivr.net/npm/element-plus@2.9.2/dist/index.full.min.js","https://cdn.jsdelivr.net/npm/element-plus@2.9.2/dist/index.min.css"],children:[{componentName:"ElButton",exportName:"ElButton"},{componentName:"ElInput",exportName:"ElInput"}]},{title:"",package:"drag-grid-layout-v3",version:"1.0.0",exportName:"drag-grid-layout-v3",children:[{componentName:"GridLayout",exportName:"GridLayout"}],urls:["https://cdn.jsdelivr.net/npm/drag-grid-layout-v3@0.0.4/lib/drag-grid-layout-v3.umd.js","https://cdn.jsdelivr.net/npm/drag-grid-layout-v3@0.0.4/lib/style.css"]}],c=h(),p=h(),r=h(),y=new me(i),_=h([{key:1,id:1,rowStart:1,colStart:1,rowSpan:20,colSpan:3,extra:{color:"red"}},{key:1,id:2,rowStart:2,colStart:4,rowSpan:40,colSpan:2,extra:{color:"blue"}},{key:1,id:3,rowStart:4,colStart:6,rowSpan:10,colSpan:5,extra:{color:"pink"}},{key:1,id:4,rowStart:5,colStart:1,rowSpan:30,colSpan:6,extra:{color:"green"}}]);return y.load().then(x=>{c.value=x.ElButton,p.value=x.ElInput,r.value=x.GridLayout}),(x,z)=>{const K=J,G=$;return s(),g(C,null,[b(K,{value:JSON.stringify(n.value,null,4),disabled:""},null,8,["value"]),b(O,{data:e.value,schema:t.value},null,8,["data","schema"]),b(G,{onClick:o},{default:v(()=>[N("配置项")]),_:1}),b(G,{onClick:f},{default:v(()=>[N("数据")]),_:1}),(s(),m(j(c.value),{type:"success"},{default:v(()=>[N("el")]),_:1})),(s(),m(j(p.value),{placeholder:"请输入内容",Value:u.value},null,8,["Value"])),(s(),m(j(r.value),{placeholder:"请输入内容",list:_.value},{"layout-item":v(({item:P})=>[S("div",{style:pe({backgroundColor:P.extra.color,width:"100%",height:"100%"})},q(P),5)]),_:1},8,["list"]))],64)}}});export{ze as default};
