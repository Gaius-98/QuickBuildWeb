import{g as $,r as P,o as l,A as S,K as M,F as L,R,h as i,w as f,a4 as ce,am as qe,an as Ke,C as V,P as Y,aQ as X,t as Ue,x as T,y as te,E as G,aR as pe,i as e,av as ie,aw as ue,l as v,Q as k,Y as de,D as me,v as ae,aS as fe,aT as _e,aU as be,a2 as ve,V as ye,aa as he,aV as ge,ac as Pe,aW as we,aX as Ce,ao as De,X as Be,a1 as x,a3 as Ie,a5 as ke,f as Ee,aY as Ne,e as Re,m as Ye,aL as Ge,s as O,aZ as J,B as Oe,H as se,a_ as Qe,a$ as Xe,b0 as He,b1 as We,aG as Ze,b2 as je,ax as Je,N as eo,b3 as oo,$ as to,b4 as ao,a0 as lo,b5 as ro,a6 as no}from"./.pnpm-Bqj5ZitX.js";import{_ as H}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{g as q,s as K,c as xe,u as so,d as co}from"./index-Dcam5Uk9.js";import{a as Q}from"./form-Dcbtzh_u.js";import{S as oe}from"./SchemaForm-T2B-CJGP.js";import{d as ee}from"./dict-B8wzmY-C.js";const Se=s=>(qe("data-v-537542b9"),s=s(),Ke(),s),po={class:"material-area"},io={class:"material-layout-area"},uo=Se(()=>M("div",{class:"title"},"布局组件",-1)),mo={class:"content"},fo={class:"material-data-area"},_o=Se(()=>M("div",{class:"title"},"基础组件",-1)),bo={class:"content"},vo=$({__name:"MaterialArea",setup(s){const c=P({layoutMaterials:[{label:"栅格",value:"grid"},{label:"卡片",value:"card"},{label:"分割线",value:"divider"},{label:"折叠框",value:"collapse"}],dataMaterials:[{label:"输入框",value:"input"},{label:"选择器",value:"select"},{label:"日期选择器",value:"date"},{label:"数字输入框",value:"number"},{label:"开关",value:"switch"},{label:"单选框",value:"radio"},{label:"多选框",value:"checkbox"},{label:"文本域",value:"textarea"}]}),t=o=>{var u;const r=o.target;(u=o.dataTransfer)==null||u.setData("material",r.dataset.material)};return(o,r)=>{const u=ce;return l(),S("div",po,[M("div",io,[uo,M("div",mo,[(l(!0),S(L,null,R(c.value.layoutMaterials,_=>(l(),i(u,{type:"dashed",key:_.value,draggable:"true",onDragstart:t,"data-material":_.value},{default:f(()=>[V(Y(_.label),1)]),_:2},1032,["data-material"]))),128))])]),M("div",fo,[_o,M("div",bo,[(l(!0),S(L,null,R(c.value.dataMaterials,_=>(l(),i(u,{type:"dashed",key:_.value,draggable:"true",onDragstart:t,"data-material":_.value},{default:f(()=>[V(Y(_.label),1)]),_:2},1032,["data-material"]))),128))])])])}}}),yo=H(vo,[["__scopeId","data-v-537542b9"]]),U={formItemProp:{label:"",name:"",required:!1},show:void 0},ho={...U,controlProp:{allowClear:!0,bordered:!0,disabled:!1,maxlength:null,size:"middle"},type:"input",id:""},go={...U,controlProp:{allowClear:!0,autosize:!1,disabled:!1,maxlength:null,size:"middle"},type:"textarea",id:""},Po={...U,controlProp:{allowClear:!0,bordered:!0,disabled:!1,mode:null,size:"middle",virtual:!0},type:"select",id:""},wo={...U,controlProp:{disabled:!1,size:"middle"},type:"switch",id:""},Co={...U,controlProp:{disabled:!1,size:"middle",buttonStyle:"solid",optionType:"button"},type:"radio",id:""},Do={...U,controlProp:{disabled:!1},type:"checkbox",id:""},Io={...U,controlProp:{allowClear:!1,bordered:!0,disabled:!1,format:"YYYY-MM-DD",mode:"",valueFormat:"YYYY-MM-DD",size:"middle",picker:""},type:"date",id:""},ko={...U,controlProp:{disabled:!1,size:"middle",bordered:!0,controls:!0,max:null,min:null,precision:null,step:1},type:"number",id:""},xo={type:"grid",controlProp:{gutter:0,colNumber:2,children:[]},id:"",show:void 0},So={type:"card",controlProp:{title:"",bordered:!0,hoverable:!1,children:[]},id:"",show:void 0},$o={type:"divider",controlProp:{type:"horizontal",plain:!1,orientation:"left",dashed:!1,title:""},id:"",show:void 0},Mo={type:"collapse",controlProp:{bordered:!0,ghost:!1,header:"折叠面板",showArrow:!0,defaultExpanded:!0,children:[]},id:"",show:void 0},Vo=[ho,wo,Po,Co,Do,xo,So,Io,ko,$o,Mo,go],Lo=()=>"field"+new Date().getTime().toString().slice(-4),To=(s,c)=>{const t=Vo.find(o=>o.type===s);if(t){const o=X(t);if(o.formItemProp){const r=Lo();o.formItemProp.label=r,o.formItemProp.name=r}return o.id=new Date().getTime().toString(),{...o,...c}}else throw new Error(`ControlDefault中${s}不存在,加载配置失败。`)},Fo=$({__name:"MaterialGrid",props:Ue({gutter:{},colNumber:{}},{children:{required:!0},childrenModifiers:{}}),emits:["update:children"],setup(s){const c=s,{gutter:t,colNumber:o}=T(c),r=te(s,"children"),u=G(()=>24/o.value);return pe(()=>o.value,()=>{r.value?r.value.length>o.value?r.value=r.value.slice(0,o.value):r.value=r.value.concat(Array.from({length:o.value-r.value.length}).map(()=>[])):r.value=Array.from({length:o.value}).map(()=>[])},{immediate:!0}),(_,y)=>{const d=ie,b=ue;return l(),i(b,{gutter:e(t)},{default:f(()=>[(l(!0),S(L,null,R(r.value,(h,w)=>(l(),i(d,{class:"gutter-col",span:u.value,key:w},{default:f(()=>[(l(),i(Z,{modelValue:r.value[w],"onUpdate:modelValue":g=>r.value[w]=g,key:w},null,8,["modelValue","onUpdate:modelValue"]))]),_:2},1032,["span"]))),128))]),_:1},8,["gutter"])}}}),Ao=H(Fo,[["__scopeId","data-v-bd13b1ec"]]),zo=$({__name:"MaterialCard",props:{children:{required:!0},childrenModifiers:{}},emits:["update:children"],setup(s){const c=te(s,"children");return(t,o)=>{const r=de;return l(),i(r,k(t.$attrs,{bodyStyle:{padding:0,"min-height":"40px"}}),{default:f(()=>[v(Z,{modelValue:c.value,"onUpdate:modelValue":o[0]||(o[0]=u=>c.value=u)},null,8,["modelValue"])]),_:1},16)}}}),qo=$({__name:"MaterialDivider",props:{type:{},plain:{type:Boolean},orientation:{},dashed:{type:Boolean},title:{}},setup(s){const c=s,{title:t,dashed:o,orientation:r,plain:u,type:_}=T(c);return(y,d)=>{const b=me;return l(),i(b,{dashed:e(o),orientation:e(r),plain:e(u),type:e(_)},{default:f(()=>[V(Y(e(t)),1)]),_:1},8,["dashed","orientation","plain","type"])}}}),Ko=$({__name:"MaterialCollapse",props:{bordered:{type:Boolean},ghost:{type:Boolean},title:{},showArrow:{type:Boolean},defaultExpanded:{type:Boolean},children:{}},setup(s){const c=s,{title:t,showArrow:o,bordered:r,ghost:u,defaultExpanded:_,children:y}=T(c),d=P(""),b=P(ae());return _.value&&(d.value=b.value),(h,w)=>{const g=_e,n=be;return l(),i(n,{activeKey:d.value,"onUpdate:activeKey":w[1]||(w[1]=m=>d.value=m),bordered:e(r),ghost:e(u)},{default:f(()=>[(l(),i(g,{key:b.value,header:e(t),showArrow:e(o)},{default:f(()=>[v(Z,{modelValue:e(y),"onUpdate:modelValue":w[0]||(w[0]=m=>fe(y)?y.value=m:null)},null,8,["modelValue"])]),_:1},8,["header","showArrow"]))]),_:1},8,["activeKey","bordered","ghost"])}}}),Uo={input:ve,select:ye,radio:he,switch:ge,number:Pe,checkbox:we,grid:Ao,card:zo,date:Ce,divider:qo,collapse:Ko,textarea:De},Bo=$({__name:"LowCodeCard",props:{schema:{},formData:{}},setup(s){const c=s,{schema:t,formData:o}=T(c);return(r,u)=>{const _=de;return l(),i(_,{bodyStyle:{padding:0,"min-height":"40px"},title:e(t).controlProp.title,bordered:e(t).controlProp.bordered,hoverable:e(t).controlProp.hoverable},{default:f(()=>[v(W,{schema:e(t).controlProp.children,formData:e(o)},null,8,["schema","formData"])]),_:1},8,["title","bordered","hoverable"])}}}),Eo=$({__name:"LowCodeGrid",props:{schema:{},formData:{}},setup(s){const c=s,{schema:t,formData:o}=T(c),r=G(()=>24/t.value.controlProp.colNumber);return(u,_)=>{const y=ie,d=ue;return l(),i(d,{gutter:e(t).controlProp.gutter},{default:f(()=>[(l(!0),S(L,null,R(e(t).controlProp.children,(b,h)=>(l(),i(y,{class:"gutter-col",span:r.value,key:h},{default:f(()=>[v(W,{schema:b,formData:e(o)},null,8,["schema","formData"])]),_:2},1032,["span"]))),128))]),_:1},8,["gutter"])}}}),No=$({__name:"LowCodeCollapse",props:{schema:{},formData:{}},setup(s){const c=s,{schema:t,formData:o}=T(c),r=P(""),u=P(ae());return t.value.controlProp.defaultExpanded.value&&(r.value=u.value),(_,y)=>{const d=_e,b=be;return l(),i(b,{activeKey:r.value,"onUpdate:activeKey":y[0]||(y[0]=h=>r.value=h),bordered:e(t).controlProp.bordered,ghost:e(t).controlProp.ghost},{default:f(()=>[(l(),i(d,{key:u.value,header:e(t).controlProp.title,showArrow:e(t).controlProp.showArrow},{default:f(()=>[v(W,{schema:e(t).controlProp.children,formData:e(o)},null,8,["schema","formData"])]),_:1},8,["header","showArrow"]))]),_:1},8,["activeKey","bordered","ghost"])}}}),W=$({__name:"LowCodeFormItem",props:{schema:{},formData:{}},setup(s){const c=s,{schema:t,formData:o}=T(c),r=P([]),u=P({});(()=>{t.value.map(d=>{"dict"in d.controlProp&&r.value.push(d.controlProp.dict)})})();const y=()=>{r.value.length>0&&xe.getDict(r.value).then(d=>{const{code:b,data:h,msg:w}=d;b==200&&r.value.map(g=>{u.value[g]=h[g]})})};return Be(()=>{y()}),(d,b)=>{const h=me,w=ve,g=De,n=ye,m=he,p=Ce,D=Pe,B=we,F=ge,E=Ie;return l(!0),S(L,null,R(e(t),a=>(l(),S(L,null,[["grid","card","collapse","divider"].includes(a.type)?(l(),S(L,{key:0},[a.type=="card"?(l(),i(Bo,{key:a.name,schema:a,formData:e(o)},null,8,["schema","formData"])):x("",!0),a.type=="grid"?(l(),i(Eo,{key:a.name,schema:a,formData:e(o)},null,8,["schema","formData"])):x("",!0),a.type=="collapse"?(l(),i(No,{key:a.name,schema:a,formData:e(o)},null,8,["schema","formData"])):x("",!0),a.type=="divider"?(l(),i(h,k({key:3},a.controlProp,{key:a.name}),{default:f(()=>[V(Y(a.controlProp.title),1)]),_:2},1040)):x("",!0)],64)):(l(),i(E,{label:a.formItemProp.label,name:a.formItemProp.name,key:a.name,required:a.formItemProp.required},{default:f(()=>[a.type=="input"?(l(),i(w,k({key:0,value:e(q)(e(o),a.formItemProp.name),onChange:C=>e(K)(e(o),a.formItemProp.name,C.target.value)},a.controlProp),null,16,["value","onChange"])):x("",!0),a.type=="textarea"?(l(),i(g,k({key:1,value:e(q)(e(o),a.formItemProp.name),onChange:C=>e(K)(e(o),a.formItemProp.name,C.target.value)},a.controlProp),null,16,["value","onChange"])):x("",!0),a.type=="select"?(l(),i(n,k({key:2,value:e(q)(e(o),a.formItemProp.name)},a.controlProp,{options:u.value[a.controlProp.dict],onChange:C=>e(K)(e(o),a.formItemProp.name,C)}),null,16,["value","options","onChange"])):x("",!0),a.type=="radio"?(l(),i(m,k({key:3,value:e(q)(e(o),a.formItemProp.name)},a.controlProp,{options:u.value[a.controlProp.dict],onChange:C=>e(K)(e(o),a.formItemProp.name,C.target.value)}),null,16,["value","options","onChange"])):x("",!0),a.type=="date"?(l(),i(p,k({key:4,value:e(q)(e(o),a.formItemProp.name)},a.controlProp,{onChange:C=>e(K)(e(o),a.formItemProp.name,C)}),null,16,["value","onChange"])):x("",!0),a.type=="number"?(l(),i(D,k({key:5,value:e(q)(e(o),a.formItemProp.name)},a.controlProp,{onChange:C=>e(K)(e(o),a.formItemProp.name,C)}),null,16,["value","onChange"])):x("",!0),a.type=="checkbox"?(l(),i(B,k({key:6,value:e(q)(e(o),a.formItemProp.name)},a.controlProp,{options:u.value[a.controlProp.dict],onChange:C=>e(K)(e(o),a.formItemProp.name,C)}),null,16,["value","options","onChange"])):x("",!0),a.type=="switch"?(l(),i(F,k({key:7,checked:e(q)(e(o),a.formItemProp.name)},a.controlProp,{onChange:C=>e(K)(e(o),a.formItemProp.name,C)}),null,16,["checked","onChange"])):x("",!0)]),_:2},1032,["label","name","required"]))],64))),256)}}}),$e=$({__name:"LowCodeForm",props:{schema:{},formData:{}},setup(s){const c=s,{schema:t,formData:o}=T(c);return(r,u)=>{const _=ke;return l(),i(_,k({model:e(o)},e(t).formConfig),{default:f(()=>[v(W,{formData:e(o),schema:e(t).formCfgItemList},null,8,["formData","schema"])]),_:1},16,["model"])}}}),le=Ee("formDesign",()=>{const s=P([]),c=P({}),t=P({}),o=P(""),r=n=>{const{id:m,schema:p,name:D,description:B,status:F,belong:E}=n;o.value=m,_.value={name:D,description:B,status:F,belong:E},s.value=p.formCfgItemList,c.value=p.formConfig},u=(n,m)=>{const p=m.findIndex(D=>D.id===n);p!=-1&&(t.value=m[p])},_=P({name:"",description:"",status:1}),y=(n,m)=>{const p=m.findIndex(D=>D.id===n);p!=-1&&m.splice(p,1)},d=()=>{const n=X(t.value);b(n);const m=n;s.value.push(m)},b=n=>{n.id=ae(),n.type=="grid"?n.controlProp.children.forEach(m=>{m.forEach(p=>{b(p)})}):n.type=="card"?n.controlProp.children.forEach(m=>{b(m)}):n.type=="collapse"&&n.controlProp.children.forEach(m=>{b(m)})},h=P(!1),w=()=>{const n=document.createElement("div");n.className="preview-form",n.style.width="720px",n.style.height="500px",n.style.overflowY="auto",n.style.padding="10px",Ye($e,{schema:{formCfgItemList:s.value,formConfig:c.value},formData:{}}).mount(n).$el,document.body.appendChild(n)};return{curControlCfg:t,formCfgItemList:s,onSelectControlItem:u,copyControlItem:d,removeControlItem:y,extraFormConfig:_,onSave:async()=>{h.value=!0;let n="";if(w(),document.querySelector(".preview-form")){const F=await Ne(document.querySelector(".preview-form"));F&&(n=F.toDataURL("image/png"),document.body.removeChild(document.querySelector(".preview-form")))}let m=Q.add;const p={schema:{formCfgItemList:s.value,formConfig:c.value},..._.value,img:n};o.value&&(m=Q.update,p.id=o.value);const{code:D,msg:B}=await m(p);D==200&&Re.success(B),h.value=!1},id:o,saveLoading:h,setFormDetail:r,formConfig:c}}),Ro=["onClick"],Yo={class:"material-util"},Go=["onClick"],Oo=$({__name:"MaterialView",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(s){Ge(g=>({"377eb23e":e(t).colorPrimary}));const c=so(),{themeCfg:t}=O(c),o=le(),{curControlCfg:r}=O(o),{onSelectControlItem:u,copyControlItem:_,removeControlItem:y}=o,d=te(s,"modelValue"),b=g=>Uo[g],h=(g,n)=>{const m=X(g);switch(n){case"radio":m.options=[{label:"1",value:"1"},{label:"2",value:"2"}];break;case"checkbox":m.options=[{label:"1",value:"1"},{label:"2",value:"2"}];break;case"select":m.options=[{label:"1",value:"1"},{label:"2",value:"2"}];break}return m},w=g=>{if(g.dataTransfer.getData("material")){const n=To(g.dataTransfer.getData("material"));d.value.push(n)}};return(g,n)=>{const m=Ie;return l(),i(e(He),{list:d.value,"onUpdate:list":n[1]||(n[1]=p=>d.value=p),class:"material-view",onDragover:n[2]||(n[2]=J(()=>{},["prevent","stop"])),onDrop:J(w,["stop"]),animation:"300",group:{name:"form",pull:!0,put:!0},"ghost-class":"ghost"},{default:f(()=>[(l(!0),S(L,null,R(d.value,p=>(l(),S("div",{key:p,onClick:J(D=>e(u)(p.id,d.value),["stop"]),class:Oe(["material-item",{active:p.id===e(r).id}])},[p.formItemProp?(l(),i(m,{key:0,label:p.formItemProp.label,name:p.formItemProp.name},{default:f(()=>[(l(),i(se(b(p.type)),k(h(p.controlProp,p.type),{key:p.id}),null,16))]),_:2},1032,["label","name"])):(l(),i(se(b(p.type)),k({key:1},h(p.controlProp,p.type),{children:p.controlProp.children,"onUpdate:children":D=>p.controlProp.children=D,key:p.id}),null,16,["children","onUpdate:children"])),M("div",Yo,[M("div",{class:"icon-btn",onClick:n[0]||(n[0]=(...D)=>e(_)&&e(_)(...D)),title:"复制"},[v(e(Qe))]),M("div",{class:"icon-btn",onClick:D=>e(y)(p.id,d.value),title:"删除"},[v(e(Xe))],8,Go)])],10,Ro))),128))]),_:1},8,["list"])}}}),Z=H(Oo,[["__scopeId","data-v-11ca5068"]]),Qo=[{type:"input",properties:{"formItemProp.label":{type:"string",label:"标签文本"},"formItemProp.name":{type:"string",label:"字段名"},"controlProp.allowClear":{type:"switch",label:"可清除"},"controlProp.bordered":{type:"switch",label:"边框"},"controlProp.disabled":{type:"switch",label:"禁用"},"controlProp.size":{type:"radio",label:"大小",component:{dataSource:[{label:"大",value:"large"},{label:"中",value:"middle"},{label:"小",value:"small"}]}},"controlProp.maxlength":{type:"number",label:"最大长度"}}},{type:"textarea",properties:{"formItemProp.label":{type:"string",label:"标签文本"},"formItemProp.name":{type:"string",label:"字段名"},"controlProp.allowClear":{type:"switch",label:"可清除"},"controlProp.autosize":{type:"switch",label:"自适应内容高度"},"controlProp.disabled":{type:"switch",label:"禁用"},"controlProp.size":{type:"radio",label:"大小",component:{dataSource:[{label:"大",value:"large"},{label:"中",value:"middle"},{label:"小",value:"small"}]}},"controlProp.maxlength":{type:"number",label:"最大长度"}}},{type:"select",properties:{"formItemProp.label":{type:"string",label:"标签文本"},"formItemProp.name":{type:"string",label:"字段名"},"controlProp.allowClear":{type:"switch",label:"可清除"},"controlProp.bordered":{type:"switch",label:"边框"},"controlProp.disabled":{type:"switch",label:"禁用"},"controlProp.size":{type:"radio",label:"大小",component:{dataSource:[{label:"大",value:"large"},{label:"中",value:"middle"},{label:"小",value:"small"}]}},"controlProp.virtual":{type:"switch",label:"虚拟滚动"},"controlProp.mode":{type:"select",label:"模式",component:{dataSource:[{label:"多选",value:"multiple"},{label:"标签",value:"tag"}],allowClear:!0}},"controlProp.dict":{type:"select",label:"字典",component:{asyncData:async()=>{const{code:s,data:c,msg:t}=await ee.getDictTypeList();return s==200?c.map(o=>({label:o.dictTypeDesc,value:o.dictType})):[]}}}}},{type:"switch",properties:{"formItemProp.label":{type:"string",label:"标签文本"},"formItemProp.name":{type:"string",label:"字段名"},"controlProp.disabled":{type:"switch",label:"禁用"},"controlProp.size":{type:"radio",label:"大小",component:{dataSource:[{label:"大",value:"large"},{label:"中",value:"middle"},{label:"小",value:"small"}]}}}},{type:"radio",properties:{"formItemProp.label":{type:"string",label:"标签文本"},"formItemProp.name":{type:"string",label:"字段名"},"controlProp.disabled":{type:"switch",label:"禁用"},"controlProp.size":{type:"radio",label:"大小",component:{dataSource:[{label:"大",value:"large"},{label:"中",value:"middle"},{label:"小",value:"small"}]}},"controlProp.buttonStyle":{type:"radio",label:"样式",component:{dataSource:[{label:"描边",value:"outline"},{label:"填色",value:"solid"}]}},"controlProp.optionType":{type:"radio",label:"类型",component:{dataSource:[{label:"默认",value:"default"},{label:"按钮",value:"button"}]}},"controlProp.dict":{type:"select",label:"字典",component:{asyncData:async()=>{const{code:s,data:c,msg:t}=await ee.getDictTypeList();return s==200?c.map(o=>({label:o.dictTypeDesc,value:o.dictType})):[]}}}}},{type:"checkbox",properties:{"formItemProp.label":{type:"string",label:"标签文本"},"formItemProp.name":{type:"string",label:"字段名"},"controlProp.disabled":{type:"switch",label:"禁用"},"controlProp.dict":{type:"select",label:"字典",component:{asyncData:async()=>{const{code:s,data:c,msg:t}=await ee.getDictTypeList();return s==200?c.map(o=>({label:o.dictTypeDesc,value:o.dictType})):[]}}}}},{type:"number",properties:{"formItemProp.label":{type:"string",label:"标签文本"},"formItemProp.name":{type:"string",label:"字段名"},"controlProp.bordered":{type:"switch",label:"边框"},"controlProp.disabled":{type:"switch",label:"禁用"},"controlProp.controls":{type:"switch",label:"控件"},"controlProp.size":{type:"radio",label:"大小",component:{dataSource:[{label:"大",value:"large"},{label:"中",value:"middle"},{label:"小",value:"small"}]}},"controlProp.max":{type:"number",label:"最大值"},"controlProp.min":{type:"number",label:"最小值"},"controlProp.precision":{type:"number",label:"精度"},"controlProp.step":{type:"number",label:"步长"}}},{type:"date",properties:{"formItemProp.label":{type:"string",label:"标签文本"},"formItemProp.name":{type:"string",label:"字段名"},"controlProp.bordered":{type:"switch",label:"边框"},"controlProp.disabled":{type:"switch",label:"禁用"},"controlProp.format":{type:"string",label:"显示格式化"},"controlProp.valueFormat":{type:"string",label:"值格式化"},"controlProp.size":{type:"radio",label:"大小",component:{dataSource:[{label:"大",value:"large"},{label:"中",value:"middle"},{label:"小",value:"small"}]}},"controlProp.mode":{type:"radio",label:"面板",component:{dataSource:[{label:"时间",value:"time"},{label:"日期",value:"date"},{label:"月",value:"month"},{label:"年",value:"year"}]}},"controlProp.picker":{type:"radio",label:"类型",component:{dataSource:[{label:"日期",value:"date"},{label:"周",value:"week"},{label:"月",value:"month"},{label:"年",value:"year"}]}}}},{type:"grid",properties:{"controlProp.gutter":{type:"number",label:"栅格间距"},"controlProp.colNumber":{type:"radio",label:"列配置",component:{dataSource:[{label:"一",value:1},{label:"二",value:2},{label:"三",value:3},{label:"四",value:4}]}}}},{type:"card",properties:{"controlProp.title":{type:"string",label:"标题"},"controlProp.bordered":{type:"switch",label:"边框"},"controlProp.hoverable":{type:"switch",label:"悬浮效果"}}},{type:"divider",properties:{"controlProp.title":{type:"string",label:"标题"},"controlProp.orientation":{type:"radio",label:"标题位置",component:{dataSource:[{label:"左",value:"left"},{label:"中",value:"center"},{label:"右",value:"right"}]}},"controlProp.dashed":{type:"switch",label:"虚线"},"controlProp.plain":{type:"switch",label:"普通正文"}}},{type:"collapse",properties:{"controlProp.title":{type:"string",label:"标题"},"controlProp.bordered":{type:"switch",label:"边框"},"controlProp.ghost":{type:"switch",label:"透明效果"},"controlProp.defaultExpanded":{type:"switch",label:"默认展开"},"controlProp.showArrow":{type:"switch",label:"显示箭头"}}}],Xo={key:1},Ho=$({__name:"MaterialCfg",setup(s){const c=le(),{curControlCfg:t,formConfig:o}=O(c),r=P({layout:{layout:"horizontal",labelAlign:"right",labelCol:{span:8},wrapperCol:{span:16}},properties:{}}),u=P({layout:{layout:"horizontal",labelAlign:"right",labelCol:{span:8},wrapperCol:{span:16}},properties:{labelAlign:{label:"对齐方式",type:"radio",component:{dataSource:[{label:"左对齐",value:"left"},{label:"右对齐",value:"right"}]}},layout:{label:"响应式布局",type:"radio",component:{dataSource:[{label:"响应式",value:"resLayout"},{label:"固定",value:"fixedLayout"}],onChange({field:y,formData:d,value:b}){b=="fixedLayout"?(Reflect.deleteProperty(d.labelCol,"span"),Reflect.deleteProperty(d.labelCol,"offset")):Reflect.deleteProperty(d.labelCol,"style")}}},"labelCol.span":{label:"标签宽度",type:"number",show:"'${formData.layout}' == 'resLayout'"},"labelCol.offset":{label:"偏移量",type:"number",show:"'${formData.layout}' == 'resLayout'"},"labelCol.style.width":{label:"宽度",type:"string",show:"'${formData.layout}' == 'fixedLayout'",tooltip:"单位为百分比或px,如: 100% 或 100px"}}}),_=P("item");return pe(()=>t.value.type,()=>{if(t.value.type){let y=Qo.find(d=>d.type===t.value.type);y&&(r.value.properties=X(y.properties))}},{immediate:!0}),(y,d)=>{const b=Ze,h=je,w=We;return l(),i(w,{activeKey:_.value,"onUpdate:activeKey":d[0]||(d[0]=g=>_.value=g)},{default:f(()=>[v(h,{key:"item",tab:"控件配置"},{default:f(()=>[e(t).id?(l(),i(e(oe),{schema:r.value,formData:e(t),key:e(t).id},null,8,["schema","formData"])):(l(),S("div",Xo,[v(b)]))]),_:1}),v(h,{key:"form",tab:"表单配置"},{default:f(()=>[v(e(oe),{schema:u.value,formData:e(o)},null,8,["schema","formData"])]),_:1})]),_:1},8,["activeKey"])}}}),Wo={class:"form-design"},Zo={class:"middle-part"},jo=$({__name:"FormEditor",props:{id:{}},setup(s){const c=s,{id:t}=T(c),o=le(),{formCfgItemList:r,extraFormConfig:u,saveLoading:_,formConfig:y}=O(o),{onSave:d,setFormDetail:b}=o,h=P(!1),w=P(0),g=[{title:"物料区",description:"选择您需要的表单控件",target:()=>document.querySelector(".left-part")},{title:"设计区",description:"将物料区的表单控件拖拽到此区域,可以按照你需要的方式进行布局。",target:()=>document.querySelector(".middle-part")},{title:"配置区",description:"对设计区选中的控件进行配置",target:()=>document.querySelector(".right-part")},{title:"查看实际效果",description:"对已经配置完成的表单进行预览",target:()=>document.querySelector(".preview-btn")},{title:"最后",description:"保存您刚刚的配置",target:()=>document.querySelector(".save-btn")}];t.value?Q.getDetail(t.value).then(N=>{const{code:I,data:A,msg:j}=N;I==200&&b(A)}):(b({id:"",name:"",description:"",schema:{formCfgItemList:[],formConfig:{labelCol:{span:void 0,offset:void 0},labelAlign:"left"}},img:"",status:1,belong:"private"}),h.value=!0);const n=G(()=>t.value?u.value.name:"新建表单"),m=G(()=>t.value?u.value.description:""),p=P(!1),D=P({layout:{labelAlign:"left",layout:"horizontal",labelCol:{span:4}},properties:{name:{type:"string",label:"表单名称"},description:{type:"string",label:"备注"},belong:{type:"radio",label:"归属",component:{buttonStyle:"solid",asyncData:async()=>{const{code:N,data:I,msg:A}=await xe.getDict(["belong"]);return N==200?I.belong:[]}}},status:{type:"radio",label:"状态",component:{buttonStyle:"solid",dataSource:[{label:"启用",value:1},{label:"停用",value:0}]}}}}),B=()=>{p.value=!0},F=Je(),E=()=>{F.go(-1)},a=()=>{d().then(()=>{E()}),p.value=!1},C=P(!1),Me=P({}),Ve=()=>{C.value=!0},Le=()=>{Q.getTemplate(t.value).then(N=>{const{code:I,data:A,msg:j}=N;I==200&&co(A,u.value.name,"vue")})};return(N,I)=>{const A=ce,j=ro,re=no,Te=oo,Fe=ke,ne=to,Ae=ao,ze=lo("loading");return l(),S(L,null,[v(Te,{title:n.value,subTitle:m.value,onBack:E,ghost:!1,style:{padding:"10px 24px"}},{extra:f(()=>[v(j,null,{default:f(()=>[e(t)?(l(),i(A,{key:0,onClick:Le},{default:f(()=>[V(" 导出 ")]),_:1})):x("",!0),v(A,{onClick:Ve,class:"preview-btn"},{default:f(()=>[V(" 预览 ")]),_:1}),v(A,{onClick:B,type:"primary",class:"save-btn"},{default:f(()=>[V(" 保存 ")]),_:1})]),_:1})]),tags:f(()=>[e(u).status?(l(),i(re,{key:0,color:"#87d068"},{default:f(()=>[V("启用")]),_:1})):(l(),i(re,{key:1,color:"#f50"},{default:f(()=>[V("停用")]),_:1}))]),_:1},8,["title","subTitle"]),eo((l(),S("div",Wo,[v(yo,{class:"left-part"}),M("div",Zo,[v(Fe,k(e(y),{class:"middle-part-content"}),{default:f(()=>[v(Z,{modelValue:e(r),"onUpdate:modelValue":I[0]||(I[0]=z=>fe(r)?r.value=z:null)},null,8,["modelValue"])]),_:1},16)]),v(Ho,{class:"right-part"})])),[[ze,e(_),void 0,{fullscreen:!0}]]),v(ne,{open:p.value,"onUpdate:open":I[1]||(I[1]=z=>p.value=z),title:"保存",onOk:a},{default:f(()=>[v(e(oe),{schema:D.value,"form-data":e(u)},null,8,["schema","form-data"])]),_:1},8,["open"]),v(ne,{open:C.value,"onUpdate:open":I[2]||(I[2]=z=>C.value=z),title:"预览"},{default:f(()=>[v($e,{formData:Me.value,schema:{formCfgItemList:e(r),formConfig:e(y)}},null,8,["formData","schema"])]),_:1},8,["open"]),v(Ae,{current:w.value,"onUpdate:current":I[3]||(I[3]=z=>w.value=z),open:h.value,steps:g,onClose:I[4]||(I[4]=z=>h.value=!1)},null,8,["current","open"])],64)}}}),rt=H(jo,[["__scopeId","data-v-75ce0412"]]);export{rt as default};
