import{bV as J,d as j,bf as A,r as u,p as G,c as K,q as z,f as t,w as e,$ as a,e as f,I as x,M as l,J as Q,o as d}from"./iconfont-DlnTACa0.js";import{C as W}from"./index-DWh7MMD2.js";import{M as X}from"./index-rRoPRs5X.js";import{F as Z,_ as ee}from"./index-3zxQoAaC.js";import{I as te}from"./index-DstlK8U5.js";import{B as ae}from"./EyeOutlined-MSEk9XoR.js";import{T as oe}from"./index-CcL4KyIF.js";import{D as le,a as ne}from"./index-BFOsZcev.js";import{R as re}from"./dayjs-78fL9Suk.js";import{_ as se}from"./index-C5YNH3Jl.js";import{_ as ie}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-DFAyz8EE.js";import"./useFlexGapSupport-CiVQ43IU.js";import"./_getPrototype-CreJcRG-.js";import"./initDefaultProps-CCuNUPvT.js";import"./CheckOutlined-DhghRCOv.js";import"./index-CkgH7Yyy.js";import"./shallowequal-CYaRVoeZ.js";import"./index-Cj_T3PZy.js";import"./PlusOutlined-boFLuxir.js";import"./index-Df99mV5f.js";import"./pickAttrs-C_Pg0-pd.js";import"./ActionButton-GOh5bmF9.js";import"./cloneDeep-eMWwQ7HD.js";import"./Col-7N7sU2gK.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./RadioButton-CjVxn_Oc.js";import"./index-C6qv0Jk3.js";import"./css-CjeDAR7Q.js";import"./index-DVHdQjvX.js";import"./LeftOutlined-DjA3wwZo.js";import"./RightOutlined-DiQ8sQL1.js";import"./useBreakpoint-BBubvWxm.js";import"./zh_CN-CAyhejr6.js";import"./index-BZJkr9T5.js";import"./dropdown-CS9IU7I3.js";const pe={getList:S=>J({method:"get",url:"operationlog/list",params:S})},ue={class:"optLog"},me=j({__name:"OptLog",setup(S){const r=A({keyword:"",startTime:"",endTime:"",pageNumber:1,pageSize:20}),v=u(""),w=u([]),q=u([{title:"操作用户",key:"username",dataIndex:"username"},{title:"ip地址",key:"ip",dataIndex:"ip"},{title:"地址",key:"location",dataIndex:"location"},{title:"操作模块",key:"optModule",dataIndex:"optModule"},{title:"操作类型",key:"optType",dataIndex:"optType"},{title:"操作结果",key:"resStatus",dataIndex:"resStatus"},{title:"响应时间",key:"resTime",dataIndex:"resTime"},{title:"操作时间",key:"createTime",dataIndex:"createTime"},{title:"操作",key:"action",dataIndex:"action",width:"250px"}]),I=u(!1),M=u(),B=()=>{var p;(p=M.value)==null||p.resetFields(),k()},D=u(0),P=()=>{r.pageNumber=1,r.pageSize=20,k()},V=()=>{v.value?(r.startTime=v.value[0],r.endTime=v.value[1]):(r.startTime="",r.endTime="")},R=p=>{const{current:s,pageSize:c}=p;r.pageNumber=s,r.pageSize=c,k()},k=()=>{I.value=!0,pe.getList(r).then(p=>{const{code:s,data:c}=p;s==200&&(w.value=c.data,D.value=c.total),I.value=!1})},o=u({}),h=u(!1),U=p=>{o.value=p,h.value=!0},F=u([]),g=u(new Map),Y=["green","cyan","red","pink","orange","blue","purple"];return G(()=>{k(),K.getDict(["optType"]).then(p=>{const{code:s,data:c,msg:b}=p;s==200&&(F.value=c.optType,F.value.forEach((T,y)=>{g.value.set(T.value,{label:T.label,color:Y[y]})}))})}),(p,s)=>{const c=te,b=ee,T=re,y=ae,O=Z,L=W,_=oe,$=se,n=ne,E=le,H=X;return d(),z("div",ue,[t(L,{class:"search-area"},{default:e(()=>[t(O,{ref_key:"searchFormRef",ref:M,model:r,layout:"inline",onFinish:P},{default:e(()=>[t(b,{label:"用户名",name:"keyword"},{default:e(()=>[t(c,{value:r.keyword,"onUpdate:value":s[0]||(s[0]=i=>r.keyword=i)},null,8,["value"])]),_:1}),t(b,{label:"操作日期"},{default:e(()=>[t(T,{value:v.value,"onUpdate:value":s[1]||(s[1]=i=>v.value=i),showTime:!0,valueFormat:"YYYY-MM-DD HH:mm:ss",onChange:s[2]||(s[2]=i=>V())},null,8,["value"])]),_:1}),t(b,null,{default:e(()=>[t(y,{type:"primary","html-type":"submit"},{default:e(()=>[a("搜索")]),_:1}),t(y,{style:{margin:"0 8px"},onClick:B},{default:e(()=>[a(" 重置 ")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(L,null,{default:e(()=>[t($,{loading:I.value,columns:q.value,"data-source":w.value,scroll:{y:600},onChange:R,pagination:{current:r.pageNumber,total:D.value,showSizeChanger:!0,pageSize:r.pageSize}},{bodyCell:e(({column:i,record:m})=>{var N;return[i.key=="optType"?(d(),f(_,{key:0,color:(N=g.value.get(m.optType))==null?void 0:N.color},{default:e(()=>{var C;return[a(l((C=g.value.get(m.optType))==null?void 0:C.label),1)]}),_:2},1032,["color"])):x("",!0),i.key=="resTime"?(d(),f(_,{key:1,color:parseInt(m.resTime)<500?"#87d068":"#f50"},{default:e(()=>[a(l(m.resTime),1)]),_:2},1032,["color"])):x("",!0),i.key=="resStatus"?(d(),z(Q,{key:2},[m.resStatus=="1"?(d(),f(_,{key:0,color:"#87d068"},{default:e(()=>[a("成功")]),_:1})):(d(),f(_,{key:1,color:"#f50"},{default:e(()=>[a("失败")]),_:1}))],64)):x("",!0),i.key=="action"?(d(),f(y,{key:3,type:"link",onClick:C=>U(m)},{default:e(()=>[a("查看")]),_:2},1032,["onClick"])):x("",!0)]}),_:1},8,["loading","columns","data-source","pagination"])]),_:1}),t(H,{open:h.value,"onUpdate:open":s[3]||(s[3]=i=>h.value=i),title:"查看详情",footer:null,width:"1000px"},{default:e(()=>[t(E,{column:2},{default:e(()=>[t(n,{label:"操作用户"},{default:e(()=>[a(l(o.value.username),1)]),_:1}),t(n,{label:"操作IP"},{default:e(()=>[a(l(o.value.ip),1)]),_:1}),t(n,{label:"操作地点"},{default:e(()=>[a(l(o.value.location),1)]),_:1}),t(n,{label:"操作时间"},{default:e(()=>[a(l(o.value.createTime),1)]),_:1}),t(n,{label:"请求类型"},{default:e(()=>[a(l(o.value.reqType),1)]),_:1}),t(n,{label:"请求地址"},{default:e(()=>[a(l(o.value.reqUrl),1)]),_:1}),t(n,{label:"请求参数"},{default:e(()=>[a(l(o.value.reqParam),1)]),_:1}),t(n,{label:"模块名称"},{default:e(()=>[a(l(o.value.moduleName),1)]),_:1}),t(n,{label:"方法名称"},{default:e(()=>[a(l(o.value.funcName),1)]),_:1}),t(n,{label:"操作模块"},{default:e(()=>[a(l(o.value.optModule),1)]),_:1}),t(n,{label:"操作类型"},{default:e(()=>{var i;return[t(_,{color:(i=g.value.get(o.value.optType))==null?void 0:i.color},{default:e(()=>{var m;return[a(l((m=g.value.get(o.value.optType))==null?void 0:m.label),1)]}),_:1},8,["color"])]}),_:1}),t(n,{label:"操作结果"},{default:e(()=>[o.value.resStatus=="1"?(d(),f(_,{key:0,color:"#87d068"},{default:e(()=>[a("成功")]),_:1})):(d(),f(_,{key:1,color:"#f50"},{default:e(()=>[a("失败")]),_:1}))]),_:1}),t(n,{label:"响应时间"},{default:e(()=>[t(_,{color:parseInt(o.value.resTime)<500?"#87d068":"#f50"},{default:e(()=>[a(l(o.value.resTime),1)]),_:1},8,["color"])]),_:1}),t(n,{label:"请求结果",span:4},{default:e(()=>[a(l(o.value.res),1)]),_:1}),t(n,{label:"异常信息",span:4},{default:e(()=>[a(l(o.value.errMsg),1)]),_:1})]),_:1})]),_:1},8,["open"])])}}}),Ge=ie(me,[["__scopeId","data-v-f0f56045"]]);export{Ge as default};
