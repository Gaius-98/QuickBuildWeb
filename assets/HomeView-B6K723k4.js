var J=Object.defineProperty;var H=(l,e,t)=>e in l?J(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t;var C=(l,e,t)=>(H(l,typeof e!="symbol"?e+"":e,t),t);import{_ as Q}from"./CodeEditor.vue_vue_type_script_setup_true_name_EvCode_lang-DTvU44AW.js";import{I as X,g as M,v as O,y as D,x as z,D as L,o as i,h as v,w as c,m as d,J as G,i as g,K as $,L as U,M as V,N as Y,z as E,O as Z,P as A,Q as q,F as B,R as F,A as ee,B as I,T as R,U as te,V as ae,W as ne,r as y,X as j,Y as oe,$ as le,G as T,a0 as se,a1 as ie,a2 as ue}from"./.pnpm-i8FCJJ8r.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";class ce{constructor(e){C(this,"state");this.state=e}getValue(e){const{_value:t,_mode:o,_dynExp:n}=e;return o==="static"?t:this.resolveDynamicValue(n)}resolveDynamicValue(e){try{return new Function("state",`return ${e}`)(this.state)}catch(t){return console.error("评估动态表达式时出错:",t),null}}isDynamicConfigData(e){return typeof e=="object"&&e!==null&&["string","number","boolean"].includes(typeof e._value)&&["static","dynamic"].includes(e._mode)}processObject(e){const t=X(e);if(Array.isArray(t))return t.map(o=>this.processObject(o));if(typeof t=="object"&&t!==null){const o={};for(const n in t){const a=t[n];this.isDynamicConfigData(a)?o[n]=this.getValue(a):typeof a=="object"&&a!==null?o[n]=this.processObject(a):o[n]=a}return o}else return t}}const re=$("div",{class:"iconfont icon-brackets-curly"},null,-1),de=M({__name:"ConfigInput",props:O({compact:{type:Boolean,default:!0},size:{default:"default"}},{data:{required:!0,default:{_value:"",_mode:"static",_dynExp:""}},dataModifiers:{}}),emits:["update:data"],setup(l){const e=D(l,"data"),t=l,{size:o,compact:n}=z(t),a=L(()=>e.value._mode==="dynamic"),p=()=>{e.value._mode=e.value._mode==="dynamic"?"static":"dynamic"},f=r=>{e.value._mode==="dynamic"?e.value._dynExp=r.target.value:e.value._value=r.target.value};return(r,m)=>{const b=U,_=V,s=Y;return i(),v(s,{size:g(o),compact:g(n)},{default:c(()=>[d(b,G({value:a.value?e.value._dynExp:e.value._value,onChange:f,style:{width:"calc(100% - 35px)"},prefix:a.value?"{":"",suffix:a.value?"}":""},r.$attrs),null,16,["value","prefix","suffix"]),d(_,{title:a.value?`绑定中:${e.value._dynExp}`:"变量绑定",type:a.value?"primary":"",onClick:m[0]||(m[0]=u=>p())},{icon:c(()=>[re]),_:1},8,["title","type"])]),_:1},8,["size","compact"])}}}),pe=l=>(A("data-v-dcd1c0f1"),l=l(),q(),l),me={class:"config-select"},_e=pe(()=>$("div",{class:"iconfont icon-brackets-curly"},null,-1)),ve=M({__name:"ConfigSelect",props:{data:{required:!0,default:{_value:"",_mode:"static",_dynExp:""}},dataModifiers:{}},emits:["update:data"],setup(l){const e=D(l,"data"),t=L(()=>e.value._mode==="dynamic"),o=()=>{e.value._mode=e.value._mode==="dynamic"?"static":"dynamic"};return(n,a)=>{const p=Z,f=U,r=V;return i(),E("div",me,[t.value?(i(),v(f,{key:1,value:e.value._dynExp,"onUpdate:value":a[1]||(a[1]=m=>e.value._dynExp=m),style:{width:"calc(100% - 35px)"},prefix:"{",suffix:"}"},null,8,["value"])):(i(),v(p,G({key:0,style:{width:"calc(100% - 35px)"}},n.$attrs,{value:e.value._value,"onUpdate:value":a[0]||(a[0]=m=>e.value._value=m)}),null,16,["value"])),d(r,{title:t.value?`绑定中:${e.value._dynExp}`:"变量绑定",type:t.value?"primary":"",onClick:a[2]||(a[2]=m=>o())},{icon:c(()=>[_e]),_:1},8,["title","type"])])}}}),ye=K(ve,[["__scopeId","data-v-dcd1c0f1"]]),fe=l=>(A("data-v-8fc419f7"),l=l(),q(),l),he={class:"config-radio"},xe=fe(()=>$("div",{class:"iconfont icon-brackets-curly"},null,-1)),ge=M({__name:"ConfigRadio",props:O({options:{default:()=>[]},fields:{default:()=>({label:"label",value:"value",title:"title"})},icon:{type:Boolean,default:!1}},{data:{required:!0,default:{_value:"",_mode:"static",_dynExp:""}},dataModifiers:{}}),emits:["update:data"],setup(l){const e=D(l,"data"),t=l,{options:o,fields:n}=z(t),a=L(()=>e.value._mode==="dynamic"),p=()=>{e.value._mode=e.value._mode==="dynamic"?"static":"dynamic"};return(f,r)=>{const m=te,b=ae,_=U,s=V;return i(),E("div",he,[a.value?(i(),v(_,{key:1,value:e.value._dynExp,"onUpdate:value":r[1]||(r[1]=u=>e.value._dynExp=u),style:{width:"calc(100% - 35px)"},prefix:"{",suffix:"}"},null,8,["value"])):(i(),v(b,G({key:0},f.$attrs,{style:{width:"calc(100% - 35px)"},value:e.value._value,"onUpdate:value":r[0]||(r[0]=u=>e.value._value=u),"button-style":"solid"}),{default:c(()=>[(i(!0),E(B,null,F(g(o),u=>(i(),v(m,{key:u[g(n).value],title:u[g(n).title]||u[g(n).label],value:u[g(n).value]},{default:c(()=>[f.icon?(i(),E("div",{key:0,class:ee(["iconfont",u.label])},null,2)):(i(),E(B,{key:1},[I(R(u[g(n).label]),1)],64))]),_:2},1032,["title","value"]))),128))]),_:1},16,["value"])),d(s,{title:a.value?`绑定中:${e.value._dynExp}`:"变量绑定",type:a.value?"primary":"",onClick:r[2]||(r[2]=u=>p())},{icon:c(()=>[xe]),_:1},8,["title","type"])])}}}),be=K(ge,[["__scopeId","data-v-8fc419f7"]]);class ke{constructor(e){C(this,"libs");C(this,"scripts",[]);C(this,"styles",[]);C(this,"componentsMap",new Map);C(this,"components",{});this.libs=e,this.init()}init(){window.Vue||(window.Vue=ne),this.handleLibs(),this.handleUrls()}handleUrls(){this.libs.map(t=>t.urls).flat().forEach(t=>{t.endsWith("js")?this.scripts.push(t):t.endsWith("css")&&this.styles.push(t)})}load(){return new Promise((e,t)=>{Promise.allSettled([...this.styles.map(o=>this.loadStyle(o)),...this.scripts.map(o=>this.loadScript(o))]).then(()=>{this.registerComponents(),e(this.components)}).catch(o=>{t(o)})})}registerComponents(){for(const[e,t]of this.componentsMap)Array.isArray(t)?t.forEach(o=>{this.components[o.componentName]=window[e][o.exportName]}):this.components[t.componentName]=window[t.exportName]}handleLibChildren(e){const t=e.children.map(o=>({exportName:o.exportName,componentName:o.componentName}));this.componentsMap.set(e.exportName,t)}handleLibs(e=this.libs){e.forEach(t=>{this.isLibTree(t)?this.handleLibChildren(t):this.componentsMap.set(t.exportName,{exportName:t.exportName,componentName:t.componentName})})}isLibTree(e){return"children"in e}loadScript(e){return new Promise((t,o)=>{const n=document.createElement("script");n.src=e,n.async=!1,n.onload=t,n.onerror=o,document.body.appendChild(n)})}loadStyle(e){return new Promise((t,o)=>{const n=document.createElement("link");n.rel="stylesheet",n.href=e,n.onload=t,n.onerror=o,document.head.appendChild(n)})}}const Ee={class:"config-array"},we=$("div",{class:"iconfont icon-brackets-curly"},null,-1),Se=$("div",{class:"iconfont icon-brackets-curly"},null,-1),Ce=M({__name:"ConfigArray",props:O({title:{default:"标题"},closable:{type:Boolean,default:!0}},{data:{required:!0,default:{_value:[],_mode:"static",_dynExp:""}},dataModifiers:{}}),emits:["update:data"],setup(l){const e=l,{title:t,closable:o}=z(e),n=y(0),a=D(l,"data"),p=L(()=>a.value._mode==="dynamic"),f=()=>{a.value._mode=a.value._mode==="dynamic"?"static":"dynamic"},r=()=>{n.value=a.value._value.length||0,a.value._value.push({})},m=_=>{let s=0;a.value._value.forEach((u,N)=>{u.key===_&&(s=N-1)}),a.value._value=a.value._value.filter(u=>u.key!==_),a.value._value.length&&n.value===_&&(s>=0?n.value=a.value._value[s].key:n.value=a.value._value[0].key)},b=(_,s)=>{s==="add"?r():m(_)};return(_,s)=>{const u=oe,N=V,w=le,h=U;return i(),E("div",Ee,[p.value?j("",!0):(i(),v(w,{key:0,activeKey:n.value,"onUpdate:activeKey":s[1]||(s[1]=k=>n.value=k),type:"editable-card",onEdit:b,class:"config-array-tab"},{rightExtra:c(()=>[d(N,{title:p.value?`绑定中:${a.value._dynExp}`:"变量绑定",type:p.value?"primary":"",onClick:s[0]||(s[0]=k=>f())},{icon:c(()=>[we]),_:1},8,["title","type"])]),default:c(()=>[(i(!0),E(B,null,F(a.value._value,(k,S)=>(i(),v(u,{key:S+1,tab:`${g(t)}${S+1}`,closable:g(o)},{default:c(()=>[I(" #TODO 表单渲染组件 ")]),_:2},1032,["tab","closable"]))),128))]),_:1},8,["activeKey"])),p.value?(i(),v(h,{key:1,value:a.value._dynExp,"onUpdate:value":s[2]||(s[2]=k=>a.value._dynExp=k),style:{width:"calc(100% - 35px)"},prefix:"{",suffix:"}"},null,8,["value"])):j("",!0),p.value?(i(),v(N,{key:2,title:p.value?`绑定中:${a.value._dynExp}`:"变量绑定",type:p.value?"primary":"",onClick:s[3]||(s[3]=k=>f())},{icon:c(()=>[Se]),_:1},8,["title","type"])):j("",!0)])}}}),Ve=M({__name:"HomeView",setup(l){const e=y({input:{_value:"",_mode:"static",_dynExp:""},select:{_value:"",_mode:"static",_dynExp:""},test:"123",radio:{},arr:{_value:[{title:"测试"}],_mode:"static",_dynExp:""}}),t=y({string:"配置表单",arr:[1,2,3,4],number:125654}),o=y([{label:"1",value:"1"},{label:"2",value:"2"}]),n=y([{label:"icon-lock1",value:"1",title:"锁定"},{label:"icon-unlock1",value:"2",title:"解锁"}]),a=y(!1),p=()=>{e.value,a.value=!0},f=()=>{new ce(t.value).processObject(e.value)},r=y("测试");y({package:"ConfigInput",version:"",exportName:"",main:"",cdn:"",componentName:""});const m=[{title:"element",package:"element-plus",version:"1.0.2",exportName:"ElementPlus",urls:["https://cdn.jsdelivr.net/npm/element-plus@2.9.2/dist/index.full.min.js","https://cdn.jsdelivr.net/npm/element-plus@2.9.2/dist/index.min.css"],children:[{componentName:"ElButton",exportName:"ElButton"},{componentName:"ElInput",exportName:"ElInput"}]},{title:"",package:"drag-grid-layout-v3",version:"1.0.0",exportName:"drag-grid-layout-v3",children:[{componentName:"GridLayout",exportName:"GridLayout"}],urls:["https://cdn.jsdelivr.net/npm/drag-grid-layout-v3@0.0.4/lib/drag-grid-layout-v3.umd.js","https://cdn.jsdelivr.net/npm/drag-grid-layout-v3@0.0.4/lib/style.css"]}],b=y(),_=y(),s=y(),u=new ke(m),N=y([{key:1,id:1,rowStart:1,colStart:1,rowSpan:20,colSpan:3,extra:{color:"red"}},{key:1,id:2,rowStart:2,colStart:4,rowSpan:40,colSpan:2,extra:{color:"blue"}},{key:1,id:3,rowStart:4,colStart:6,rowSpan:10,colSpan:5,extra:{color:"pink"}},{key:1,id:4,rowStart:5,colStart:1,rowSpan:30,colSpan:6,extra:{color:"green"}}]);return u.load().then(w=>{b.value=w.ElButton,_.value=w.ElInput,s.value=w.GridLayout}),(w,h)=>{const k=Q,S=ue,W=se,P=V;return i(),E(B,null,[d(k,{value:JSON.stringify(t.value,null,4),disabled:""},null,8,["value"]),d(W,null,{default:c(()=>[d(S,{label:"输入框"},{default:c(()=>[d(de,{data:e.value.input,"onUpdate:data":h[0]||(h[0]=x=>e.value.input=x)},null,8,["data"])]),_:1}),d(S,{label:"选择框"},{default:c(()=>[d(ye,{data:e.value.select,"onUpdate:data":h[1]||(h[1]=x=>e.value.select=x),options:o.value},null,8,["data","options"])]),_:1}),d(S,{label:"单选框"},{default:c(()=>[d(be,{data:e.value.radio,"onUpdate:data":h[2]||(h[2]=x=>e.value.radio=x),options:n.value,icon:!0},null,8,["data","options"])]),_:1}),d(S,{label:"数组"},{default:c(()=>[d(Ce,{data:e.value.arr,"onUpdate:data":h[3]||(h[3]=x=>e.value.arr=x),title:"数组",closable:""},null,8,["data"])]),_:1})]),_:1}),d(P,{onClick:p},{default:c(()=>[I("配置项")]),_:1}),d(P,{onClick:f},{default:c(()=>[I("数据")]),_:1}),(i(),v(T(b.value),{type:"success"},{default:c(()=>[I("el")]),_:1})),(i(),v(T(_.value),{placeholder:"请输入内容",Value:r.value},null,8,["Value"])),(i(),v(T(s.value),{placeholder:"请输入内容",list:N.value},{"layout-item":c(({item:x})=>[$("div",{style:ie({backgroundColor:x.extra.color,width:"100%",height:"100%"})},R(x),5)]),_:1},8,["list"]))],64)}}});export{Ve as default};
