import{r as y,c as ne}from"./main-DwsVNyhA.js";/* empty css                                                                    */import{g as oe,Y as le,r as _,x as M,P as se,o as p,y as C,l as a,w as t,e as P,a0 as ue,a1 as ie,a2 as re,M as d,G as pe,a3 as D,h as m,N,a4 as f,J as de,X as _e,a6 as ce,a5 as me,T as ge,a7 as ve,a8 as ye,O as fe,a9 as ke,aa as be,aq as xe,ab as Te,ac as he}from"./.pnpm-CEdUQ-90.js";import{_ as we}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./iconfont-RswF9Ywb.js";const h={getList:i=>y({method:"get",url:"setting/list",params:i}),getDetail:i=>y({method:"get",url:"setting/detail",params:{id:i}}),remove:i=>y({method:"get",url:"setting/remove",params:{id:i}}),add:i=>y({method:"post",url:"setting/add",data:i}),update:i=>y({method:"post",url:"setting/update",data:i}),getSettingByType:i=>y({method:"get",url:"setting/byType",params:{type:i}})},Ce={class:"setting"},Ve={class:"tools"},Se=oe({__name:"SettingView",setup(i){const r=le({keyword:"",pageNumber:1,pageSize:10,type:""}),z=_([]),R=_([{title:"配置键名",key:"settingKey",dataIndex:"settingKey",width:"150px"},{title:"配置值",key:"settingValue",dataIndex:"settingValue",width:"400px"},{title:"配置类型",key:"settingType",dataIndex:"settingType",width:"100px"},{title:"状态",key:"status",dataIndex:"status",width:"100px"},{title:"备注",key:"remark",dataIndex:"remark"},{title:"操作",key:"action",dataIndex:"action",width:"250px"}]),V=_(!1),I=_(),j=()=>{var n;(n=I.value)==null||n.resetFields(),g()},U=_(0),A=()=>{r.pageNumber=1,r.pageSize=10,g()},E=n=>{const{current:e,pageSize:s}=n;r.pageNumber=e,r.pageSize=s,g()},g=()=>{V.value=!0,h.getList(r).then(n=>{const{code:e,data:s}=n;e==200&&(z.value=s.data,U.value=s.total),V.value=!1})},w=_([]),K=_({});M(()=>{g(),ne.getDict(["configType"]).then(n=>{const{code:e,data:s,msg:u}=n;e==200&&(w.value=s.configType,K.value=w.value.reduce((x,c)=>(x[c.value]=c.label,x),{}))})});const k=_(!1),l=_({settingKey:"",settingValue:"",settingType:"",status:"1",remark:""}),b=_("add"),G=se(()=>({add:"新增配置",edit:"编辑配置"})[b.value]),S=_(),J=()=>{b.value="add",k.value=!0,l.value={settingKey:"",settingValue:"",settingType:"",status:"1",remark:""}},X=async n=>{const{code:e,data:s}=await h.getDetail(n.id);e==200&&(l.value=s,b.value="edit",k.value=!0)},Y=async n=>{const{code:e,msg:s,data:u}=await h.remove(n.id);e==200&&(P.success(u),g())},O=()=>{var n;(n=S.value)==null||n.resetFields()},H=()=>{var n;(n=S.value)==null||n.validate().then(()=>{let e;b.value=="add"?e=h.add:e=h.update,e(l.value).then(s=>{const{code:u}=s;u==200&&(P.success(b.value=="add"?"新增成功":"编辑成功"),g()),O(),k.value=!1})})};return M(()=>{}),(n,e)=>{const s=_e,u=ce,x=me,c=ge,q=ve,B=ue,T=ye,Q=fe,W=ke,Z=be,$=xe,L=Te,ee=he,te=ie,F=re("has-perm");return p(),C("div",Ce,[a(B,{class:"search-area"},{default:t(()=>[a(q,{ref_key:"searchFormRef",ref:I,model:r,layout:"inline",onFinish:A},{default:t(()=>[a(u,{label:"配置类型",prop:"type"},{default:t(()=>[a(s,{value:r.type,"onUpdate:value":e[0]||(e[0]=o=>r.type=o),options:w.value,"show-search":"",allowClear:"",optionFilterProp:"label",style:{width:"200px"}},null,8,["value","options"])]),_:1}),a(u,{label:"配置键名",prop:"keyword"},{default:t(()=>[a(x,{value:r.keyword,"onUpdate:value":e[1]||(e[1]=o=>r.keyword=o)},null,8,["value"])]),_:1}),a(u,null,{default:t(()=>[a(c,{type:"primary","html-type":"submit"},{default:t(()=>[d("搜索")]),_:1}),a(c,{style:{margin:"0 8px"},onClick:j},{default:t(()=>[d(" 重置 ")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(B,null,{default:t(()=>[pe("div",Ve,[D((p(),m(c,{type:"primary",onClick:J},{default:t(()=>[d("新增")]),_:1})),[[F,"system:setting:add"]])]),a(Z,{loading:V.value,columns:R.value,"data-source":z.value,scroll:{y:560},onChange:E,pagination:{current:r.pageNumber,total:U.value,showSizeChanger:!0,pageSize:r.pageSize}},{bodyCell:t(({column:o,record:v})=>[o.key=="status"?(p(),C(N,{key:0},[v.status=="1"?(p(),m(T,{key:0,color:"#87d068"},{default:t(()=>[d("启用")]),_:1})):(p(),m(T,{key:1,color:"#f50"},{default:t(()=>[d("停用")]),_:1}))],64)):f("",!0),o.key=="settingType"?(p(),m(T,{key:1},{default:t(()=>[d(de(K.value[v.settingType]||"未定义"),1)]),_:2},1024)):f("",!0),o.key=="action"?(p(),C(N,{key:2},[D((p(),m(c,{type:"link",onClick:ae=>X(v)},{default:t(()=>[d("编辑")]),_:2},1032,["onClick"])),[[F,"system:setting:update"]]),a(Q,{type:"vertical"}),a(W,{title:"确定要删除吗?","ok-text":"确定","cancel-text":"取消",onConfirm:ae=>Y(v)},{default:t(()=>[D((p(),m(c,{type:"link",danger:""},{default:t(()=>[d("删除")]),_:1})),[[F,"system:setting:remove"]])]),_:2},1032,["onConfirm"])],64)):f("",!0),o.key=="settingType"?(p(),C(N,{key:3},[v.settingType=="app"?(p(),m(T,{key:0,color:"#2db7f5"},{default:t(()=>[d("菜单")]),_:1})):f("",!0),v.settingType=="directory"?(p(),m(T,{key:1,color:"#87d068"},{default:t(()=>[d("目录")]),_:1})):f("",!0)],64)):f("",!0)]),_:1},8,["loading","columns","data-source","pagination"])]),_:1}),a(te,{open:k.value,"onUpdate:open":e[7]||(e[7]=o=>k.value=o),onOk:H,title:G.value,onCancel:O},{default:t(()=>[a(q,{model:l.value,"label-col":{span:8},ref_key:"modalFormRef",ref:S},{default:t(()=>[a(u,{label:"配置键名",required:"",prop:"settingKey"},{default:t(()=>[a(x,{value:l.value.settingKey,"onUpdate:value":e[2]||(e[2]=o=>l.value.settingKey=o)},null,8,["value"])]),_:1}),a(u,{label:"配置值",required:"",prop:"settingValue"},{default:t(()=>[a($,{"auto-size":"",value:l.value.settingValue,"onUpdate:value":e[3]||(e[3]=o=>l.value.settingValue=o)},null,8,["value"])]),_:1}),a(u,{label:"配置类型",required:"",prop:"settingType"},{default:t(()=>[a(s,{value:l.value.settingType,"onUpdate:value":e[4]||(e[4]=o=>l.value.settingType=o),options:w.value},null,8,["value","options"])]),_:1}),a(u,{label:"状态",required:"",prop:"status"},{default:t(()=>[a(ee,{value:l.value.status,"onUpdate:value":e[5]||(e[5]=o=>l.value.status=o),"button-style":"solid"},{default:t(()=>[a(L,{value:"1"},{default:t(()=>[d("启用 ")]),_:1}),a(L,{value:"0"},{default:t(()=>[d("停用 ")]),_:1})]),_:1},8,["value"])]),_:1}),a(u,{label:"备注",prop:"remark"},{default:t(()=>[a($,{value:l.value.remark,"onUpdate:value":e[6]||(e[6]=o=>l.value.remark=o),rows:5},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","title"])])}}}),Ue=we(Se,[["__scopeId","data-v-466a4e09"]]);export{Ue as default};
