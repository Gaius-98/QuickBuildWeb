import{r as A,c as X}from"./index-D8lfZff5.js";import{g as j,a4 as G,r as p,a5 as J,o as d,z as D,m as a,w as e,a6 as K,a7 as Q,B as t,h as f,T as o,X as x,F as W,L as Z,a2 as ee,aq as ae,M as te,a0 as le,aa as oe,ac as ne,ar as se,as as ue}from"./.pnpm-i8FCJJ8r.js";import{_ as re}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ie={getList:C=>A({method:"get",url:"operationlog/list",params:C})},pe={class:"optLog"},ce=j({__name:"OptLog",setup(C){const s=G({keyword:"",startTime:"",endTime:"",pageNumber:1,pageSize:20}),v=p(""),w=p([]),q=p([{title:"操作用户",key:"username",dataIndex:"username"},{title:"ip地址",key:"ip",dataIndex:"ip"},{title:"地址",key:"location",dataIndex:"location"},{title:"操作模块",key:"optModule",dataIndex:"optModule"},{title:"操作类型",key:"optType",dataIndex:"optType"},{title:"操作结果",key:"resStatus",dataIndex:"resStatus"},{title:"响应时间",key:"resTime",dataIndex:"resTime"},{title:"操作时间",key:"createTime",dataIndex:"createTime"},{title:"操作",key:"action",dataIndex:"action",width:"250px"}]),h=p(!1),M=p(),B=()=>{var i;(i=M.value)==null||i.resetFields(),k()},L=p(0),P=()=>{s.pageNumber=1,s.pageSize=20,k()},U=()=>{v.value?(s.startTime=v.value[0],s.endTime=v.value[1]):(s.startTime="",s.endTime="")},V=i=>{const{current:u,pageSize:_}=i;s.pageNumber=u,s.pageSize=_,k()},k=()=>{h.value=!0,ie.getList(s).then(i=>{const{code:u,data:_}=i;u==200&&(w.value=_.data,L.value=_.total),h.value=!1})},l=p({}),I=p(!1),Y=i=>{l.value=i,I.value=!0},F=p([]),g=p(new Map),O=["green","cyan","red","pink","orange","blue","purple"];return J(()=>{k(),X.getDict(["optType"]).then(i=>{const{code:u,data:_,msg:T}=i;u==200&&(F.value=_.optType,F.value.forEach((b,y)=>{g.value.set(b.value,{label:b.label,color:O[y]})}))})}),(i,u)=>{const _=Z,T=ee,b=ae,y=te,R=le,N=K,m=oe,E=ne,n=se,H=ue,$=Q;return d(),D("div",pe,[a(N,{class:"search-area"},{default:e(()=>[a(R,{ref_key:"searchFormRef",ref:M,model:s,layout:"inline",onFinish:P},{default:e(()=>[a(T,{label:"用户名",name:"keyword"},{default:e(()=>[a(_,{value:s.keyword,"onUpdate:value":u[0]||(u[0]=r=>s.keyword=r)},null,8,["value"])]),_:1}),a(T,{label:"操作日期"},{default:e(()=>[a(b,{value:v.value,"onUpdate:value":u[1]||(u[1]=r=>v.value=r),showTime:!0,valueFormat:"YYYY-MM-DD HH:mm:ss",onChange:u[2]||(u[2]=r=>U())},null,8,["value"])]),_:1}),a(T,null,{default:e(()=>[a(y,{type:"primary","html-type":"submit"},{default:e(()=>[t("搜索")]),_:1}),a(y,{style:{margin:"0 8px"},onClick:B},{default:e(()=>[t(" 重置 ")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(N,null,{default:e(()=>[a(E,{loading:h.value,columns:q.value,"data-source":w.value,scroll:{y:600},onChange:V,pagination:{current:s.pageNumber,total:L.value,showSizeChanger:!0,pageSize:s.pageSize}},{bodyCell:e(({column:r,record:c})=>{var z;return[r.key=="optType"?(d(),f(m,{key:0,color:(z=g.value.get(c.optType))==null?void 0:z.color},{default:e(()=>{var S;return[t(o((S=g.value.get(c.optType))==null?void 0:S.label),1)]}),_:2},1032,["color"])):x("",!0),r.key=="resTime"?(d(),f(m,{key:1,color:parseInt(c.resTime)<500?"#87d068":"#f50"},{default:e(()=>[t(o(c.resTime),1)]),_:2},1032,["color"])):x("",!0),r.key=="resStatus"?(d(),D(W,{key:2},[c.resStatus=="1"?(d(),f(m,{key:0,color:"#87d068"},{default:e(()=>[t("成功")]),_:1})):(d(),f(m,{key:1,color:"#f50"},{default:e(()=>[t("失败")]),_:1}))],64)):x("",!0),r.key=="action"?(d(),f(y,{key:3,type:"link",onClick:S=>Y(c)},{default:e(()=>[t("查看")]),_:2},1032,["onClick"])):x("",!0)]}),_:1},8,["loading","columns","data-source","pagination"])]),_:1}),a($,{open:I.value,"onUpdate:open":u[3]||(u[3]=r=>I.value=r),title:"查看详情",footer:null,width:"1000px"},{default:e(()=>[a(H,{column:2},{default:e(()=>[a(n,{label:"操作用户"},{default:e(()=>[t(o(l.value.username),1)]),_:1}),a(n,{label:"操作IP"},{default:e(()=>[t(o(l.value.ip),1)]),_:1}),a(n,{label:"操作地点"},{default:e(()=>[t(o(l.value.location),1)]),_:1}),a(n,{label:"操作时间"},{default:e(()=>[t(o(l.value.createTime),1)]),_:1}),a(n,{label:"请求类型"},{default:e(()=>[t(o(l.value.reqType),1)]),_:1}),a(n,{label:"请求地址"},{default:e(()=>[t(o(l.value.reqUrl),1)]),_:1}),a(n,{label:"请求参数"},{default:e(()=>[t(o(l.value.reqParam),1)]),_:1}),a(n,{label:"模块名称"},{default:e(()=>[t(o(l.value.moduleName),1)]),_:1}),a(n,{label:"方法名称"},{default:e(()=>[t(o(l.value.funcName),1)]),_:1}),a(n,{label:"操作模块"},{default:e(()=>[t(o(l.value.optModule),1)]),_:1}),a(n,{label:"操作类型"},{default:e(()=>{var r;return[a(m,{color:(r=g.value.get(l.value.optType))==null?void 0:r.color},{default:e(()=>{var c;return[t(o((c=g.value.get(l.value.optType))==null?void 0:c.label),1)]}),_:1},8,["color"])]}),_:1}),a(n,{label:"操作结果"},{default:e(()=>[l.value.resStatus=="1"?(d(),f(m,{key:0,color:"#87d068"},{default:e(()=>[t("成功")]),_:1})):(d(),f(m,{key:1,color:"#f50"},{default:e(()=>[t("失败")]),_:1}))]),_:1}),a(n,{label:"响应时间"},{default:e(()=>[a(m,{color:parseInt(l.value.resTime)<500?"#87d068":"#f50"},{default:e(()=>[t(o(l.value.resTime),1)]),_:1},8,["color"])]),_:1}),a(n,{label:"请求结果",span:4},{default:e(()=>[t(o(l.value.res),1)]),_:1}),a(n,{label:"异常信息",span:4},{default:e(()=>[t(o(l.value.errMsg),1)]),_:1})]),_:1})]),_:1},8,["open"])])}}}),fe=re(ce,[["__scopeId","data-v-f0f56045"]]);export{fe as default};
