import{a as v}from"./notice-D-d6iT3F.js";import{c as W}from"./main-BmbtOdKc.js";import{g as X,a0 as Z,r as i,x as B,Q as ee,o as f,y as U,l as a,w as o,e as V,a1 as te,a2 as ae,a3 as oe,N as g,B as ne,a4 as h,h as w,O as le,a5 as se,a6 as ie,a7 as ue,at as ce,U as de,a8 as re,aa as me,ab as pe,ar as _e}from"./.pnpm-CNbA6tN1.js";import{_ as ve}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./iconfont-RswF9Ywb.js";const fe={class:"notice"},ge={class:"tools"},ye=X({__name:"NoticeView",setup(ke){const n=Z({keyword:"",pageNumber:1,pageSize:10,startTime:"",endTime:""}),r=i(""),I=()=>{r.value?(n.startTime=r.value[0],n.endTime=r.value[1]):(n.startTime="",n.endTime="")},T=i([]),M=i([{title:"标题",key:"title",dataIndex:"title",width:"150px"},{title:"内容",key:"content",dataIndex:"content",width:"400px",ellipsis:!0},{title:"操作",key:"action",dataIndex:"action",width:"250px"}]),k=i(!1),x=i(),R=()=>{var t;(t=x.value)==null||t.resetFields(),n.startTime="",n.endTime="",r.value="",m()},F=i(0),$=()=>{n.pageNumber=1,n.pageSize=10,m()},Y=t=>{const{current:e,pageSize:l}=t;n.pageNumber=e,n.pageSize=l,m()},m=()=>{k.value=!0,v.getList(n).then(t=>{const{code:e,data:l}=t;e==200&&(T.value=l.data,F.value=l.total),k.value=!1})},N=i([]),L=i({});B(()=>{m(),W.getDict(["configType"]).then(t=>{const{code:e,data:l,msg:u}=t;e==200&&(N.value=l.configType,L.value=N.value.reduce((y,d)=>(y[d.value]=d.label,y),{}))})});const p=i(!1),c=i({title:"",content:""}),_=i("add"),P=ee(()=>({add:"新增通知",edit:"编辑通知"})[_.value]),b=i(),j=()=>{_.value="add",p.value=!0,c.value={title:"",content:""}},q=async t=>{const{code:e,data:l}=await v.getDetail(t.id);e==200&&(c.value=l,_.value="edit",p.value=!0)},A=async t=>{const{code:e,msg:l,data:u}=await v.remove(t.id);e==200&&(V.success(u),m())},D=()=>{var t;(t=b.value)==null||t.resetFields()},E=()=>{var t;(t=b.value)==null||t.validate().then(()=>{let e;_.value=="add"?e=v.add:e=v.update,e(c.value).then(l=>{const{code:u}=l;u==200&&(V.success(_.value=="add"?"新增成功":"编辑成功"),m()),D(),p.value=!1})})};return B(()=>{}),(t,e)=>{const l=ie,u=ue,y=ce,d=de,S=re,z=te,H=me,Q=pe,G=_e,J=ae,C=oe("has-perm");return f(),U("div",fe,[a(z,{class:"search-area"},{default:o(()=>[a(S,{ref_key:"searchFormRef",ref:x,model:n,layout:"inline",onFinish:$},{default:o(()=>[a(u,{label:"关键字",prop:"keyword"},{default:o(()=>[a(l,{value:n.keyword,"onUpdate:value":e[0]||(e[0]=s=>n.keyword=s)},null,8,["value"])]),_:1}),a(u,{label:"日期范围"},{default:o(()=>[a(y,{value:r.value,"onUpdate:value":e[1]||(e[1]=s=>r.value=s),showTime:!0,valueFormat:"YYYY-MM-DD HH:mm:ss",onChange:e[2]||(e[2]=s=>I())},null,8,["value"])]),_:1}),a(u,null,{default:o(()=>[a(d,{type:"primary","html-type":"submit"},{default:o(()=>[g("搜索")]),_:1}),a(d,{style:{margin:"0 8px"},onClick:R},{default:o(()=>[g(" 重置 ")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(z,null,{default:o(()=>[ne("div",ge,[h((f(),w(d,{type:"primary",onClick:j},{default:o(()=>[g("新增")]),_:1})),[[C,"system:notice:add"]])]),a(Q,{loading:k.value,columns:M.value,"data-source":T.value,scroll:{y:560},onChange:Y,pagination:{current:n.pageNumber,total:F.value,showSizeChanger:!0,pageSize:n.pageSize}},{bodyCell:o(({column:s,record:O})=>[s.key=="action"?(f(),U(le,{key:0},[h((f(),w(d,{type:"link",onClick:K=>q(O)},{default:o(()=>[g("编辑")]),_:2},1032,["onClick"])),[[C,"system:notice:update"]]),a(H,{title:"确定要删除吗?","ok-text":"确定","cancel-text":"取消",onConfirm:K=>A(O)},{default:o(()=>[h((f(),w(d,{type:"link",danger:""},{default:o(()=>[g("删除")]),_:1})),[[C,"system:notice:remove"]])]),_:2},1032,["onConfirm"])],64)):se("",!0)]),_:1},8,["loading","columns","data-source","pagination"])]),_:1}),a(J,{open:p.value,"onUpdate:open":e[5]||(e[5]=s=>p.value=s),onOk:E,title:P.value,onCancel:D},{default:o(()=>[a(S,{model:c.value,"label-col":{span:8},ref_key:"modalFormRef",ref:b},{default:o(()=>[a(u,{label:"标题",required:"",prop:"title"},{default:o(()=>[a(l,{value:c.value.title,"onUpdate:value":e[3]||(e[3]=s=>c.value.title=s)},null,8,["value"])]),_:1}),a(u,{label:"内容",required:"",prop:"title"},{default:o(()=>[a(G,{value:c.value.content,"onUpdate:value":e[4]||(e[4]=s=>c.value.content=s),rows:5},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","title"])])}}}),xe=ve(ye,[["__scopeId","data-v-dd27a587"]]);export{xe as default};
