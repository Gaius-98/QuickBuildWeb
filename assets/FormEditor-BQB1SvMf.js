import{g as S,r as P,o as l,y as x,J as M,F as V,Q as K,h as u,w as _,a3 as ce,al as Fe,am as Ue,B as U,O as R,aO as J,t as qe,v as L,x as oe,D as O,aP as pe,i as e,au as ie,av as ue,l as v,P as k,X as de,C as me,aQ as te,aR as fe,aS as _e,aT as be,a1 as ve,U as ye,a9 as he,aU as ge,ab as Pe,aV as we,aW as Ce,an as De,W as Be,a0 as $,a2 as Ie,a4 as ke,f as Ee,aX as Ke,e as Ne,m as Ye,aJ as Re,s as G,aY as Z,A as Oe,G as se,aZ as Ge,a_ as Je,a$ as Qe,b0 as We,aE as Xe,b1 as Ze,aw as je,M as He,b2 as eo,Y as oo,b3 as to,$ as ao,b4 as lo,a5 as ro}from"./.pnpm-BOQ5c3CP.js";import{_ as Q}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{g as A,s as F,c as xe,u as no}from"./index-ByGYGM65.js";import{a as H}from"./form-CydU1bNj.js";import{S as ee}from"./SchemaForm-g1yMXQlM.js";import{d as j}from"./dict-Cc74yU-B.js";const Se=s=>(Fe("data-v-537542b9"),s=s(),Ue(),s),so={class:"material-area"},co={class:"material-layout-area"},po=Se(()=>M("div",{class:"title"},"布局组件",-1)),io={class:"content"},uo={class:"material-data-area"},mo=Se(()=>M("div",{class:"title"},"基础组件",-1)),fo={class:"content"},_o=S({__name:"MaterialArea",setup(s){const c=P({layoutMaterials:[{label:"栅格",value:"grid"},{label:"卡片",value:"card"},{label:"分割线",value:"divider"},{label:"折叠框",value:"collapse"}],dataMaterials:[{label:"输入框",value:"input"},{label:"选择器",value:"select"},{label:"日期选择器",value:"date"},{label:"数字输入框",value:"number"},{label:"开关",value:"switch"},{label:"单选框",value:"radio"},{label:"多选框",value:"checkbox"},{label:"文本域",value:"textarea"}]}),t=o=>{var d;const r=o.target;(d=o.dataTransfer)==null||d.setData("material",r.dataset.material)};return(o,r)=>{const d=ce;return l(),x("div",so,[M("div",co,[po,M("div",io,[(l(!0),x(V,null,K(c.value.layoutMaterials,f=>(l(),u(d,{type:"dashed",key:f.value,draggable:"true",onDragstart:t,"data-material":f.value},{default:_(()=>[U(R(f.label),1)]),_:2},1032,["data-material"]))),128))])]),M("div",uo,[mo,M("div",fo,[(l(!0),x(V,null,K(c.value.dataMaterials,f=>(l(),u(d,{type:"dashed",key:f.value,draggable:"true",onDragstart:t,"data-material":f.value},{default:_(()=>[U(R(f.label),1)]),_:2},1032,["data-material"]))),128))])])])}}}),bo=Q(_o,[["__scopeId","data-v-537542b9"]]),q={formItemProp:{label:"",name:"",required:!1},show:void 0},vo={...q,controlProp:{allowClear:!0,bordered:!0,disabled:!1,maxlength:null,size:"middle"},type:"input",id:""},yo={...q,controlProp:{allowClear:!0,autosize:!1,disabled:!1,maxlength:null,size:"middle"},type:"textarea",id:""},ho={...q,controlProp:{allowClear:!0,bordered:!0,disabled:!1,mode:null,size:"middle",virtual:!0},type:"select",id:""},go={...q,controlProp:{disabled:!1,size:"middle"},type:"switch",id:""},Po={...q,controlProp:{disabled:!1,size:"middle",buttonStyle:"solid",optionType:"button"},type:"radio",id:""},wo={...q,controlProp:{disabled:!1},type:"checkbox",id:""},Co={...q,controlProp:{allowClear:!1,bordered:!0,disabled:!1,format:"YYYY-MM-DD",mode:"",valueFormat:"YYYY-MM-DD",size:"middle",picker:""},type:"date",id:""},Do={...q,controlProp:{disabled:!1,size:"middle",bordered:!0,controls:!0,max:null,min:null,precision:null,step:1},type:"number",id:""},Io={type:"grid",controlProp:{gutter:0,colNumber:2,children:[]},id:"",show:void 0},ko={type:"card",controlProp:{title:"",bordered:!0,hoverable:!1,children:[]},id:"",show:void 0},xo={type:"divider",controlProp:{type:"horizontal",plain:!1,orientation:"left",dashed:!1,title:""},id:"",show:void 0},So={type:"collapse",controlProp:{bordered:!0,ghost:!1,header:"折叠面板",showArrow:!0,defaultExpanded:!0,children:[]},id:"",show:void 0},$o=[vo,go,ho,Po,wo,Io,ko,Co,Do,xo,So,yo],Mo=()=>"field"+new Date().getTime().toString().slice(-4),Vo=(s,c)=>{const t=$o.find(o=>o.type===s);if(t){const o=J(t);if(o.formItemProp){const r=Mo();o.formItemProp.label=r,o.formItemProp.name=r}return o.id=new Date().getTime().toString(),{...o,...c}}else throw new Error(`ControlDefault中${s}不存在,加载配置失败。`)},Lo=S({__name:"MaterialGrid",props:qe({gutter:{},colNumber:{}},{children:{required:!0},childrenModifiers:{}}),emits:["update:children"],setup(s){const c=s,{gutter:t,colNumber:o}=L(c),r=oe(s,"children"),d=O(()=>24/o.value);return pe(()=>o.value,()=>{r.value?r.value.length>o.value?r.value=r.value.slice(0,o.value):r.value=r.value.concat(Array.from({length:o.value-r.value.length}).map(()=>[])):r.value=Array.from({length:o.value}).map(()=>[])},{immediate:!0}),(f,y)=>{const i=ie,b=ue;return l(),u(b,{gutter:e(t)},{default:_(()=>[(l(!0),x(V,null,K(r.value,(h,w)=>(l(),u(i,{class:"gutter-col",span:d.value,key:w},{default:_(()=>[(l(),u(X,{modelValue:r.value[w],"onUpdate:modelValue":g=>r.value[w]=g,key:w},null,8,["modelValue","onUpdate:modelValue"]))]),_:2},1032,["span"]))),128))]),_:1},8,["gutter"])}}}),zo=Q(Lo,[["__scopeId","data-v-bd13b1ec"]]),To=S({__name:"MaterialCard",props:{children:{required:!0},childrenModifiers:{}},emits:["update:children"],setup(s){const c=oe(s,"children");return(t,o)=>{const r=de;return l(),u(r,k(t.$attrs,{bodyStyle:{padding:0,"min-height":"40px"}}),{default:_(()=>[v(X,{modelValue:c.value,"onUpdate:modelValue":o[0]||(o[0]=d=>c.value=d)},null,8,["modelValue"])]),_:1},16)}}}),Ao=S({__name:"MaterialDivider",props:{type:{},plain:{type:Boolean},orientation:{},dashed:{type:Boolean},title:{}},setup(s){const c=s,{title:t,dashed:o,orientation:r,plain:d,type:f}=L(c);return(y,i)=>{const b=me;return l(),u(b,{dashed:e(o),orientation:e(r),plain:e(d),type:e(f)},{default:_(()=>[U(R(e(t)),1)]),_:1},8,["dashed","orientation","plain","type"])}}}),Fo=S({__name:"MaterialCollapse",props:{bordered:{type:Boolean},ghost:{type:Boolean},title:{},showArrow:{type:Boolean},defaultExpanded:{type:Boolean},children:{}},setup(s){const c=s,{title:t,showArrow:o,bordered:r,ghost:d,defaultExpanded:f,children:y}=L(c),i=P(""),b=P(te());return f.value&&(i.value=b.value),(h,w)=>{const g=_e,n=be;return l(),u(n,{activeKey:i.value,"onUpdate:activeKey":w[1]||(w[1]=m=>i.value=m),bordered:e(r),ghost:e(d)},{default:_(()=>[(l(),u(g,{key:b.value,header:e(t),showArrow:e(o)},{default:_(()=>[v(X,{modelValue:e(y),"onUpdate:modelValue":w[0]||(w[0]=m=>fe(y)?y.value=m:null)},null,8,["modelValue"])]),_:1},8,["header","showArrow"]))]),_:1},8,["activeKey","bordered","ghost"])}}}),Uo={input:ve,select:ye,radio:he,switch:ge,number:Pe,checkbox:we,grid:zo,card:To,date:Ce,divider:Ao,collapse:Fo,textarea:De},qo=S({__name:"LowCodeCard",props:{schema:{},formData:{}},setup(s){const c=s,{schema:t,formData:o}=L(c);return(r,d)=>{const f=de;return l(),u(f,{bodyStyle:{padding:0,"min-height":"40px"},title:e(t).controlProp.title,bordered:e(t).controlProp.bordered,hoverable:e(t).controlProp.hoverable},{default:_(()=>[v(W,{schema:e(t).controlProp.children,formData:e(o)},null,8,["schema","formData"])]),_:1},8,["title","bordered","hoverable"])}}}),Bo=S({__name:"LowCodeGrid",props:{schema:{},formData:{}},setup(s){const c=s,{schema:t,formData:o}=L(c),r=O(()=>24/t.value.controlProp.colNumber);return(d,f)=>{const y=ie,i=ue;return l(),u(i,{gutter:e(t).controlProp.gutter},{default:_(()=>[(l(!0),x(V,null,K(e(t).controlProp.children,(b,h)=>(l(),u(y,{class:"gutter-col",span:r.value,key:h},{default:_(()=>[v(W,{schema:b,formData:e(o)},null,8,["schema","formData"])]),_:2},1032,["span"]))),128))]),_:1},8,["gutter"])}}}),Eo=S({__name:"LowCodeCollapse",props:{schema:{},formData:{}},setup(s){const c=s,{schema:t,formData:o}=L(c),r=P(""),d=P(te());return t.value.controlProp.defaultExpanded.value&&(r.value=d.value),(f,y)=>{const i=_e,b=be;return l(),u(b,{activeKey:r.value,"onUpdate:activeKey":y[0]||(y[0]=h=>r.value=h),bordered:e(t).controlProp.bordered,ghost:e(t).controlProp.ghost},{default:_(()=>[(l(),u(i,{key:d.value,header:e(t).controlProp.title,showArrow:e(t).controlProp.showArrow},{default:_(()=>[v(W,{schema:e(t).controlProp.children,formData:e(o)},null,8,["schema","formData"])]),_:1},8,["header","showArrow"]))]),_:1},8,["activeKey","bordered","ghost"])}}}),W=S({__name:"LowCodeFormItem",props:{schema:{},formData:{}},setup(s){const c=s,{schema:t,formData:o}=L(c),r=P([]),d=P({});(()=>{t.value.map(i=>{"dict"in i.controlProp&&r.value.push(i.controlProp.dict)})})();const y=()=>{r.value.length>0&&xe.getDict(r.value).then(i=>{const{code:b,data:h,msg:w}=i;b==200&&r.value.map(g=>{d.value[g]=h[g]})})};return Be(()=>{y()}),(i,b)=>{const h=me,w=ve,g=De,n=ye,m=he,p=Ce,D=Pe,B=we,z=ge,E=Ie;return l(!0),x(V,null,K(e(t),a=>(l(),x(V,null,[["grid","card","collapse","divider"].includes(a.type)?(l(),x(V,{key:0},[a.type=="card"?(l(),u(qo,{key:a.name,schema:a,formData:e(o)},null,8,["schema","formData"])):$("",!0),a.type=="grid"?(l(),u(Bo,{key:a.name,schema:a,formData:e(o)},null,8,["schema","formData"])):$("",!0),a.type=="collapse"?(l(),u(Eo,{key:a.name,schema:a,formData:e(o)},null,8,["schema","formData"])):$("",!0),a.type=="divider"?(l(),u(h,k({key:3},a.controlProp,{key:a.name}),{default:_(()=>[U(R(a.controlProp.title),1)]),_:2},1040)):$("",!0)],64)):(l(),u(E,{label:a.formItemProp.label,name:a.formItemProp.name,key:a.name,required:a.formItemProp.required},{default:_(()=>[a.type=="input"?(l(),u(w,k({key:0,value:e(A)(e(o),a.formItemProp.name),onChange:C=>e(F)(e(o),a.formItemProp.name,C.target.value)},a.controlProp),null,16,["value","onChange"])):$("",!0),a.type=="textarea"?(l(),u(g,k({key:1,value:e(A)(e(o),a.formItemProp.name),onChange:C=>e(F)(e(o),a.formItemProp.name,C.target.value)},a.controlProp),null,16,["value","onChange"])):$("",!0),a.type=="select"?(l(),u(n,k({key:2,value:e(A)(e(o),a.formItemProp.name)},a.controlProp,{options:d.value[a.controlProp.dict],onChange:C=>e(F)(e(o),a.formItemProp.name,C)}),null,16,["value","options","onChange"])):$("",!0),a.type=="radio"?(l(),u(m,k({key:3,value:e(A)(e(o),a.formItemProp.name)},a.controlProp,{options:d.value[a.controlProp.dict],onChange:C=>e(F)(e(o),a.formItemProp.name,C.target.value)}),null,16,["value","options","onChange"])):$("",!0),a.type=="date"?(l(),u(p,k({key:4,value:e(A)(e(o),a.formItemProp.name)},a.controlProp,{onChange:C=>e(F)(e(o),a.formItemProp.name,C)}),null,16,["value","onChange"])):$("",!0),a.type=="number"?(l(),u(D,k({key:5,value:e(A)(e(o),a.formItemProp.name)},a.controlProp,{onChange:C=>e(F)(e(o),a.formItemProp.name,C)}),null,16,["value","onChange"])):$("",!0),a.type=="checkbox"?(l(),u(B,k({key:6,value:e(A)(e(o),a.formItemProp.name)},a.controlProp,{options:d.value[a.controlProp.dict],onChange:C=>e(F)(e(o),a.formItemProp.name,C)}),null,16,["value","options","onChange"])):$("",!0),a.type=="switch"?(l(),u(z,k({key:7,checked:e(A)(e(o),a.formItemProp.name)},a.controlProp,{onChange:C=>e(F)(e(o),a.formItemProp.name,C)}),null,16,["checked","onChange"])):$("",!0)]),_:2},1032,["label","name","required"]))],64))),256)}}}),$e=S({__name:"LowCodeForm",props:{schema:{},formData:{}},setup(s){const c=s,{schema:t,formData:o}=L(c);return(r,d)=>{const f=ke;return l(),u(f,k({model:e(o)},e(t).formConfig),{default:_(()=>[v(W,{formData:e(o),schema:e(t).formCfgItemList},null,8,["formData","schema"])]),_:1},16,["model"])}}}),ae=Ee("formDesign",()=>{const s=P([]),c=P({}),t=P({}),o=P(""),r=n=>{const{id:m,schema:p,name:D,description:B,status:z,belong:E}=n;o.value=m,f.value={name:D,description:B,status:z,belong:E},s.value=p.formCfgItemList,c.value=p.formConfig},d=(n,m)=>{const p=m.findIndex(D=>D.id===n);p!=-1&&(t.value=m[p])},f=P({name:"",description:"",status:1}),y=(n,m)=>{const p=m.findIndex(D=>D.id===n);p!=-1&&m.splice(p,1)},i=()=>{const n=J(t.value);b(n);const m=n;s.value.push(m)},b=n=>{n.id=te(),n.type=="grid"?n.controlProp.children.forEach(m=>{m.forEach(p=>{b(p)})}):n.type=="card"?n.controlProp.children.forEach(m=>{b(m)}):n.type=="collapse"&&n.controlProp.children.forEach(m=>{b(m)})},h=P(!1),w=()=>{const n=document.createElement("div");n.className="preview-form",n.style.width="720px",n.style.height="500px",n.style.overflowY="auto",n.style.padding="10px",Ye($e,{schema:{formCfgItemList:s.value,formConfig:c.value},formData:{}}).mount(n).$el,document.body.appendChild(n)};return{curControlCfg:t,formCfgItemList:s,onSelectControlItem:d,copyControlItem:i,removeControlItem:y,extraFormConfig:f,onSave:async()=>{h.value=!0;let n="";if(w(),document.querySelector(".preview-form")){const z=await Ke(document.querySelector(".preview-form"));z&&(n=z.toDataURL("image/png"),document.body.removeChild(document.querySelector(".preview-form")))}let m=H.add;const p={schema:{formCfgItemList:s.value,formConfig:c.value},...f.value,img:n};o.value&&(m=H.update,p.id=o.value);const{code:D,msg:B}=await m(p);D==200&&Ne.success(B),h.value=!1},id:o,saveLoading:h,setFormDetail:r,formConfig:c}}),Ko=["onClick"],No={class:"material-util"},Yo=["onClick"],Ro=S({__name:"MaterialView",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(s){Re(g=>({"377eb23e":e(t).colorPrimary}));const c=no(),{themeCfg:t}=G(c),o=ae(),{curControlCfg:r}=G(o),{onSelectControlItem:d,copyControlItem:f,removeControlItem:y}=o,i=oe(s,"modelValue"),b=g=>Uo[g],h=(g,n)=>{const m=J(g);switch(n){case"radio":m.options=[{label:"1",value:"1"},{label:"2",value:"2"}];break;case"checkbox":m.options=[{label:"1",value:"1"},{label:"2",value:"2"}];break;case"select":m.options=[{label:"1",value:"1"},{label:"2",value:"2"}];break}return m},w=g=>{if(g.dataTransfer.getData("material")){const n=Vo(g.dataTransfer.getData("material"));i.value.push(n)}};return(g,n)=>{const m=Ie;return l(),u(e(Qe),{list:i.value,"onUpdate:list":n[1]||(n[1]=p=>i.value=p),class:"material-view",onDragover:n[2]||(n[2]=Z(()=>{},["prevent","stop"])),onDrop:Z(w,["stop"]),animation:"300",group:{name:"form",pull:!0,put:!0},"ghost-class":"ghost"},{default:_(()=>[(l(!0),x(V,null,K(i.value,p=>(l(),x("div",{key:p,onClick:Z(D=>e(d)(p.id,i.value),["stop"]),class:Oe(["material-item",{active:p.id===e(r).id}])},[p.formItemProp?(l(),u(m,{key:0,label:p.formItemProp.label,name:p.formItemProp.name},{default:_(()=>[(l(),u(se(b(p.type)),k(h(p.controlProp,p.type),{key:p.id}),null,16))]),_:2},1032,["label","name"])):(l(),u(se(b(p.type)),k({key:1},h(p.controlProp,p.type),{children:p.controlProp.children,"onUpdate:children":D=>p.controlProp.children=D,key:p.id}),null,16,["children","onUpdate:children"])),M("div",No,[M("div",{class:"icon-btn",onClick:n[0]||(n[0]=(...D)=>e(f)&&e(f)(...D)),title:"复制"},[v(e(Ge))]),M("div",{class:"icon-btn",onClick:D=>e(y)(p.id,i.value),title:"删除"},[v(e(Je))],8,Yo)])],10,Ko))),128))]),_:1},8,["list"])}}}),X=Q(Ro,[["__scopeId","data-v-11ca5068"]]),Oo=[{type:"input",properties:{"formItemProp.label":{type:"string",label:"标签文本"},"formItemProp.name":{type:"string",label:"字段名"},"controlProp.allowClear":{type:"switch",label:"可清除"},"controlProp.bordered":{type:"switch",label:"边框"},"controlProp.disabled":{type:"switch",label:"禁用"},"controlProp.size":{type:"radio",label:"大小",component:{dataSource:[{label:"大",value:"large"},{label:"中",value:"middle"},{label:"小",value:"small"}]}},"controlProp.maxlength":{type:"number",label:"最大长度"}}},{type:"textarea",properties:{"formItemProp.label":{type:"string",label:"标签文本"},"formItemProp.name":{type:"string",label:"字段名"},"controlProp.allowClear":{type:"switch",label:"可清除"},"controlProp.autosize":{type:"switch",label:"自适应内容高度"},"controlProp.disabled":{type:"switch",label:"禁用"},"controlProp.size":{type:"radio",label:"大小",component:{dataSource:[{label:"大",value:"large"},{label:"中",value:"middle"},{label:"小",value:"small"}]}},"controlProp.maxlength":{type:"number",label:"最大长度"}}},{type:"select",properties:{"formItemProp.label":{type:"string",label:"标签文本"},"formItemProp.name":{type:"string",label:"字段名"},"controlProp.allowClear":{type:"switch",label:"可清除"},"controlProp.bordered":{type:"switch",label:"边框"},"controlProp.disabled":{type:"switch",label:"禁用"},"controlProp.size":{type:"radio",label:"大小",component:{dataSource:[{label:"大",value:"large"},{label:"中",value:"middle"},{label:"小",value:"small"}]}},"controlProp.virtual":{type:"switch",label:"虚拟滚动"},"controlProp.mode":{type:"select",label:"模式",component:{dataSource:[{label:"多选",value:"multiple"},{label:"标签",value:"tag"}],allowClear:!0}},"controlProp.dict":{type:"select",label:"字典",component:{asyncData:async()=>{const{code:s,data:c,msg:t}=await j.getDictTypeList();return s==200?c.map(o=>({label:o.dictTypeDesc,value:o.dictType})):[]}}}}},{type:"switch",properties:{"formItemProp.label":{type:"string",label:"标签文本"},"formItemProp.name":{type:"string",label:"字段名"},"controlProp.disabled":{type:"switch",label:"禁用"},"controlProp.size":{type:"radio",label:"大小",component:{dataSource:[{label:"大",value:"large"},{label:"中",value:"middle"},{label:"小",value:"small"}]}}}},{type:"radio",properties:{"formItemProp.label":{type:"string",label:"标签文本"},"formItemProp.name":{type:"string",label:"字段名"},"controlProp.disabled":{type:"switch",label:"禁用"},"controlProp.size":{type:"radio",label:"大小",component:{dataSource:[{label:"大",value:"large"},{label:"中",value:"middle"},{label:"小",value:"small"}]}},"controlProp.buttonStyle":{type:"radio",label:"样式",component:{dataSource:[{label:"描边",value:"outline"},{label:"填色",value:"solid"}]}},"controlProp.optionType":{type:"radio",label:"类型",component:{dataSource:[{label:"默认",value:"default"},{label:"按钮",value:"button"}]}},"controlProp.dict":{type:"select",label:"字典",component:{asyncData:async()=>{const{code:s,data:c,msg:t}=await j.getDictTypeList();return s==200?c.map(o=>({label:o.dictTypeDesc,value:o.dictType})):[]}}}}},{type:"checkbox",properties:{"formItemProp.label":{type:"string",label:"标签文本"},"formItemProp.name":{type:"string",label:"字段名"},"controlProp.disabled":{type:"switch",label:"禁用"},"controlProp.dict":{type:"select",label:"字典",component:{asyncData:async()=>{const{code:s,data:c,msg:t}=await j.getDictTypeList();return s==200?c.map(o=>({label:o.dictTypeDesc,value:o.dictType})):[]}}}}},{type:"number",properties:{"formItemProp.label":{type:"string",label:"标签文本"},"formItemProp.name":{type:"string",label:"字段名"},"controlProp.bordered":{type:"switch",label:"边框"},"controlProp.disabled":{type:"switch",label:"禁用"},"controlProp.controls":{type:"switch",label:"控件"},"controlProp.size":{type:"radio",label:"大小",component:{dataSource:[{label:"大",value:"large"},{label:"中",value:"middle"},{label:"小",value:"small"}]}},"controlProp.max":{type:"number",label:"最大值"},"controlProp.min":{type:"number",label:"最小值"},"controlProp.precision":{type:"number",label:"精度"},"controlProp.step":{type:"number",label:"步长"}}},{type:"date",properties:{"formItemProp.label":{type:"string",label:"标签文本"},"formItemProp.name":{type:"string",label:"字段名"},"controlProp.bordered":{type:"switch",label:"边框"},"controlProp.disabled":{type:"switch",label:"禁用"},"controlProp.format":{type:"string",label:"显示格式化"},"controlProp.valueFormat":{type:"string",label:"值格式化"},"controlProp.size":{type:"radio",label:"大小",component:{dataSource:[{label:"大",value:"large"},{label:"中",value:"middle"},{label:"小",value:"small"}]}},"controlProp.mode":{type:"radio",label:"面板",component:{dataSource:[{label:"时间",value:"time"},{label:"日期",value:"date"},{label:"月",value:"month"},{label:"年",value:"year"}]}},"controlProp.picker":{type:"radio",label:"类型",component:{dataSource:[{label:"日期",value:"date"},{label:"周",value:"week"},{label:"月",value:"month"},{label:"年",value:"year"}]}}}},{type:"grid",properties:{"controlProp.gutter":{type:"number",label:"栅格间距"},"controlProp.colNumber":{type:"radio",label:"列配置",component:{dataSource:[{label:"一",value:1},{label:"二",value:2},{label:"三",value:3},{label:"四",value:4}]}}}},{type:"card",properties:{"controlProp.title":{type:"string",label:"标题"},"controlProp.bordered":{type:"switch",label:"边框"},"controlProp.hoverable":{type:"switch",label:"悬浮效果"}}},{type:"divider",properties:{"controlProp.title":{type:"string",label:"标题"},"controlProp.orientation":{type:"radio",label:"标题位置",component:{dataSource:[{label:"左",value:"left"},{label:"中",value:"center"},{label:"右",value:"right"}]}},"controlProp.dashed":{type:"switch",label:"虚线"},"controlProp.plain":{type:"switch",label:"普通正文"}}},{type:"collapse",properties:{"controlProp.title":{type:"string",label:"标题"},"controlProp.bordered":{type:"switch",label:"边框"},"controlProp.ghost":{type:"switch",label:"透明效果"},"controlProp.defaultExpanded":{type:"switch",label:"默认展开"},"controlProp.showArrow":{type:"switch",label:"显示箭头"}}}],Go={key:1},Jo=S({__name:"MaterialCfg",setup(s){const c=ae(),{curControlCfg:t,formConfig:o}=G(c),r=P({layout:{layout:"horizontal",labelAlign:"right",labelCol:{span:8},wrapperCol:{span:16}},properties:{}}),d=P({layout:{layout:"horizontal",labelAlign:"right",labelCol:{span:8},wrapperCol:{span:16}},properties:{labelAlign:{label:"对齐方式",type:"radio",component:{dataSource:[{label:"左对齐",value:"left"},{label:"右对齐",value:"right"}]}},layout:{label:"响应式布局",type:"radio",component:{dataSource:[{label:"响应式",value:"resLayout"},{label:"固定",value:"fixedLayout"}],onChange({field:y,formData:i,value:b}){b=="fixedLayout"?(Reflect.deleteProperty(i.labelCol,"span"),Reflect.deleteProperty(i.labelCol,"offset")):Reflect.deleteProperty(i.labelCol,"style")}}},"labelCol.span":{label:"标签宽度",type:"number",show:"'${formData.layout}' == 'resLayout'"},"labelCol.offset":{label:"偏移量",type:"number",show:"'${formData.layout}' == 'resLayout'"},"labelCol.style.width":{label:"宽度",type:"string",show:"'${formData.layout}' == 'fixedLayout'",tooltip:"单位为百分比或px,如: 100% 或 100px"}}}),f=P("item");return pe(()=>t.value.type,()=>{if(t.value.type){let y=Oo.find(i=>i.type===t.value.type);y&&(r.value.properties=J(y.properties))}},{immediate:!0}),(y,i)=>{const b=Xe,h=Ze,w=We;return l(),u(w,{activeKey:f.value,"onUpdate:activeKey":i[0]||(i[0]=g=>f.value=g),size:"small"},{default:_(()=>[v(h,{key:"item",tab:"控件配置"},{default:_(()=>[e(t).id?(l(),u(e(ee),{schema:r.value,formData:e(t),size:"small",key:e(t).id},null,8,["schema","formData"])):(l(),x("div",Go,[v(b)]))]),_:1}),v(h,{key:"form",tab:"表单配置"},{default:_(()=>[v(e(ee),{schema:d.value,formData:e(o),size:"small"},null,8,["schema","formData"])]),_:1})]),_:1},8,["activeKey"])}}}),Qo={class:"form-design"},Wo={class:"form-design-container"},Xo={class:"middle-part"},Zo=S({__name:"FormEditor",props:{id:{}},setup(s){const c=s,{id:t}=L(c),o=ae(),{formCfgItemList:r,extraFormConfig:d,saveLoading:f,formConfig:y}=G(o),{onSave:i,setFormDetail:b}=o,h=P(!1),w=P(0),g=[{title:"物料区",description:"选择您需要的表单控件",target:()=>document.querySelector(".left-part")},{title:"设计区",description:"将物料区的表单控件拖拽到此区域,可以按照你需要的方式进行布局。",target:()=>document.querySelector(".middle-part")},{title:"配置区",description:"对设计区选中的控件进行配置",target:()=>document.querySelector(".right-part")},{title:"查看实际效果",description:"对已经配置完成的表单进行预览",target:()=>document.querySelector(".preview-btn")},{title:"最后",description:"保存您刚刚的配置",target:()=>document.querySelector(".save-btn")}];t.value?H.getDetail(t.value).then(Y=>{const{code:I,data:N,msg:le}=Y;I==200&&b(N)}):(b({id:"",name:"",description:"",schema:{formCfgItemList:[],formConfig:{labelCol:{span:void 0,offset:void 0},labelAlign:"left"}},img:"",status:1,belong:"private"}),h.value=!0);const n=O(()=>t.value?d.value.name:"新建表单"),m=O(()=>t.value?d.value.description:""),p=P(!1),D=P({layout:{labelAlign:"left",layout:"horizontal",labelCol:{span:4}},properties:{name:{type:"string",label:"表单名称"},description:{type:"string",label:"备注"},belong:{type:"radio",label:"归属",component:{buttonStyle:"solid",asyncData:async()=>{const{code:Y,data:I,msg:N}=await xe.getDict(["belong"]);return Y==200?I.belong:[]}}},status:{type:"radio",label:"状态",component:{buttonStyle:"solid",dataSource:[{label:"启用",value:1},{label:"停用",value:0}]}}}}),B=()=>{p.value=!0},z=je(),E=()=>{z.go(-1)},a=()=>{i().then(()=>{E()}),p.value=!1},C=P(!1),Me=P({}),Ve=()=>{C.value=!0};return(Y,I)=>{const N=ce,le=lo,re=ro,Le=eo,ze=ke,ne=oo,Te=to,Ae=ao("loading");return l(),x(V,null,[M("div",Qo,[v(Le,{title:n.value,subTitle:m.value,onBack:E,ghost:!1,style:{border:"1px solid rgb(235, 237, 240)",padding:"10px 24px"}},{extra:_(()=>[v(le,null,{default:_(()=>[v(N,{onClick:Ve,class:"preview-btn"},{default:_(()=>[U(" 预览 ")]),_:1}),v(N,{onClick:B,type:"primary",class:"save-btn"},{default:_(()=>[U(" 保存 ")]),_:1})]),_:1})]),tags:_(()=>[e(d).status?(l(),u(re,{key:0,color:"#87d068"},{default:_(()=>[U("启用")]),_:1})):(l(),u(re,{key:1,color:"#f50"},{default:_(()=>[U("停用")]),_:1}))]),_:1},8,["title","subTitle"]),He((l(),x("div",Wo,[v(bo,{class:"left-part"}),M("div",Xo,[v(ze,k(e(y),{class:"middle-part-content"}),{default:_(()=>[v(X,{modelValue:e(r),"onUpdate:modelValue":I[0]||(I[0]=T=>fe(r)?r.value=T:null)},null,8,["modelValue"])]),_:1},16)]),v(Jo,{class:"right-part"})])),[[Ae,e(f),void 0,{fullscreen:!0}]])]),v(ne,{open:p.value,"onUpdate:open":I[1]||(I[1]=T=>p.value=T),title:"保存",onOk:a},{default:_(()=>[v(e(ee),{schema:D.value,"form-data":e(d)},null,8,["schema","form-data"])]),_:1},8,["open"]),v(ne,{open:C.value,"onUpdate:open":I[2]||(I[2]=T=>C.value=T),title:"预览",width:"1000px",height:"800px",footer:null},{default:_(()=>[v($e,{formData:Me.value,schema:{formCfgItemList:e(r),formConfig:e(y)}},null,8,["formData","schema"])]),_:1},8,["open"]),v(Te,{current:w.value,"onUpdate:current":I[3]||(I[3]=T=>w.value=T),open:h.value,steps:g,onClose:I[4]||(I[4]=T=>h.value=!1)},null,8,["current","open"])],64)}}}),lt=Q(Zo,[["__scopeId","data-v-987a3264"]]);export{lt as default};
