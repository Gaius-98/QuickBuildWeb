import{u as H,c as ie,a as Z}from"./dashboardDesign-C80zrZ0o.js";import{_ as pe}from"./CodeEditor.vue_vue_type_script_setup_true_name_EvCode_lang-D5LKvrgb.js";import{s as B}from"./nodemodule-pinia@2.1.7_typescript@5.4.2_vue@3.4.21-DRg4DShQ.js";import{M as ee,F as J,h as K,I as te,B as ae,Y as oe,U as ue,V as de,G as me,e as le,W as ce,a as ve}from"./nodemodule-ant-design-vue@4.1.2_vue@3.4.21-D4V-KPiA.js";import{a4 as A,P as j}from"./nodemodule-@ant-design_icons-vue@7.0.1_vue@3.4.21-CO80cFpd.js";import{d as z,K as h,M as g,c as e,F as V,O as R,aI as t,G as O,ar as _e,aq as fe,L as m,m as ye,a2 as q,N as ge,b as G,V as be,ak as he,au as Y,y as xe,z as Ce}from"./nodemodule-@vue_runtime-core@3.4.21-Cnn673wu.js";import{r as v,u as p,x as Se}from"./nodemodule-@vue_reactivity@3.4.21-DbkE7Gi6.js";import{n as ne,O as ke,l as De}from"./nodemodule-@vue_shared@3.4.21-Ctf17_ps.js";import{_ as E,c as W}from"./main-BCN8moWb.js";import{_ as we}from"./ConfigForm.vue_vue_type_script_setup_true_lang-Dl640__R.js";import{S as Ue}from"./SchemaForm-C2pRqjcf.js";import{w as Q}from"./nodemodule-@vue_runtime-dom@3.4.21-CDjXREoQ.js";import"./nodemodule-js-cookie@3.0.5-Cz0CWeBA.js";import{u as Ie}from"./nodemodule-vue-router@4.3.0_vue@3.4.21-BC_007Jj.js";import"./dashboard-BdQ0fc9B.js";import"./DynamicConfig-Bvc-VGnT.js";import"./nodemodule-lodash-es@4.17.21-DcfALcKD.js";import"./nodemodule-html2canvas@1.4.1-Cc_bx5YD.js";import"./nodemodule-vue-codemirror@6.1.1_codemirror@6.0.1_vue@3.4.21-Bq8cZfR3.js";import"./nodemodule-codemirror@6.0.1-Bz5Rqezr.js";import"./nodemodule-@codemirror_view@6.36.8-B6Z_C-qt.js";import"./nodemodule-@codemirror_state@6.5.2-CeTbMir1.js";import"./nodemodule-@marijn_find-cluster-break@1.0.2-DXwl3gUT.js";import"./nodemodule-style-mod@4.1.2-Bc2inJdb.js";import"./nodemodule-w3c-keyname@2.2.8-Vcq4gwWv.js";import"./nodemodule-@codemirror_language@6.11.0-B1CABpZA.js";import"./nodemodule-@lezer_common@1.2.3-DJDOv6L0.js";import"./nodemodule-@lezer_highlight@1.2.1-GwqidMBt.js";import"./nodemodule-@codemirror_commands@6.8.1-DuK1gsD8.js";import"./nodemodule-@codemirror_search@6.5.11-Dlx77ofC.js";import"./nodemodule-crelt@1.0.6-C8TCjufn.js";import"./nodemodule-@codemirror_autocomplete@6.18.6-BkBYzrUm.js";import"./nodemodule-@codemirror_lint@6.8.5-DUOWSouu.js";import"./nodemodule-@codemirror_lang-javascript@6.2.2-kmhBjvJk.js";import"./nodemodule-@lezer_javascript@1.5.1-DGDtd2DH.js";import"./nodemodule-@lezer_lr@1.4.2-CXohaufN.js";import"./nodemodule-@uiw_codemirror-theme-vscode@4.23.6_@codemirror_language@6.11.0_@codemirror_state@6.5.2_@codemirror_view@6.36.8-DmLrXduT.js";import"./nodemodule-@babel_runtime@7.27.1-Bq4_u9L9.js";import"./nodemodule-@uiw_codemirror-themes@4.23.6_@codemirror_language@6.11.0_@codemirror_state@6.5.2_@codemirror_view@6.36.8-CCcrmnXF.js";import"./nodemodule-resize-observer-polyfill@1.5.1-B1PUzC5B.js";import"./nodemodule-dayjs@1.11.13-B6I98uus.js";import"./nodemodule-classnames@2.5.1-BK5ccKcQ.js";import"./nodemodule-@ctrl_tinycolor@3.6.1-DOFZgDuz.js";import"./nodemodule-@ant-design_colors@6.0.0-CBJ--Aym.js";import"./nodemodule-throttle-debounce@5.0.2-CUWDS_la.js";import"./nodemodule-async-validator@4.2.5-9PlIezaS.js";import"./nodemodule-scroll-into-view-if-needed@2.2.31-CLVC0ehY.js";import"./nodemodule-compute-scroll-into-view@1.0.20-1gs_hJI2.js";import"./nodemodule-vue-types@3.0.2_vue@3.4.21-CF28atMM.js";import"./nodemodule-dom-align@1.12.4-CRCehRfe.js";import"./nodemodule-@emotion_hash@0.9.2-WldOFDRm.js";import"./nodemodule-@emotion_unitless@0.8.1-sScrWPmR.js";import"./nodemodule-stylis@4.3.6-D5iaQeiq.js";import"./nodemodule-@ant-design_icons-svg@4.4.2-C9VH68wD.js";/* empty css                                       */import"./nodemodule-axios@1.6.8-BZ84_VUH.js";import"./nodemodule-@vueuse_core@10.9.0_vue@3.4.21-CS6n5tIH.js";import"./nodemodule-@vueuse_shared@10.9.0_vue@3.4.21-IMP1eStj.js";import"./nodemodule-gaius-utils@1.1.8_@types_node@20.11.28_typescript@5.4.2_vite@5.1.6-LqpbgJb2.js";import"./nodemodule-drag-grid-layout-v3@0.0.15_@types_node@20.11.28_typescript@5.4.2_vite@5.1.6-CKjsc2SR.js";import"./nodemodule-echarts@5.5.1-D0X1tymK.js";import"./nodemodule-tslib@2.3.0-BDyQ-Jie.js";import"./nodemodule-zrender@5.6.0-BXroVW6P.js";import"./nodemodule-uuid@9.0.1-CtRu48qb.js";/* empty css                   */const Ne=S=>(_e("data-v-00532e9e"),S=S(),fe(),S),$e={class:"material-area"},qe={class:"material-layout-area"},Me=Ne(()=>g("div",{class:"title"},"内置组件",-1)),Te={class:"content"},Le=["data-material"],Oe={class:"material-label"},Pe={style:{height:"650px"}},Ve={style:{height:"80px","overflow-y":"auto"}},Be={style:{height:"200px","overflow-y":"auto"}},Re=z({__name:"MaterialArea",setup(S){const k=H(),{customModules:D,customComps:w}=B(k),{onAddModules:u}=k,M=v({internalComp:ie,customComp:[]}),d=o=>{var r,a;const l=o.target;(r=o.dataTransfer)==null||r.setData("material",l.dataset.material),(a=o.dataTransfer)==null||a.setData("material-type",l.dataset.materialType)},b=v(!1);v({title:"element",package:"element-plus",version:"2.9.2",exportName:"ElementPlus",urls:["https://cdn.jsdelivr.net/npm/element-plus@2.9.2/dist/index.full.min.js","https://cdn.jsdelivr.net/npm/element-plus@2.9.2/dist/index.min.css"],children:[{componentName:"ElEmpty",exportName:"ElEmpty",id:"1",schema:`{
    "description": {
        "type": "input",
        "label": "描述"
    }

      }`}]});const n=v({}),f=()=>{b.value=!1},$=()=>{u(n.value),f()},U=()=>{n.value.children.push({componentName:"",exportName:"",id:new Date().getTime().toString()})},y=o=>{const l=n.value.children.findIndex(r=>r.id==o.id);l!=-1&&n.value.children.splice(l,1)},c=()=>{n.value.urls.push("")},i=o=>{const l=n.value.urls.findIndex(r=>r==o);l!=-1&&n.value.urls.splice(l,1)};return(o,l)=>{const r=te,a=K,x=ae,N=oe,I=pe,F=J,T=ee;return m(),h("div",$e,[g("div",qe,[Me,g("div",Te,[(m(!0),h(V,null,R(M.value.internalComp,s=>(m(),h("div",{key:s.name,draggable:"true",onDragstart:d,"data-material":s.name,"data-material-type":"internal",class:"material-item"},[g("span",{class:ne(["iconfont material-icon",s.icon])},null,2),g("span",Oe,ke(s.label),1)],40,Le))),128))])]),e(T,{title:"添加自定义组件",width:"800px",open:b.value,"onUpdate:open":l[4]||(l[4]=s=>b.value=s),onOk:$,onCancel:f},{default:t(()=>[g("div",Pe,[e(F,{model:n.value,"label-col":{style:{width:"150px"}}},{default:t(()=>[e(a,{label:"名称"},{default:t(()=>[e(r,{value:n.value.title,"onUpdate:value":l[0]||(l[0]=s=>n.value.title=s)},null,8,["value"])]),_:1}),e(a,{label:"组件库名称"},{default:t(()=>[e(r,{value:n.value.package,"onUpdate:value":l[1]||(l[1]=s=>n.value.package=s)},null,8,["value"])]),_:1}),e(a,{label:"版本"},{default:t(()=>[e(r,{value:n.value.version,"onUpdate:value":l[2]||(l[2]=s=>n.value.version=s)},null,8,["value"])]),_:1}),e(a,{label:"导出名称"},{default:t(()=>[e(r,{value:n.value.exportName,"onUpdate:value":l[3]||(l[3]=s=>n.value.exportName=s)},null,8,["value"])]),_:1}),e(a,{label:"CDN地址"},{default:t(()=>[g("div",Ve,[(m(!0),h(V,null,R(n.value.urls,(s,P)=>(m(),h("div",{key:s,style:{display:"flex","margin-bottom":"8px"},align:"baseline"},[e(r,{value:n.value.urls[P],"onUpdate:value":C=>n.value.urls[P]=C},null,8,["value","onUpdate:value"]),e(p(A),{onClick:C=>i(s),style:{padding:"0 10px"}},null,8,["onClick"])]))),128))]),e(a,null,{default:t(()=>[e(x,{type:"dashed",block:"",onClick:c},{default:t(()=>[e(p(j)),O(" 增加CDN地址 ")]),_:1})]),_:1})]),_:1}),e(a,{label:"子组件"},{default:t(()=>[g("div",Be,[(m(!0),h(V,null,R(n.value.children,(s,P)=>(m(),h("div",{key:s.id,style:{display:"flex","margin-bottom":"8px","border-bottom":"1px solid #ccc"},align:"baseline"},[e(N,null,{default:t(()=>[g("div",null,[e(N,null,{default:t(()=>[e(a,{label:"组件名",rules:{required:!0}},{default:t(()=>[e(r,{value:s.componentName,"onUpdate:value":C=>s.componentName=C},null,8,["value","onUpdate:value"])]),_:2},1024),e(a,{label:"导出名称",rules:{required:!0}},{default:t(()=>[e(r,{value:s.exportName,"onUpdate:value":C=>s.exportName=C},null,8,["value","onUpdate:value"])]),_:2},1024)]),_:2},1024),e(a,{label:"配置Schema",rules:{required:!0}},{default:t(()=>[e(I,{value:s.schema,"onUpdate:value":C=>s.schema=C,theme:"light",height:"110"},null,8,["value","onUpdate:value"])]),_:2},1024)]),e(p(A),{onClick:C=>y(s)},null,8,["onClick"])]),_:2},1024)]))),128))]),e(a,null,{default:t(()=>[e(x,{type:"dashed",block:"",onClick:U},{default:t(()=>[e(p(j)),O(" 增加子组件 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])])]),_:1},8,["open"])])}}}),ze=E(Re,[["__scopeId","data-v-00532e9e"]]),Ee={text:{type:"input",label:"文本内容"}},Fe={src:{type:"input",label:"图片地址"}},We={src:{type:"input",label:"页面地址"}},Ae=S=>({dataset:{type:"select",label:"数据集",options:S},dimension:{type:"select",label:"维度",options:[],mode:"multiple"},target:{type:"select",label:"指标",options:[],mode:"multiple"}}),je={"qb-text":Ee,"qb-image":Fe,"qb-iframe":We,"qb-chart":Ae},Ge={title1:{type:"divider",label:"标题",component:{title:"标题"},formLayout:!1},"option.title.show":{type:"switch",label:"显示标题"},"option.title.text":{type:"string",label:"标题文本"},"option.title.link":{type:"string",label:"文本超链接"},title2:{type:"divider",label:"布局",component:{title:"布局"},formLayout:!1},"option.grid.left":{type:"string",label:"左边距"},"option.grid.right":{type:"string",label:"右边距"},"option.grid.top":{type:"string",label:"上边距"},"option.grid.bottom":{type:"string",label:"下边距"},title3:{type:"divider",label:"图例",component:{title:"图例"},formLayout:!1},"option.legend.show":{type:"switch",label:"显示图例"},"option.legend.type":{type:"select",label:"图例类型",component:{dataSource:[{label:"普通图例",value:"plain"},{label:"翻页图例",value:"scroll"}]}},"option.legend.orient":{type:"select",label:"图例朝向",component:{dataSource:[{value:"horizontal",label:"横向"},{value:"vertical",label:"纵向"}]}},title4:{type:"divider",label:"边框",component:{title:"边框"},formLayout:!1},borderWidth:{type:"string",label:"边框宽度",tooltip:"请注明单位，一般为：px"},borderColor:{type:"string",label:"边框颜色",component:{name:"color-picker"}},borderStyle:{type:"radio",label:"边框样式",component:{dataSource:[{label:"无边框",value:"none"},{label:"虚线",value:"dashed"},{label:"实线",value:"solid"}],buttonStyle:"solid"}},borderRadius:{type:"string",label:"边框圆角",tooltip:"请注明单位，可以为%或者px"}},X={title1:{type:"divider",label:"布局",component:{title:"布局"},formLayout:!1},paddingLeft:{type:"string",label:"左边距",tooltip:"请注明单位，一般为：px"},paddingTop:{type:"string",label:"上边距",tooltip:"请注明单位，一般为：px"},paddingRight:{type:"string",label:"右边距",tooltip:"请注明单位，一般为：px"},paddingBottom:{type:"string",label:"下边距",tooltip:"请注明单位，一般为：px"},title2:{type:"divider",label:"背景",component:{title:"背景"},formLayout:!1},backgroundColor:{type:"string",label:"背景色",component:{name:"color-picker"}},title3:{type:"divider",label:"边框",component:{title:"边框"},formLayout:!1},borderWidth:{type:"string",label:"边框宽度",tooltip:"请注明单位，一般为：px"},borderColor:{type:"string",label:"边框颜色",component:{name:"color-picker"}},borderStyle:{type:"radio",label:"边框样式",component:{dataSource:[{label:"无边框",value:"none"},{label:"虚线",value:"dashed"},{label:"实线",value:"solid"}],buttonStyle:"solid"}},borderRadius:{type:"string",label:"边框圆角",tooltip:"请注明单位，可以为%或者px"}},He={class:"material-cfg"},Je=z({__name:"MaterialCfg",setup(S){const k=H(),{customCompSchema:D}=B(k),w=Z(),{curComp:u}=B(w),{updateItem:M}=w,d=v({}),b=v({}),n=v({}),f=v({layout:{labelAlign:"left",layout:"horizontal",labelCol:{style:{width:"100px"}}},properties:X}),$=v([]);W.getDatasetDict().then(c=>{const{code:i,data:o,msg:l}=c;i==200&&($.value=o)});const U=v([]),y=()=>{d.value.dimension=[],d.value.target=[],W.getFieldByDatasetId(d.value.dataset).then(c=>{const{code:i,data:o,msg:l}=c;i==200&&(U.value=o.map(r=>({value:r,label:r})))})};return ye(()=>u.value.id,()=>{var c;f.value.properties=X,((c=u.value)==null?void 0:c.type)==="custom"?D.value&&(b.value=JSON.parse(D.value[u.value.component])):u.value.component=="qb-chart"?f.value.properties=Ge:b.value=je[u.value.component],d.value=u.value.props,u.value.component=="qb-chart"&&W.getFieldByDatasetId(d.value.dataset).then(i=>{const{code:o,data:l,msg:r}=i;o==200&&(U.value=l.map(a=>({value:a,label:a})))}),n.value=u.value.style},{deep:!0}),(c,i)=>{const o=me,l=le,r=K,a=J,x=de,N=ue;return m(),h("div",He,[e(N,{size:"small"},{default:t(()=>[e(x,{key:"prop",tab:"属性"},{default:t(()=>[p(u).id?p(u).component!="qb-chart"?(m(),q(we,{class:"material-cfg-contain",key:p(u).id,data:d.value,schema:b.value},null,8,["data","schema"])):p(u).component=="qb-chart"?(m(),q(a,{key:2},{default:t(()=>[e(r,{label:"数据集"},{default:t(()=>[e(l,{value:d.value.dataset,"onUpdate:value":i[0]||(i[0]=I=>d.value.dataset=I),options:$.value,onChange:y},null,8,["value","options"])]),_:1}),e(r,{label:"维度"},{default:t(()=>[e(l,{value:d.value.dimension,"onUpdate:value":i[1]||(i[1]=I=>d.value.dimension=I),options:U.value,mode:"tags"},null,8,["value","options"])]),_:1}),e(r,{label:"指标"},{default:t(()=>[e(l,{value:d.value.target,"onUpdate:value":i[2]||(i[2]=I=>d.value.target=I),options:U.value,mode:"tags"},null,8,["value","options"])]),_:1})]),_:1})):ge("",!0):(m(),q(o,{key:0}))]),_:1}),e(x,{key:"style",tab:"样式"},{default:t(()=>[(m(),q(p(Ue),{schema:f.value,size:"small",formData:n.value,key:p(u).id},null,8,["schema","formData"]))]),_:1})]),_:1})])}}}),Ke=E(Je,[["__scopeId","data-v-9019cea1"]]),Ye=12,Qe=8,Xe=z({__name:"DashboardDesign",setup(S){const k=Z(),{dgList:D}=B(k),{initDgItem:w,add:u,selectItem:M,transformProps:d}=k,b=v(!1),n=v(),f=v(0),$=y=>{const c=y.dataTransfer.getData("material-type");let i;c=="custom"?i={name:y.dataTransfer.getData("material"),id:new Date().getTime().toString(),label:"自定义组件",icon:"",type:"custom",component:y.dataTransfer.getData("material"),props:{},style:{},rowStart:1,colStart:1,rowSpan:5,colSpan:2}:i=w(y.dataTransfer.getData("material"));const o=y.x/(f.value/Ye),l=y.y/Qe;i.colStart=Math.floor(o),i.rowStart=Math.floor(l),u(i)},U=v({});return G(()=>{f.value=n.value.clientWidth}),(y,c)=>{const i=be("grid-layout");return m(),h("div",{class:"editor-container",ref_key:"container",ref:n,onDragover:c[0]||(c[0]=Q(()=>{},["prevent","stop"])),onDrop:Q($,["stop"])},[e(i,{list:p(D),class:ne(["layout",{readonly:b.value}]),readonly:b.value,"onItem:click":p(M)},{"layout-item":t(({item:o})=>[g("div",{class:"comp-container",style:De(o.style)},[o.type&&o.type==="custom"?(m(),q(Y(U.value[o.component]),he({key:0},p(d)(o.props),{key:o.id}),null,16)):(m(),q(Y(o.component),{"style-config":o.style,attrs:p(d)(o.props),key:o.id},null,8,["style-config","attrs"]))],4)]),_:1},8,["list","class","readonly","onItem:click"])],544)}}}),Ze=E(Xe,[["__scopeId","data-v-f511d43d"]]),et={class:"dg-design"},tt={class:"dg-design-container"},at={class:"middle-part"},ot={style:{height:"300px","overflow-y":"auto"}},lt=z({__name:"DashboardDesign",props:{id:{}},setup(S){const k=H(),{varPools:D,dgInfo:w,loading:u}=B(k),{onSave:M,getDetail:d}=k;window.name="dg-design";const b=S,{id:n}=Se(b);G(()=>{n.value&&d(n.value)});const f=v(!1),$=()=>{f.value=!0},U=()=>{M()};G(()=>{});const y=()=>{D.value.vars.push({name:"",type:"",defaultValue:""})},c=v([{label:"字符串",value:"string"},{label:"数字",value:"number"},{label:"布尔",value:"boolean"},{label:"数组",value:"array"},{label:"对象",value:"object"}]),i=r=>{const a=D.value.vars.findIndex(x=>x.name===r.name);a!=-1&&D.value.vars.splice(a,1)},o=Ie(),l=()=>{w.value.id||ve.warning("请保存后再预览");const r=o.resolve({path:"/preview-dashboard",query:{id:w.value.id}});window.open(r.href,"_blank")};return(r,a)=>{const x=te,N=ae,I=oe,F=ce,T=K,s=le,P=J,C=ee,se=Ce("loading");return m(),h(V,null,[xe((m(),h("div",et,[e(F,{ghost:!1,style:{border:"1px solid rgb(235, 237, 240)",padding:"10px 24px"}},{title:t(()=>[e(x,{bordered:!1,class:"form-name",value:p(w).name,"onUpdate:value":a[0]||(a[0]=_=>p(w).name=_)},null,8,["value"])]),extra:t(()=>[e(I,null,{default:t(()=>[e(N,{type:"primary",onClick:a[1]||(a[1]=_=>$())},{default:t(()=>[O("变量池")]),_:1}),e(N,{class:"preview-btn",onClick:a[2]||(a[2]=_=>l())},{default:t(()=>[O(" 预览 ")]),_:1}),e(N,{onClick:a[3]||(a[3]=_=>U()),type:"primary",class:"save-btn"},{default:t(()=>[O(" 保存 ")]),_:1})]),_:1})]),_:1}),g("div",tt,[e(ze,{class:"left-part"}),g("div",at,[e(Ze)]),e(Ke,{class:"right-part"})])])),[[se,p(u),void 0,{fullscreen:!0}]]),e(C,{title:"变量池",open:f.value,"onUpdate:open":a[4]||(a[4]=_=>f.value=_),width:"800px",footer:null},{default:t(()=>[e(P,null,{default:t(()=>[g("div",ot,[(m(!0),h(V,null,R(p(D).vars,(_,re)=>(m(),q(I,{key:re,style:{display:"flex","margin-bottom":"8px"},align:"baseline"},{default:t(()=>[e(T,{label:"变量名",required:!0},{default:t(()=>[e(x,{value:_.name,"onUpdate:value":L=>_.name=L},null,8,["value","onUpdate:value"])]),_:2},1024),e(T,{label:"变量类型",required:!0},{default:t(()=>[e(s,{style:{width:"150px"},value:_.type,"onUpdate:value":L=>_.type=L,options:c.value},null,8,["value","onUpdate:value","options"])]),_:2},1024),e(T,{label:"默认值",required:!0},{default:t(()=>[e(x,{value:_.defaultValue,"onUpdate:value":L=>_.defaultValue=L},null,8,["value","onUpdate:value"])]),_:2},1024),e(p(A),{onClick:L=>i(_)},null,8,["onClick"])]),_:2},1024))),128))]),e(T,null,{default:t(()=>[e(N,{type:"dashed",block:"",onClick:y},{default:t(()=>[e(p(j)),O(" 添加变量 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])],64)}}}),fa=E(lt,[["__scopeId","data-v-80e45d9d"]]);export{fa as default};
