import"./nodemodule-mobx-preact@3.0.0_mobx@5.15.7_preact@10.26.1-BAdAl0TJ.js";import{_,u as S,x as xe,b as kt}from"./nodemodule-preact@10.26.1-VQRbO-O1.js";import{C as gt,a as mt,P as Ce,b as Te,c as _t,d as xt,R as we,e as te,M as ne,S as wt,f as bt,E as Gt,g as Yt,D as Ut,h as qt,i as Vt,H as Kt,j as Jt,k as Zt,l as Qt,m as De,o as Mt,n as en}from"./nodemodule-@logicflow_core@2.0.7-D9adiHqZ.js";import{w as tn,j as nn,y as Ot,f as W,z as Re,a as rn,m as Ie,g as on}from"./nodemodule-lodash-es@4.17.21-DcfALcKD.js";import{o as A,t as an}from"./nodemodule-mobx@5.15.7-BNbkWaZx.js";import{c as Le}from"./nodemodule-classnames@2.5.1-BK5ccKcQ.js";import{M as oe}from"./nodemodule-medium-editor@5.23.3-D6uvSLuC.js";import{P as ln}from"./nodemodule-vanilla-picker@2.12.3-D-dNiDpH.js";import{r as ze}from"./nodemodule-rangy@1.3.2-DE1SPTYs.js";var We={width:40,height:40},He={width:40,height:40},Xe={width:40,height:40},Fe={width:100,height:80},Be={width:100,height:80},sn=function(){function i(){globalThis._ids=this,this._ids=new Set}return i.prototype.generateId=function(){return"xxxxxxx".replace(/[x]/g,function(n){var e=Math.random()*16|0,t=n==="x"?e:e&3|8;return t.toString(16)})},i.prototype.next=function(){for(var n=this.generateId();this._ids.has(n);)n=this.generateId();return this._ids.add(n),n},i}(),dn=(globalThis==null?void 0:globalThis._ids)||new sn;function Y(){return dn.next()}var St=function(){var i=function(n,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])},i(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}}();(function(i){St(n,i);function n(e,t){return e.id||(e.id="Event_".concat(Y())),e.text||(e.text=""),e.text&&typeof e.text=="string"&&(e.text={value:e.text,x:e.x,y:e.y+40}),i.call(this,e,t)||this}return n.prototype.setAttributes=function(){this.r=18},n.prototype.getConnectedTargetRules=function(){var e=i.prototype.getConnectedTargetRules.call(this),t={message:"起始节点不能作为边的终点",validate:function(){return!1}};return e.push(t),e},n.extendKey="StartEventModel",n})(gt);(function(i){St(n,i);function n(){return i!==null&&i.apply(this,arguments)||this}return n.extendKey="StartEventNode",n})(mt);var Et=function(){var i=function(n,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])},i(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}}(),ae=function(){return ae=Object.assign||function(i){for(var n,e=1,t=arguments.length;e<t;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r])}return i},ae.apply(this,arguments)};(function(i){Et(n,i);function n(e,t){return e.id||(e.id="Event_".concat(Y())),e.text||(e.text=""),e.text&&typeof e.text=="string"&&(e.text={value:e.text,x:e.x,y:e.y+40}),i.call(this,e,t)||this}return n.prototype.setAttributes=function(){this.r=18},n.prototype.getConnectedSourceRules=function(){var e=i.prototype.getConnectedSourceRules.call(this),t={message:"结束节点不能作为边的起点",validate:function(){return!1}};return e.push(t),e},n.extendKey="EndEventModel",n})(gt);(function(i){Et(n,i);function n(){return i!==null&&i.apply(this,arguments)||this}return n.prototype.getAnchorStyle=function(){return{visibility:"hidden"}},n.prototype.getShape=function(){var e=this.props.model,t=e.getNodeStyle(),r=e,o=r.x,a=r.y,l=r.r,s=i.prototype.getShape.call(this);return _("g",{},s,_("circle",ae(ae({},t),{cx:o,cy:a,r:l-5})))},n.extendKey="EndEventView",n})(mt);var Nt=function(){var i=function(n,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])},i(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}}();(function(i){Nt(n,i);function n(e,t){return e.id||(e.id="Flow_".concat(Y())),i.call(this,e,t)||this}return n.extendKey="SequenceFlowModel",n})(Ce);(function(i){Nt(n,i);function n(){return i!==null&&i.apply(this,arguments)||this}return n.extendKey="SequenceFlowEdge",n})(Te);var At=function(){var i=function(n,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])},i(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}}(),Z=function(){return Z=Object.assign||function(i){for(var n,e=1,t=arguments.length;e<t;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r])}return i},Z.apply(this,arguments)};(function(i){At(n,i);function n(e,t){var r=this;return e.id||(e.id="Gateway_".concat(Y())),e.text||(e.text=""),e.text&&typeof e.text=="string"&&(e.text={value:e.text,x:e.x,y:e.y+40}),r=i.call(this,e,t)||this,r.points=[[25,0],[50,25],[25,50],[0,25]],r}return n.extendKey="ExclusiveGatewayModel",n})(_t);(function(i){At(n,i);function n(){return i!==null&&i.apply(this,arguments)||this}return n.prototype.getShape=function(){var e=this.props.model,t=e,r=t.x,o=t.y,a=t.width,l=t.height,s=t.points,d=e.getNodeStyle();return _("g",{transform:"matrix(1 0 0 1 ".concat(r-a/2," ").concat(o-l/2,")")},_("polygon",Z(Z({},d),{x:r,y:o,points:s})),_("path",Z({d:"m 16,15 7.42857142857143,9.714285714285715 -7.42857142857143,9.714285714285715 3.428571428571429,0 5.714285714285715,-7.464228571428572 5.714285714285715,7.464228571428572 3.428571428571429,0 -7.42857142857143,-9.714285714285715 7.42857142857143,-9.714285714285715 -3.428571428571429,0 -5.714285714285715,7.464228571428572 -5.714285714285715,-7.464228571428572 -3.428571428571429,0 z"},d)))},n.extendKey="ExclusiveGatewayNode",n})(xt);var Pt=function(){var i=function(n,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])},i(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}}(),Ee=function(){return Ee=Object.assign||function(i){for(var n,e=1,t=arguments.length;e<t;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r])}return i},Ee.apply(this,arguments)};(function(i){Pt(n,i);function n(e,t){return e.id||(e.id="Activity_".concat(Y())),i.call(this,e,t)||this}return n.extendKey="ServiceTaskModel",n})(we);(function(i){Pt(n,i);function n(){return i!==null&&i.apply(this,arguments)||this}return n.prototype.getLabelShape=function(){var e=this.props.model,t=e.x,r=e.y,o=e.width,a=e.height,l=e.getNodeStyle();return _("svg",{x:t-o/2+5,y:r-a/2+5,width:30,height:30,viewBox:"0 0 1274 1024"},_("path",{fill:l.stroke,d:"M882.527918 434.149934c-2.234901-5.303796-7.311523-8.853645-13.059434-9.138124l-61.390185-3.009544c-6.635117-20.973684-15.521508-41.175795-26.513864-60.282968l42.051745-47.743374c4.308119-4.889357 4.955872-12.004405 1.602498-17.59268-46.384423-77.30362-103.969956-101.422947-106.400309-102.410438-5.332449-2.170432-11.432377-1.090844-15.693424 2.77009L654.674467 240.664222c-17.004279-8.654101-35.092239-15.756869-53.995775-21.210068l-3.26537-66.490344c-0.280386-5.747911-3.833305-10.824533-9.134031-13.059434-1.683339-0.709151-30.193673-12.391215-76.866668-12.051477-46.672996-0.339738-75.18333 11.342326-76.866668 12.051477-5.300726 2.234901-8.853645 7.311523-9.134031 13.059434l-3.26537 66.490344c-18.903535 5.453199-36.991496 12.555967-53.995775 21.210068l-48.450479-43.922349c-4.261047-3.860934-10.360975-4.940522-15.693424-2.77009-2.430352 0.98749-60.015885 25.106818-106.400309 102.410438-3.353374 5.588275-2.705622 12.703323 1.602498 17.59268l42.051745 47.743374c-10.992355 19.107173-19.878746 39.309284-26.513864 60.282968l-61.390185 3.009544c-5.747911 0.284479-10.824533 3.834328-13.059434 9.138124-1.01512 2.415003-24.687262 60.190871-2.822278 147.651828 1.583055 6.324032 7.072069 10.893094 13.57518 11.308557 5.892197 0.37146 11.751648 0.523933 17.419741 0.667196 14.498202 0.372483 28.193109 0.723477 40.908712 4.63353 4.212952 1.294482 6.435573 8.270361 9.349949 18.763342 1.287319 4.640694 2.617617 9.43693 4.484128 14.010085 1.794879 4.393054 3.75758 8.570189 5.66093 12.607132 1.302669 2.765997 2.529613 5.380544 3.689019 8.018627 2.986007 6.803963 2.682086 9.773598 2.578732 10.349719-3.061732 3.672646-6.391571 7.238868-9.91379 11.015891-1.810229 1.943258-3.680832 3.949962-5.523807 5.980201l-22.560832 24.8909c-3.865028 4.261047-4.940522 10.365068-2.774183 15.693424 0.991584 2.426259 25.102724 60.011792 102.414531 106.400309 5.588275 3.353374 12.703323 2.701528 17.591657-1.603521l23.476691-20.682042c2.346441-2.061962 4.64888-4.336772 6.875594-6.534833 9.05319-8.93858 14.018272-12.95608 17.73185-11.576663 3.305279 1.222851 6.907317 3.166109 10.720156 5.228071 3.325745 1.794879 6.764054 3.650133 10.465352 5.288446 6.016017 2.662643 12.120039 4.688789 18.019399 6.65149 6.827499 2.266623 13.279445 4.409426 18.819624 7.275707 1.518586 0.782829 1.926886 0.994654 2.358721 7.830339 0.726547 11.496845 1.25048 23.276123 1.753947 34.672684 0.264013 5.900384 0.528026 11.803837 0.815575 17.700127 0.284479 5.743818 3.833305 10.82044 9.138124 13.05534 1.654686 0.698918 29.371958 12.063757 74.869175 12.063757 0.328481 0 3.65832 0 3.986801 0 45.497217 0 73.214489-11.364839 74.869175-12.063757 5.304819-2.234901 8.853645-7.311523 9.138124-13.05534 0.287549-5.89629 0.551562-11.799744 0.815575-17.700127 0.503467-11.396561 1.027399-23.175839 1.753947-34.672684 0.431835-6.835685 0.840134-7.04751 2.358721-7.830339 5.54018-2.866281 11.992125-5.009084 18.819624-7.275707 5.89936-1.962701 12.003382-3.988848 18.019399-6.65149 3.701299-1.638313 7.139607-3.493567 10.465352-5.288446 3.812839-2.061962 7.414877-4.00522 10.720156-5.228071 3.713578-1.379417 8.67866 2.638083 17.73185 11.576663 2.226714 2.198062 4.529153 4.472871 6.875594 6.534833l23.476691 20.682042c4.888334 4.305049 12.003382 4.956895 17.591657 1.603521 77.311807-46.388517 101.422947-103.97405 102.414531-106.400309 2.166339-5.328355 1.090844-11.432377-2.774183-15.693424l-22.560832-24.8909c-1.842974-2.030239-3.713578-4.036943-5.523807-5.980201-3.52222-3.777023-6.852058-7.343245-9.91379-11.015891-0.103354-0.576121-0.407276-3.545756 2.578732-10.349719 1.159406-2.638083 2.38635-5.252631 3.689019-8.018627 1.90335-4.036943 3.866051-8.214079 5.66093-12.607132 1.866511-4.573155 3.196809-9.369392 4.484128-14.010085 2.914376-10.492982 5.136997-17.46886 9.349949-18.763342 12.715603-3.910053 26.41051-4.261047 40.908712-4.63353 5.668093-0.143263 11.527544-0.295735 17.419741-0.667196 6.503111-0.415462 11.992125-4.984524 13.57518-11.308557C907.21518 494.340805 883.543038 436.564937 882.527918 434.149934zM643.49894 643.761929c-35.280528 35.280528-82.191954 54.711066-132.086317 54.711066s-96.806813-19.430538-132.086317-54.711066c-35.280528-35.279504-54.711066-82.191954-54.711066-132.086317 0-49.894364 19.430538-96.80272 54.711066-132.082224 35.283598-35.284621 82.191954-54.711066 132.086317-54.711066s96.80579 19.426445 132.086317 54.711066c35.279504 35.279504 54.711066 82.187861 54.711066 132.082224C698.210006 561.569976 678.782537 608.482425 643.49894 643.761929z"}))},n.prototype.getShape=function(){var e=this.props.model,t=e.x,r=e.y,o=e.width,a=e.height,l=e.radius,s=e.getNodeStyle();return _("g",{},[_("rect",Ee({x:t-o/2,y:r-a/2,rx:l,ry:l,width:o,height:a},s)),this.getLabelShape()])},n.extendKey="ServiceTaskNode",n})(te);var Ct=function(){var i=function(n,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])},i(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}}(),le=function(){return le=Object.assign||function(i){for(var n,e=1,t=arguments.length;e<t;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r])}return i},le.apply(this,arguments)};(function(i){Ct(n,i);function n(e,t){return e.id||(e.id="Activity_".concat(Y())),i.call(this,e,t)||this}return n.extendKey="UserTaskModel",n})(we);(function(i){Ct(n,i);function n(){return i!==null&&i.apply(this,arguments)||this}return n.prototype.getLabelShape=function(){var e=this.props.model,t=e.x,r=e.y,o=e.width,a=e.height,l=e.getNodeStyle();return _("svg",{x:t-o/2+5,y:r-a/2+5,width:25,height:25,viewBox:"0 0 1274 1024"},_("path",{fill:l.stroke,d:"M655.807326 287.35973m-223.989415 0a218.879 218.879 0 1 0 447.978829 0 218.879 218.879 0 1 0-447.978829 0ZM1039.955839 895.482975c-0.490184-212.177424-172.287821-384.030443-384.148513-384.030443-211.862739 0-383.660376 171.85302-384.15056 384.030443L1039.955839 895.482975z"}))},n.prototype.getShape=function(){var e=this.props.model,t=e.x,r=e.y,o=e.width,a=e.height,l=e.radius,s=e.getNodeStyle();return _("g",{},[_("rect",le(le({},s),{x:t-o/2,y:r-a/2,rx:l,ry:l,width:o,height:a})),this.getLabelShape()])},n.extendKey="UserTaskNode",n})(te);var un=function(){function i(){globalThis._ids=this,this._ids=new Set}return i.prototype.generateId=function(){return"xxxxxxx".replace(/[x]/g,function(n){var e=Math.random()*16|0,t=n==="x"?e:e&3|8;return t.toString(16)})},i.prototype.next=function(){for(var n=this.generateId();this._ids.has(n);)n=this.generateId();return this._ids.add(n),n},i}(),cn=(globalThis==null?void 0:globalThis._ids)||new un;function $e(){return cn.next()}function Tt(i){return Object.prototype.toString.call(i)}function fn(i){return"  ".repeat(i)}function se(i){var n=i;return Tt(i)==="[object Object]"?(n={},Object.keys(i).forEach(function(e){var t=e;e.charAt(0)==="-"&&(t=e.substring(1)),n[t]=se(i[e])})):Array.isArray(i)&&(n=[],i.forEach(function(e,t){n[t]=se(e)})),n}function pn(i){var n=i;try{typeof n!="string"&&(n=JSON.parse(i))}catch{n=JSON.stringify(se(i)).replace(/"/g,"'")}return n}var X=`	
`;function re(i,n,e){var t=fn(e);if(i!==0&&i!==!1&&!i)return X+t+"<".concat(n," />");var r="";if(n==="#text")return X+t+i;if(n==="#cdata-section")return X+t+"<![CDATA["+i+"]]>";if(n==="#comment")return X+t+"<!--"+i+"-->";if("".concat(n).charAt(0)==="-")return" "+n.substring(1)+'="'+pn(i)+'"';if(Array.isArray(i))i.forEach(function(s){r+=re(s,n,e+1)});else if(Tt(i)==="[object Object]"){var o=Object.keys(i),a="",l="";r+=(e===0?"":X+t)+"<"+n,o.forEach(function(s){s.charAt(0)==="-"?a+=re(i[s],s,e+1):l+=re(i[s],s,e+1)}),r+=a+(l!==""?">".concat(l).concat(X+t,"</").concat(n,">"):" />")}else r+=X+t+"<".concat(n,">").concat(i.toString(),"</").concat(n,">");return r}function hn(i){var n="";for(var e in i)n+=re(i[e],e,0);return n}var C=function(){};C.ObjTree=function(){return this};C.ObjTree.VERSION="0.23";C.ObjTree.prototype.xmlDecl=`<?xml version="1.0" encoding="UTF-8" ?>
`;C.ObjTree.prototype.attr_prefix="-";C.ObjTree.prototype.parseXML=function(i){var n;if(window.DOMParser){var e=new DOMParser,t=e.parseFromString(i,"application/xml");if(!t)return;n=t.documentElement}else window.ActiveXObject&&(e=new ActiveXObject("Microsoft.XMLDOM"),e.async=!1,e.loadXML(i),n=e.documentElement);if(n)return this.parseDOM(n)};C.ObjTree.prototype.parseHTTP=function(i,n,e){var t={};for(var r in n)t[r]=n[r];if(t.method||(typeof t.postBody>"u"&&typeof t.postbody>"u"&&typeof t.parameters>"u"?t.method="get":t.method="post"),e){t.asynchronous=!0;var o=this,a=e,l=t.onComplete;t.onComplete=function(u){var c;u&&u.responseXML&&u.responseXML.documentElement&&(c=o.parseDOM(u.responseXML.documentElement)),a(c,u),l&&l(u)}}else t.asynchronous=!1;var s;if(typeof HTTP<"u"&&HTTP.Request){t.uri=i;var d=new HTTP.Request(t);d&&(s=d.transport)}else if(typeof Ajax<"u"&&Ajax.Request){var d=new Ajax.Request(i,t);d&&(s=d.transport)}if(e)return s;if(s&&s.responseXML&&s.responseXML.documentElement)return this.parseDOM(s.responseXML.documentElement)};C.ObjTree.prototype.parseDOM=function(i){if(i){if(this.__force_array={},this.force_array)for(var n=0;n<this.force_array.length;n++)this.__force_array[this.force_array[n]]=1;var e=this.parseElement(i);if(this.__force_array[i.nodeName]&&(e=[e]),i.nodeType!=11){var t={};t[i.nodeName]=e,e=t}return e}};C.ObjTree.prototype.parseElement=function(i){if(i.nodeType!=7){if(i.nodeType==3||i.nodeType==4||i.nodeType==8){var n=i.nodeValue.match(/[^\x00-\x20]/);return n==null?void 0:i.nodeValue}var e=null,t={};if(i.attributes&&i.attributes.length){e={};for(var r=0;r<i.attributes.length;r++){var o=i.attributes[r].nodeName;if(typeof o=="string"){var a=i.attributes[r].nodeValue;try{a=JSON.parse(i.attributes[r].nodeValue.replace(/'/g,'"'))}catch{a=i.attributes[r].nodeValue}a&&(o=this.attr_prefix+o,typeof t[o]>"u"&&(t[o]=0),t[o]++,this.addNode(e,o,t[o],a))}}}if(i.childNodes&&i.childNodes.length){var l=!0;e&&(l=!1);for(var r=0;r<i.childNodes.length&&l;r++){var s=i.childNodes[r].nodeType;s==3||s==4||s==8||(l=!1)}if(l){e||(e="");for(var r=0;r<i.childNodes.length;r++)e+=i.childNodes[r].nodeValue}else{e||(e={});for(var r=0;r<i.childNodes.length;r++){var o=i.childNodes[r].nodeName;if(typeof o=="string"){var a=this.parseElement(i.childNodes[r]);a&&(typeof t[o]>"u"&&(t[o]=0),t[o]++,this.addNode(e,o,t[o],a))}}}}else e===null&&(e={});return e}};C.ObjTree.prototype.addNode=function(i,n,e,t){this.__force_array[n]?(e==1&&(i[n]=[]),i[n][i[n].length]=t):e==1?i[n]=t:e==2?i[n]=[i[n],t]:i[n][i[n].length]=t};C.ObjTree.prototype.writeXML=function(i){var n=this.hash_to_xml(null,i);return this.xmlDecl+n};C.ObjTree.prototype.hash_to_xml=function(i,n){var e=[],t=[];for(var r in n)if(n.hasOwnProperty(r)){var o=n[r];r.charAt(0)!=this.attr_prefix?typeof o>"u"||o==null?e[e.length]="<"+r+" />":typeof o=="object"&&o.constructor==Array?e[e.length]=this.array_to_xml(r,o):typeof o=="object"?e[e.length]=this.hash_to_xml(r,o):e[e.length]=this.scalar_to_xml(r,o):t[t.length]=" "+r.substring(1)+'="'+this.xml_escape(o)+'"'}var a=t.join(""),l=e.join("");return typeof i>"u"||i==null||(e.length>0?l.match(/\n/)?l="<"+i+a+`>
`+l+"</"+i+`>
`:l="<"+i+a+">"+l+"</"+i+`>
`:l="<"+i+a+` />
`),l};C.ObjTree.prototype.array_to_xml=function(i,n){for(var e=[],t=0;t<n.length;t++){var r=n[t];typeof r>"u"||r==null?e[e.length]="<"+i+" />":typeof r=="object"&&r.constructor==Array?e[e.length]=this.array_to_xml(i,r):typeof r=="object"?e[e.length]=this.hash_to_xml(i,r):e[e.length]=this.scalar_to_xml(i,r)}return e.join("")};C.ObjTree.prototype.scalar_to_xml=function(i,n){return i=="#text"?this.xml_escape(n):"<"+i+">"+this.xml_escape(n)+"</"+i+`>
`};C.ObjTree.prototype.xml_escape=function(i){return i.replace(/&/g,"&").replace(/</g,"<").replace(/>/g,">").replace(/"/g,'"')};var vn=function(i){return new C.ObjTree().parseXML(i)},yn=function(){var i=function(n,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])},i(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}}(),Ne=function(){return Ne=Object.assign||function(i){for(var n,e=1,t=arguments.length;e<t;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r])}return i},Ne.apply(this,arguments)},be=function(i,n){var e=typeof Symbol=="function"&&i[Symbol.iterator];if(!e)return i;var t=e.call(i),r,o=[],a;try{for(;(n===void 0||n-- >0)&&!(r=t.next()).done;)o.push(r.value)}catch(l){a={error:l}}finally{try{r&&!r.done&&(e=t.return)&&e.call(t)}finally{if(a)throw a.error}}return o},z;(function(i){i.START="bpmn:startEvent",i.END="bpmn:endEvent",i.GATEWAY="bpmn:exclusiveGateway",i.USER="bpmn:userTask",i.SYSTEM="bpmn:serviceTask",i.FLOW="bpmn:sequenceFlow"})(z||(z={}));var jt=["-name","-id","bpmn:incoming","bpmn:outgoing","-sourceRef","-targetRef"],ke=["properties","startPoint","endPoint","pointsList"];function Ge(i){var n=i?ke.concat(i):ke;return function(e){function t(r){var o={};return typeof r=="string"?r:Array.isArray(r)?r.map(function(a){return t(a)}):(Object.entries(r).forEach(function(a){var l=be(a,2),s=l[0],d=l[1];typeof d!="object"?s.indexOf("-")===0||["#text","#cdata-section","#comment"].includes(s)?o[s]=d:o["-".concat(s)]=d:n.includes(s)?o["-".concat(s)]=t(d):o[s]=t(d)}),o)}return t(e)}}function de(i){var n={};return Object.entries(i).forEach(function(e){var t=be(e,2),r=t[0],o=t[1];r.indexOf("-")===0?n[r.substring(1)]=se(o):typeof o=="string"?n[r]=o:Object.prototype.toString.call(o)==="[object Object]"?n[r]=de(o):Array.isArray(o)?n[r]=o.map(function(a){return de(a)}):n[r]=o}),n}function gn(i,n,e){var t=new Map;n.nodes.forEach(function(o){var a,l={"-id":o.id};if(!((a=o.text)===null||a===void 0)&&a.value&&(l["-name"]=o.text.value),o.properties){var s=Ge(e)(o.properties);Object.assign(l,s)}t.set(o.id,l),i[o.type]?Array.isArray(i[o.type])?i[o.type].push(l):i[o.type]=[i[o.type],l]:i[o.type]=l});var r=n.edges.map(function(o){var a,l,s=t.get(o.targetNodeId);s["bpmn:incoming"]?Array.isArray(s["bpmn:incoming"])?s["bpmn:incoming"].push(o.id):s["bpmn:incoming"]=[s["bpmn:incoming"],o.id]:s["bpmn:incoming"]=o.id;var d={"-id":o.id,"-sourceRef":o.sourceNodeId,"-targetRef":o.targetNodeId};if(!((a=o.text)===null||a===void 0)&&a.value&&(d["-name"]=(l=o.text)===null||l===void 0?void 0:l.value),o.properties){var u=Ge(e)(o.properties);Object.assign(d,u)}return d});n.edges.forEach(function(o){var a=t.get(o.sourceNodeId);a["bpmn:outgoing"]?Array.isArray(a["bpmn:outgoing"])?a["bpmn:outgoing"].push(o.id):a["bpmn:outgoing"]=[a["bpmn:outgoing"],o.id]:a["bpmn:outgoing"]=o.id}),i[z.FLOW]=r}function mn(i,n){i["bpmndi:BPMNEdge"]=n.edges.map(function(e){var t,r=e.id,o=e.pointsList.map(function(l){var s=l.x,d=l.y;return{"-x":s,"-y":d}}),a={"-id":"".concat(r,"_di"),"-bpmnElement":r,"di:waypoint":o};return!((t=e.text)===null||t===void 0)&&t.value&&(a["bpmndi:BPMNLabel"]={"dc:Bounds":{"-x":e.text.x-e.text.value.length*10/2,"-y":e.text.y-7,"-width":e.text.value.length*10,"-height":14}}),a}),i["bpmndi:BPMNShape"]=n.nodes.map(function(e){var t,r=e.id,o=100,a=80,l=e.x,s=e.y,d=H.shapeConfigMap.get(e.type);d&&(o=d.width,a=d.height),l-=o/2,s-=a/2;var u={"-id":"".concat(r,"_di"),"-bpmnElement":r,"dc:Bounds":{"-x":l,"-y":s,"-width":o,"-height":a}};return!((t=e.text)===null||t===void 0)&&t.value&&(u["bpmndi:BPMNLabel"]={"dc:Bounds":{"-x":e.text.x-e.text.value.length*10/2,"-y":e.text.y-7,"-width":e.text.value.length*10,"-height":14}}),u})}function _n(i){var n=[],e=[],t=i["bpmn:definitions"];if(t){var r=t["bpmn:process"];Object.keys(r).forEach(function(o){if(o.indexOf("bpmn:")===0){var a=r[o];if(o===z.FLOW){var l=t["bpmndi:BPMNDiagram"]["bpmndi:BPMNPlane"]["bpmndi:BPMNEdge"];e=wn(a,l)}else{var s=t["bpmndi:BPMNDiagram"]["bpmndi:BPMNPlane"]["bpmndi:BPMNShape"];n=n.concat(xn(a,s,o))}}})}return{nodes:n,edges:e}}function xn(i,n,e){var t=[];if(Array.isArray(i))i.forEach(function(a){var l;Array.isArray(n)?l=n.find(function(d){return d["-bpmnElement"]===a["-id"]}):l=n;var s=Ye(l,e,a);t.push(s)});else{var r=void 0;Array.isArray(n)?r=n.find(function(a){return a["-bpmnElement"]===i["-id"]}):r=n;var o=Ye(r,e,i);t.push(o)}return t}function Ye(i,n,e){var t=Number(i["dc:Bounds"]["-x"]),r=Number(i["dc:Bounds"]["-y"]),o=e["-name"],a=H.shapeConfigMap.get(n);a&&(t+=a.width/2,r+=a.height/2);var l;Object.entries(e).forEach(function(c){var f=be(c,2),h=f[0],v=f[1];jt.indexOf(h)===-1&&(l||(l={}),l[h]=v)}),l&&(l=de(l));var s;if(o&&(s={x:t,y:r,value:o},i["bpmndi:BPMNLabel"]&&i["bpmndi:BPMNLabel"]["dc:Bounds"])){var d=i["bpmndi:BPMNLabel"]["dc:Bounds"];s.x=Number(d["-x"])+Number(d["-width"])/2,s.y=Number(d["-y"])+Number(d["-height"])/2}var u={id:i["-bpmnElement"],type:n,x:t,y:r,properties:l};return s&&(u.text=s),u}function wn(i,n){var e=[];if(Array.isArray(i))i.forEach(function(r){var o;Array.isArray(n)?o=n.find(function(a){return a["-bpmnElement"]===r["-id"]}):o=n,e.push(Ue(o,r))});else{var t=void 0;Array.isArray(n)?t=n.find(function(r){return r["-bpmnElement"]===i["-id"]}):t=n,e.push(Ue(t,i))}return e}function Ue(i,n){var e,t=n["-name"]?"".concat(n["-name"]):"";if(t){var r=i["bpmndi:BPMNLabel"]["dc:Bounds"],o=0;t.split(`
`).forEach(function(s){o<s.length&&(o=s.length)}),e={value:t,x:Number(r["-x"])+o*10/2,y:Number(r["-y"])+7}}var a;Object.entries(n).forEach(function(s){var d=be(s,2),u=d[0],c=d[1];jt.indexOf(u)===-1&&(a||(a={}),a[u]=c)}),a&&(a=de(a));var l={id:n["-id"],type:z.FLOW,pointsList:i["di:waypoint"].map(function(s){return{x:Number(s["-x"]),y:Number(s["-y"])}}),sourceNodeId:n["-sourceRef"],targetNodeId:n["-targetRef"],properties:a};return e&&(l.text=e),l}var H=function(){function i(n){var e=n.lf,t=this;this.adapterOut=function(r,o){var a=Ne({},t.processAttributes);gn(a,r,o);var l={"-id":"BPMNPlane_1","-bpmnElement":a["-id"]};mn(l,r);var s=t.definitionAttributes;s["bpmn:process"]=a,s["bpmndi:BPMNDiagram"]={"-id":"BPMNDiagram_1","bpmndi:BPMNPlane":l};var d={"bpmn:definitions":s};return d},this.adapterIn=function(r){if(r)return _n(r)},e.adapterIn=function(r){return t.adapterIn(r)},e.adapterOut=function(r,o){return t.adapterOut(r,o)},this.processAttributes={"-isExecutable":"true","-id":"Process_".concat($e())},this.definitionAttributes={"-id":"Definitions_".concat($e()),"-xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","-xmlns:bpmn":"http://www.omg.org/spec/BPMN/20100524/MODEL","-xmlns:bpmndi":"http://www.omg.org/spec/BPMN/20100524/DI","-xmlns:dc":"http://www.omg.org/spec/DD/20100524/DC","-xmlns:di":"http://www.omg.org/spec/DD/20100524/DI","-targetNamespace":"http://logic-flow.org","-exporter":"logicflow","-exporterVersion":"1.2.0"}}return i.prototype.setCustomShape=function(n,e){i.shapeConfigMap.set(n,e)},i.pluginName="bpmn-adapter",i.shapeConfigMap=new Map,i}();H.shapeConfigMap.set(z.START,{width:We.width,height:We.height});H.shapeConfigMap.set(z.END,{width:He.width,height:He.height});H.shapeConfigMap.set(z.GATEWAY,{width:Xe.width,height:Xe.height});H.shapeConfigMap.set(z.SYSTEM,{width:Fe.width,height:Fe.height});H.shapeConfigMap.set(z.USER,{width:Be.width,height:Be.height});(function(i){yn(n,i);function n(e){var t=i.call(this,e)||this;t.adapterXmlIn=function(o){var a=vn(o);return t.adapterIn(a)},t.adapterXmlOut=function(o,a){var l=t.adapterOut(o,a);return hn(l)};var r=e.lf;return r.adapterIn=t.adapterXmlIn,r.adapterOut=t.adapterXmlOut,t}return n.pluginName="bpmnXmlAdapter",n})(H);var bn=function(){function i(){globalThis._ids=this,this._ids=new Set}return i.prototype.generateId=function(){var n="xxxxxxx".replace(/[x]/g,function(e){var t=Math.random()*16|0,r=e==="x"?t:t&3|8;return r.toString(16)});return n},i.prototype.next=function(){for(var n=this.generateId();this._ids.has(n);)n=this.generateId();return this._ids.add(n),n},i}(),Mn=(globalThis==null?void 0:globalThis._ids)||new bn;function On(){return Mn.next()}_("circle",{cx:18,cy:18,r:11,style:"stroke-linecap: round;stroke-linejoin: round;stroke: rgb(34, 36, 42);stroke-width: 2px;fill: white"}),_("path",{d:"M 18,18 l 2.25,-7.5 m -2.25,7.5 l 5.25,1.5",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 2px;"}),_("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(0,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),_("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(30,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),_("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(60,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),_("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(90,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),_("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(120,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),_("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(150,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),_("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(180,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),_("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(210,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),_("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(240,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),_("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(270,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),_("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(300,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),_("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(330,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"});_("circle",{cx:18,cy:18,r:10,style:"stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 4px; fill: rgb(34, 36, 42);"});_("circle",{cx:25,cy:25,r:13,style:"stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 2.5px; fill: white;"});var Sn=function(){var i=function(n,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])},i(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}}(),$=function(){return $=Object.assign||function(i){for(var n,e=1,t=arguments.length;e<t;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r])}return i},$.apply(this,arguments)},En=function(i,n){var e=typeof Symbol=="function"&&i[Symbol.iterator];if(!e)return i;var t=e.call(i),r,o=[],a;try{for(;(n===void 0||n-- >0)&&!(r=t.next()).done;)o.push(r.value)}catch(l){a={error:l}}finally{try{r&&!r.done&&(e=t.return)&&e.call(t)}finally{if(a)throw a.error}}return o},Nn=wt,An=function(i){Sn(n,i);function n(e){var t=i.call(this)||this;return t.updatePosition=function(r){var o=r.deltaX,a=r.deltaY,l=t.nodeModel,s=l.x,d=l.y;t.nodeModel.x=s+o/2,t.nodeModel.y=d+a/2,t.nodeModel.moveText(o/2,a/2)},t.getResize=function(r){var o=r.index,a=r.deltaX,l=r.deltaY,s=r.width,d=r.height,u=r.PCTResizeInfo,c=r.pct,f=c===void 0?1:c,h=r.freezeWidth,v=h===void 0?!1:h,p=r.freezeHeight,y=p===void 0?!1:p,g={width:s,height:d,deltaX:a,deltaY:l};if(u){var m=4,b=0,w=0;switch(o){case 0:w=(a*-1-l)/m;break;case 1:w=(a-l)/m;break;case 2:w=(a+l)/m;break;case 3:w=(a*-1+l)/m;break}w!==0&&(b=Math.round(w/u.ResizeBasis.basisHeight*1e5)/1e3),u.ResizePCT.widthPCT=Math.max(Math.min(u.ResizePCT.widthPCT+b,u.ScaleLimit.maxScaleLimit),u.ScaleLimit.minScaleLimit),u.ResizePCT.heightPCT=Math.max(Math.min(u.ResizePCT.heightPCT+b,u.ScaleLimit.maxScaleLimit),u.ScaleLimit.minScaleLimit);var O=Math.round(u.ResizePCT.widthPCT*u.ResizeBasis.basisWidth/100),M=Math.round(u.ResizePCT.heightPCT*u.ResizeBasis.basisHeight/100);switch(o){case 0:a=s-O,l=d-M;break;case 1:a=O-s,l=d-M;break;case 2:a=O-s,l=M-d;break;case 3:a=s-O,l=M-d;break}return g.width=O,g.height=M,g.deltaX=a/f,g.deltaY=l/f,g}switch(o){case 0:g.width=v?s:s-a*f,g.height=y?d:d-l*f;break;case 1:g.width=v?s:s+a*f,g.height=y?d:d-l*f;break;case 2:g.width=v?s:s+a*f,g.height=y?d:d+l*f;break;case 3:g.width=v?s:s-a*f,g.height=y?d:d+l*f;break}return g},t.updateEdgePointByAnchors=function(){var r=t.nodeModel,o=r.id,a=r.anchors,l=t.getNodeEdges(o);l.sourceEdges.forEach(function(s){var d=a.find(function(u){return u.id===s.sourceAnchorId});d&&s.updateStartPoint({x:d.x,y:d.y})}),l.targetEdges.forEach(function(s){var d=a.find(function(u){return u.id===s.targetAnchorId});d&&s.updateEndPoint({x:d.x,y:d.y})})},t.updateRect=function(r){var o=r.deltaX,a=r.deltaY,l=t.nodeModel,s=l.x,d=l.y,u=l.width,c=l.height,f=l.radius,h=l.PCTResizeInfo,v=t.nodeModel,p=v.minWidth,y=v.minHeight,g=v.maxWidth,m=v.maxHeight,b=t.index,w=p===g,O=y===m,M=t.getResize({index:b,deltaX:o,deltaY:a,width:u,height:c,PCTResizeInfo:h,pct:1,freezeWidth:w,freezeHeight:O});if(M.width<p||M.width>g||M.height<y||M.height>m){t.dragHandler.cancelDrag();return}t.updatePosition({deltaX:w?0:M.deltaX,deltaY:O?0:M.deltaY}),t.nodeModel.width=M.width,t.nodeModel.height=M.height,t.nodeModel.setProperties({nodeSize:{width:M.width,height:M.height}});var x={x:s,y:d,width:u,height:c,radius:f},j={x:t.nodeModel.x,y:t.nodeModel.y,width:t.nodeModel.width,height:t.nodeModel.height,radius:f};t.updateEdgePointByAnchors(),t.eventEmit({deltaX:o,deltaY:a,beforeNode:x,afterNode:j})},t.updateEllipse=function(r){var o=r.deltaX,a=r.deltaY,l=t.nodeModel,s=l.rx,d=l.ry,u=l.x,c=l.y,f=l.PCTResizeInfo,h=t.index,v=t.nodeModel,p=v.minWidth,y=v.minHeight,g=v.maxWidth,m=v.maxHeight,b=p===g,w=y===m,O=s,M=d,x=t.getResize({index:h,deltaX:o,deltaY:a,width:O,height:M,PCTResizeInfo:f,pct:1/2,freezeWidth:b,freezeHeight:w});if(x.width<p/2||x.width>g/2||x.height<y/2||x.height>m/2){t.dragHandler.cancelDrag();return}t.updatePosition({deltaX:b?0:x.deltaX,deltaY:w?0:x.deltaY}),t.nodeModel.rx=x.width,t.nodeModel.ry=x.height,t.nodeModel.setProperties({nodeSize:{rx:x.width,ry:x.height}});var j={x:u,y:c},E={rx:x.width,ry:x.height,x:t.nodeModel.x,y:t.nodeModel.y};t.updateEdgePointByAnchors(),t.eventEmit({deltaX:o,deltaY:a,beforeNode:$($({},j),{rx:s,ry:d}),afterNode:E})},t.updateDiamond=function(r){var o=r.deltaX,a=r.deltaY,l=t.nodeModel,s=l.rx,d=l.ry,u=l.x,c=l.y,f=l.PCTResizeInfo,h=t.index,v=t.nodeModel,p=v.minWidth,y=v.minHeight,g=v.maxWidth,m=v.maxHeight,b=p===g,w=y===m,O=s,M=d,x=t.getResize({index:h,deltaX:o,deltaY:a,width:O,height:M,PCTResizeInfo:f,pct:1/2,freezeWidth:b,freezeHeight:w});if(x.width<p/2||x.width>g/2||x.height<y/2||x.height>m/2){t.dragHandler.cancelDrag();return}t.updatePosition({deltaX:b?0:x.deltaX,deltaY:w?0:x.deltaY}),t.nodeModel.rx=x.width,t.nodeModel.ry=x.height,t.nodeModel.setProperties({nodeSize:{rx:x.width,ry:x.height}});var j={x:u,y:c,rx:s,ry:d},E={rx:x.width,ry:x.height,x:t.nodeModel.x,y:t.nodeModel.y};t.updateEdgePointByAnchors(),t.eventEmit({deltaX:o,deltaY:a,beforeNode:j,afterNode:E})},t.eventEmit=function(r){var o=r.deltaX,a=r.deltaY,l=r.beforeNode,s=r.afterNode,d=t.nodeModel,u=d.id,c=d.modelType,f=d.type,h=$({id:u,modelType:c,type:f},l),v=$({id:u,modelType:c,type:f},s);t.graphModel.eventCenter.emit("node:resize",{preData:h,data:v,deltaX:o,deltaY:a,index:t.index,model:t.nodeModel})},t.onDragging=function(r){var o,a=r.deltaX,l=r.deltaY,s=t.graphModel.transformModel,d=t.nodeModel.modelType;o=En(s.fixDeltaXY(a,l),2),a=o[0],l=o[1],d===ne.RECT_NODE||d===ne.HTML_NODE?t.updateRect({deltaX:a,deltaY:l}):d===ne.ELLIPSE_NODE?t.updateEllipse({deltaX:a,deltaY:l}):d===ne.DIAMOND_NODE&&t.updateDiamond({deltaX:a,deltaY:l})},t.onDragEnd=function(){var r=t.graphModel.gridSize,o=r===void 0?1:r,a=o*Math.round(t.nodeModel.x/o),l=o*Math.round(t.nodeModel.y/o);t.nodeModel.moveTo(a,l),t.updateEdgePointByAnchors()},t.index=e.index,t.nodeModel=e.model,t.graphModel=e.graphModel,t.dragHandler=new Nn({onDragging:t.onDragging,onDragEnd:t.onDragEnd,step:1}),t}return n.prototype.getNodeEdges=function(e){for(var t=this.graphModel,r=t.edges,o=[],a=[],l=0;l<r.length;l++){var s=r[l];s.sourceNodeId===e?o.push(s):r[l].targetNodeId===e&&a.push(s)}return{sourceEdges:o,targetEdges:a}},n.prototype.render=function(){var e=this.props,t=e.x,r=e.y,o=e.index,a=e.model,l=a.getControlPointStyle();return S("g",{className:"lf-resize-control-".concat(o),children:S(bt,$({className:"lf-node-control",x:t,y:r},l,{onMouseDown:this.dragHandler.handleMouseDown}))})},n}(xe),Pn=function(){var i=function(n,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])},i(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}}(),ue=function(){return ue=Object.assign||function(i){for(var n,e=1,t=arguments.length;e<t;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r])}return i},ue.apply(this,arguments)},Me=function(i){Pn(n,i);function n(){var e=i.call(this)||this;return e.state={},e}return n.prototype.getResizeControl=function(){var e=this.props,t=e.model,r=e.graphModel,o=t.x,a=t.y,l=t.width,s=t.height,d={minX:o-l/2,minY:a-s/2,maxX:o+l/2,maxY:a+s/2},u=d.minX,c=d.minY,f=d.maxX,h=d.maxY,v=[{x:u,y:c},{x:f,y:c},{x:f,y:h},{x:u,y:h}];return v.map(function(p,y){return S(An,ue({index:y},p,{model:t,graphModel:r}))})},n.prototype.getGroupSolid=function(){var e=this.props.model,t=e.x,r=e.y,o=e.width,a=e.height,l=e.getResizeOutlineStyle();return S(bt,ue({},l,{x:t,y:r,width:o,height:a}))},n.prototype.render=function(){return S("g",{className:"lf-resize-control",children:[this.getGroupSolid(),this.getResizeControl()]})},n}(xe),Dt=function(){var i=function(n,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])},i(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}}();(function(i){Dt(n,i);function n(e,t){var r=i.call(this,e,t)||this,o=e.properties.nodeSize;return o&&(r.rx=o.rx,r.ry=o.ry),r}return n.prototype.initNodeData=function(e){i.prototype.initNodeData.call(this,e),this.minWidth=30,this.minHeight=30,this.maxWidth=2e3,this.maxHeight=2e3},n.prototype.getOutlineStyle=function(){var e=i.prototype.getOutlineStyle.call(this),t=this.graphModel.editConfigModel.isSilentMode;return t||(e.stroke="none",e.hover&&(e.hover.stroke="none")),e},n.prototype.getResizeOutlineStyle=function(){return{fill:"none",stroke:"transparent",strokeWidth:1,strokeDasharray:"3,3"}},n.prototype.getControlPointStyle=function(){return{width:7,height:7,fill:"#FFFFFF",stroke:"#000000"}},n.prototype.enableProportionResize=function(e){if(e===void 0&&(e=!0),e){var t={widthPCT:100,heightPCT:100},r={basisWidth:this.rx,basisHeight:this.ry},o={maxScaleLimit:Math.min(this.maxWidth/(this.rx*2)*100,this.maxHeight/(this.ry*2)*100),minScaleLimit:Math.max(this.minWidth/(this.rx*2)*100,this.minHeight/(this.ry*2)*100)};this.PCTResizeInfo={ResizePCT:t,ResizeBasis:r,ScaleLimit:o}}else delete this.PCTResizeInfo},n})(Gt);(function(i){Dt(n,i);function n(){return i!==null&&i.apply(this,arguments)||this}return n.prototype.getControlGroup=function(){var e=this.props,t=e.model,r=e.graphModel;return S(Me,{model:t,graphModel:r})},n.prototype.getResizeShape=function(){return i.prototype.getShape.call(this)},n.prototype.getShape=function(){var e=this.props,t=e.model,r=e.graphModel.editConfigModel.isSilentMode;return S("g",{children:[this.getResizeShape(),t.isSelected&&!r?this.getControlGroup():""]})},n})(Yt);var Rt=function(){var i=function(n,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])},i(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}}(),Ae=function(){return Ae=Object.assign||function(i){for(var n,e=1,t=arguments.length;e<t;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r])}return i},Ae.apply(this,arguments)};(function(i){Rt(n,i);function n(e,t){var r=i.call(this,e,t)||this,o=e.properties.nodeSize;return o&&(r.rx=o.rx,r.ry=o.ry),r}return n.prototype.initNodeData=function(e){i.prototype.initNodeData.call(this,e),this.minWidth=30,this.minHeight=30,this.maxWidth=2e3,this.maxHeight=2e3,this.gridSize=1},n.prototype.getOutlineStyle=function(){var e=i.prototype.getOutlineStyle.call(this),t=this.graphModel.editConfigModel.isSilentMode;return t||(e.stroke="none",e.hover&&(e.hover.stroke="none")),e},n.prototype.getResizeOutlineStyle=function(){return{fill:"none",stroke:"transparent",strokeWidth:1,strokeDasharray:"3,3"}},n.prototype.getControlPointStyle=function(){return{width:7,height:7,fill:"#FFFFFF",stroke:"#000000"}},n.prototype.enableProportionResize=function(e){if(e===void 0&&(e=!0),e){var t={widthPCT:100,heightPCT:100},r={basisWidth:this.rx,basisHeight:this.ry},o={maxScaleLimit:Math.min(this.maxWidth/(this.rx*2)*100,this.maxHeight/(this.ry*2)*100),minScaleLimit:Math.max(this.minWidth/(this.rx*2)*100,this.minHeight/(this.ry*2)*100)};this.PCTResizeInfo={ResizePCT:t,ResizeBasis:r,ScaleLimit:o}}else delete this.PCTResizeInfo},n})(Ut);(function(i){Rt(n,i);function n(){return i!==null&&i.apply(this,arguments)||this}return n.prototype.getControlGroup=function(){var e=this.props,t=e.model,r=e.graphModel;return S(Me,{model:t,graphModel:r})},n.prototype.getResizeShape=function(){var e=this.props.model,t=e.points,r=e.getNodeStyle();return S("g",{children:S(qt,Ae({},r,{points:t}))})},n.prototype.getShape=function(){var e=this.props,t=e.model.isSelected,r=e.graphModel.editConfigModel.isSilentMode;return S("g",{children:[this.getResizeShape(),t&&!r?this.getControlGroup():""]})},n})(Vt);var It=function(){var i=function(n,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])},i(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}}();(function(i){It(n,i);function n(e,t){var r=i.call(this,e,t)||this,o=e.properties.nodeSize;return o&&(r.width=o.width,r.height=o.height),r}return n.prototype.initNodeData=function(e){i.prototype.initNodeData.call(this,e),this.minWidth=30,this.minHeight=30,this.maxWidth=2e3,this.maxHeight=2e3},n.prototype.getOutlineStyle=function(){var e=i.prototype.getOutlineStyle.call(this),t=this.graphModel.editConfigModel.isSilentMode;return t||(e.stroke="none",e.hover&&(e.hover.stroke="none")),e},n.prototype.getResizeOutlineStyle=function(){return{fill:"none",stroke:"transparent",strokeWidth:1,strokeDasharray:"3,3"}},n.prototype.getControlPointStyle=function(){return{width:7,height:7,fill:"#FFFFFF",stroke:"#000000"}},n.prototype.enableProportionResize=function(e){if(e===void 0&&(e=!0),e){var t={widthPCT:100,heightPCT:100},r={basisWidth:this.width,basisHeight:this.height},o={maxScaleLimit:Math.min(this.maxWidth/this.width*100,this.maxHeight/this.height*100),minScaleLimit:Math.max(this.minWidth/this.width*100,this.minHeight/this.height*100)};this.PCTResizeInfo={ResizePCT:t,ResizeBasis:r,ScaleLimit:o}}else delete this.PCTResizeInfo},n})(Kt);(function(i){It(n,i);function n(){return i!==null&&i.apply(this,arguments)||this}return n.prototype.getControlGroup=function(){var e=this.props,t=e.model,r=e.graphModel;return S(Me,{model:t,graphModel:r})},n.prototype.getResizeShape=function(){return i.prototype.getShape.call(this)},n.prototype.getShape=function(){var e=this.props,t=e.model.isSelected,r=e.graphModel.editConfigModel.isSilentMode;return S("g",{children:[this.getResizeShape(),t&&!r?this.getControlGroup():""]})},n})(Jt);var Lt=function(){var i=function(n,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])},i(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}}(),Cn=function(i){Lt(n,i);function n(e,t){var r=i.call(this,e,t)||this,o=e.properties.nodeSize;return o&&(r.width=o.width,r.height=o.height),r}return n.prototype.initNodeData=function(e){i.prototype.initNodeData.call(this,e),this.minWidth=30,this.minHeight=30,this.maxWidth=2e3,this.maxHeight=2e3},n.prototype.getOutlineStyle=function(){var e=i.prototype.getOutlineStyle.call(this),t=this.graphModel.editConfigModel.isSilentMode;return t||(e.stroke="none",e.hover&&(e.hover.stroke="none")),e},n.prototype.getResizeOutlineStyle=function(){return{fill:"none",stroke:"transparent",strokeWidth:1,strokeDasharray:"3,3"}},n.prototype.getControlPointStyle=function(){return{width:7,height:7,fill:"#FFFFFF",stroke:"#000000"}},n.prototype.enableProportionResize=function(e){if(e===void 0&&(e=!0),e){var t={widthPCT:100,heightPCT:100},r={basisWidth:this.width,basisHeight:this.height},o={maxScaleLimit:Math.min(this.maxWidth/this.width*100,this.maxHeight/this.height*100),minScaleLimit:Math.max(this.minWidth/this.width*100,this.minHeight/this.height*100)};this.PCTResizeInfo={ResizePCT:t,ResizeBasis:r,ScaleLimit:o}}else delete this.PCTResizeInfo},n}(we),Tn=function(i){Lt(n,i);function n(){return i!==null&&i.apply(this,arguments)||this}return n.prototype.getControlGroup=function(){var e=this.props,t=e.model,r=e.graphModel;return S(Me,{model:t,graphModel:r})},n.prototype.getResizeShape=function(){return i.prototype.getShape.call(this)},n.prototype.getShape=function(){var e=this.props,t=e.model.isSelected,r=e.graphModel.editConfigModel.isSilentMode;return S("g",{children:[this.getResizeShape(),t&&!r?this.getControlGroup():""]})},n}(te),zt=function(){var i=function(n,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])},i(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}}(),ce=function(){return ce=Object.assign||function(i){for(var n,e=1,t=arguments.length;e<t;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r])}return i},ce.apply(this,arguments)},F=function(i,n){var e=typeof Symbol=="function"&&i[Symbol.iterator];if(!e)return i;var t=e.call(i),r,o=[],a;try{for(;(n===void 0||n-- >0)&&!(r=t.next()).done;)o.push(r.value)}catch(l){a={error:l}}finally{try{r&&!r.done&&(e=t.return)&&e.call(t)}finally{if(a)throw a.error}}return o},B=function(i,n,e){if(e||arguments.length===2)for(var t=0,r=n.length,o;t<r;t++)(o||!(t in n))&&(o||(o=Array.prototype.slice.call(n,0,t)),o[t]=n[t]);return i.concat(o||Array.prototype.slice.call(n))},qe=500,Ve=300,jn=-1e4;(function(i){zt(n,i);function n(){var e=i.apply(this,B([],F(arguments),!1))||this;return e.isGroup=!0,e.isFolded=!1,e.unfoldedWidth=qe,e.unfoldedHeight=Ve,e.childrenLastFoldStatus={},e}return n.prototype.initNodeData=function(e){var t=this;i.prototype.initNodeData.call(this,e);var r=[];tn(e.children)&&(r=e.children),this.children=new Set(r),this.width=qe,this.height=Ve,this.foldedWidth=80,this.foldedHeight=60,this.zIndex=jn,this.radius=0,this.text.editable=!1,this.text.draggable=!1,this.isRestrict=!1,this.resizable=!1,this.autoToFront=!1,this.foldable=!1,this.properties.isFolded===void 0&&(this.properties.isFolded=!1),this.isFolded=!!this.properties.isFolded,setTimeout(function(){t.isFolded&&t.foldGroup(t.isFolded)})},n.prototype.getResizeOutlineStyle=function(){var e=i.prototype.getResizeOutlineStyle.call(this);return e.stroke="none",e},n.prototype.foldGroup=function(e){var t=this;if(e!==this.isFolded){this.setProperty("isFolded",e),this.isFolded=e,e?(this.x=this.x-this.width/2+this.foldedWidth/2,this.y=this.y-this.height/2+this.foldedHeight/2,this.unfoldedWidth=this.width,this.unfoldedHeight=this.height,this.width=this.foldedWidth,this.height=this.foldedHeight):(this.width=this.unfoldedWidth,this.height=this.unfoldedHeight,this.x=this.x+this.width/2-this.foldedWidth/2,this.y=this.y+this.height/2-this.foldedHeight/2);var r=B(B([],F(this.incoming.edges),!1),F(this.outgoing.edges),!1);this.children.forEach(function(o){var a=t.graphModel.getElement(o);if(a){var l=a.isFolded;if(a.isGroup&&!a.isFolded&&a.foldGroup(e),a.isGroup&&!e){var s=t.childrenLastFoldStatus[o];s!==void 0&&s!==a.isFolded&&a.foldGroup(s)}t.childrenLastFoldStatus[o]=!!l,a.visible=!e;var d=a.incoming.edges,u=a.outgoing.edges;r=B(B(B([],F(r),!1),F(d),!1),F(u),!1)}}),this.foldEdge(e,r)}},n.prototype.getAnchorStyle=function(e){var t=i.prototype.getAnchorStyle.call(this,e);return t.stroke="transparent",t.fill="transparent",t.hover.fill="transparent",t.hover.stroke="transparent",t},n.prototype.foldEdge=function(e,t){var r=this;t.forEach(function(o,a){var l=o.id,s=o.sourceNodeId,d=o.targetNodeId,u=o.startPoint,c=o.endPoint,f=o.type,h=o.text,v=o.getProperties(),p={id:"".concat(l,"__").concat(a),sourceNodeId:s,targetNodeId:d,startPoint:u,endPoint:c,type:f,properties:v,text:h==null?void 0:h.value};o.virtual&&r.graphModel.deleteEdgeById(o.id);var y=r.graphModel.group.getNodeGroup(d);y||(y=r.graphModel.getNodeModelById(d));var g=r.graphModel.group.getNodeGroup(s);g||(g=r.graphModel.getNodeModelById(s)),e&&o.visible!==!1&&(r.children.has(s)||r.id===s?(p.startPoint=void 0,p.sourceNodeId=r.id):(p.endPoint=void 0,p.targetNodeId=r.id),(y.id!==r.id||g.id!==r.id)&&r.createVirtualEdge(p),o.visible=!1),!e&&o.visible===!1&&(y&&y.isGroup&&y.isFolded?(p.targetNodeId=y.id,p.endPoint=void 0,r.createVirtualEdge(p)):g&&g.isGroup&&g.isFolded?(p.sourceNodeId=g.id,p.startPoint=void 0,r.createVirtualEdge(p)):o.visible=!0)})},n.prototype.createVirtualEdge=function(e){e.pointsList=void 0;var t=this.graphModel.addEdge(e);t.virtual=!0,t.text.editable=!1,t.isFoldedEdge=!0},n.prototype.isInRange=function(e){var t=e.minX,r=e.minY,o=e.maxX,a=e.maxY;return t>=this.x-this.width/2&&o<=this.x+this.width/2&&r>=this.y-this.height/2&&a<=this.y+this.height/2},n.prototype.isAllowMoveTo=function(e){var t=e.x1,r=e.y1,o=e.x2,a=e.y2;return{x:t>=this.x-this.width/2&&o<=this.x+this.width/2,y:r>=this.y-this.height/2&&a<=this.y+this.height/2}},n.prototype.setAllowAppendChild=function(e){this.setProperty("groupAddable",e)},n.prototype.addChild=function(e){this.children.add(e),this.graphModel.eventCenter.emit("group:add-node",{data:this.getData()})},n.prototype.removeChild=function(e){this.children.delete(e),this.graphModel.eventCenter.emit("group:remove-node",{data:this.getData()})},n.prototype.getAddableOutlineStyle=function(){return{stroke:"#FEB663",strokeWidth:2,strokeDasharray:"4 4",fill:"transparent"}},n.prototype.getData=function(){var e=this,t=i.prototype.getData.call(this);t.children=[],this.children,this.children.forEach(function(o){var a=e.graphModel.getNodeModelById(o);a&&!a.virtual&&t.children.push(o)});var r=t.properties;return r==null||delete r.groupAddable,r==null||delete r.isFolded,t},n.prototype.getHistoryData=function(){var e=i.prototype.getData.call(this);e.children=B([],F(this.children),!1),e.isGroup=!0;var t=e.properties;return t==null||delete t.groupAddable,t!=null&&t.isFolded&&(e.x=e.x+this.unfoldedWidth/2-this.foldedWidth/2,e.y=e.y+this.unfoldedHeight/2-this.foldedHeight/2),e},n.prototype.isAllowAppendIn=function(e){return console.info("_nodeData",e),!0},n.prototype.toBack=function(){this.zIndex--},n})(Cn);(function(i){zt(n,i);function n(){return i!==null&&i.apply(this,arguments)||this}return n.prototype.getControlGroup=function(){var e=this.props.model,t=e.resizable,r=e.properties;return t&&!r.isFolded?i.prototype.getControlGroup.call(this):null},n.prototype.getAddableShape=function(){var e=this.props.model,t=e.width,r=e.height,o=e.x,a=e.y,l=e.radius,s=e.properties,d=e.getAddableOutlineStyle;if(!s.groupAddable)return null;var u=this.props.model.getNodeStyle().strokeWidth,c=u===void 0?0:u,f=d(),h=t+c+8,v=r+c+8;return _("rect",ce(ce({},f),{width:h,height:v,x:o-h/2,y:a-v/2,rx:l,ry:l}))},n.prototype.getFoldIcon=function(){var e=this.props.model,t=e.x-e.width/2+5,r=e.y-e.height/2+5;if(!e.foldable)return null;var o=_("path",{fill:"none",stroke:"#818281",strokeWidth:2,"pointer-events":"none",d:e.properties.isFolded?"M ".concat(t+3,",").concat(r+6," ").concat(t+11,",").concat(r+6," M").concat(t+7,",").concat(r+2," ").concat(t+7,",").concat(r+10):"M ".concat(t+3,",").concat(r+6," ").concat(t+11,",").concat(r+6," ")});return _("g",{},[_("rect",{height:12,width:14,rx:2,ry:2,strokeWidth:1,fill:"#F4F5F6",stroke:"#CECECE",cursor:"pointer",x:e.x-e.width/2+5,y:e.y-e.height/2+5,onClick:function(){e.foldGroup(!e.properties.isFolded)}}),o])},n.prototype.getResizeShape=function(){return _("g",{},[this.getAddableShape(),i.prototype.getResizeShape.call(this),this.getFoldIcon()])},n})(Tn);var Ke=function(){var i=function(n,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])},i(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}}(),Q=function(){return Q=Object.assign||function(i){for(var n,e=1,t=arguments.length;e<t;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r])}return i},Q.apply(this,arguments)};function Dn(i){var n=function(t){Ke(r,t);function r(o,a){o.id||(o.id="Flow_".concat(On()));var l=Q(Q(Q({},{}),o.properties),{isDefaultFlow:!1});return o.properties=l,t.call(this,o,a)||this}return r.extendKey="SequenceFlowModel",r}(Ce),e=function(t){Ke(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r.prototype.getStartArrow=function(){var o=this.props.model,a=o.properties.isDefaultFlow;return a?_("path",{refX:15,stroke:"#000000",strokeWidth:2,d:"M 20 5 10 -5 z"}):_("path",{d:""})},r.extendKey="SequenceFlowEdge",r}(Te);return{type:"bpmn:sequenceFlow",view:e,model:n}}Dn();var Je={width:40,height:40},Ze={width:40,height:40},Qe={width:100,height:80},fe={width:100,height:80},et={width:100,height:80},tt={width:100,height:80},nt={width:100,height:80},rt={width:100,height:80},it={width:100,height:80},ot={width:100,height:80},T=function(){};T.ObjTree=function(){return this};T.ObjTree.VERSION="0.23";T.ObjTree.prototype.xmlDecl=`<?xml version="1.0" encoding="UTF-8" ?>
`;T.ObjTree.prototype.attr_prefix="-";T.ObjTree.prototype.parseXML=function(i){var n;if(window.DOMParser){var e=new DOMParser,t=e.parseFromString(i,"application/xml");if(!t)return;n=t.documentElement}else window.ActiveXObject&&(e=new ActiveXObject("Microsoft.XMLDOM"),e.async=!1,e.loadXML(i),n=e.documentElement);if(n){var r=this.parseDOM(n);return r}};T.ObjTree.prototype.parseHTTP=function(i,n,e){var t={};for(var r in n)t[r]=n[r];if(t.method||(typeof t.postBody>"u"&&typeof t.postbody>"u"&&typeof t.parameters>"u"?t.method="get":t.method="post"),e){t.asynchronous=!0;var o=this,a=e,l=t.onComplete;t.onComplete=function(u){var c;u&&u.responseXML&&u.responseXML.documentElement&&(c=o.parseDOM(u.responseXML.documentElement)),a(c,u),l&&l(u)}}else t.asynchronous=!1;var s;if(typeof HTTP<"u"&&HTTP.Request){t.uri=i;var d=new HTTP.Request(t);d&&(s=d.transport)}else if(typeof Ajax<"u"&&Ajax.Request){var d=new Ajax.Request(i,t);d&&(s=d.transport)}if(e)return s;if(s&&s.responseXML&&s.responseXML.documentElement)return this.parseDOM(s.responseXML.documentElement)};T.ObjTree.prototype.parseDOM=function(i){if(i){if(this.__force_array={},this.force_array)for(var n=0;n<this.force_array.length;n++)this.__force_array[this.force_array[n]]=1;var e=this.parseElement(i);if(this.__force_array[i.nodeName]&&(e=[e]),i.nodeType!==11){var t={};t[i.nodeName]=e,e=t}return e}};T.ObjTree.prototype.parseElement=function(i){if(i.nodeType!==7){if(i.nodeType===3||i.nodeType===4||i.nodeType===8){var n=i.nodeValue.match(/[^\x00-\x20]/);return n==null?void 0:i.nodeValue}var e=null,t={};if(i.attributes&&i.attributes.length){e={};for(var r=0;r<i.attributes.length;r++){var o=i.attributes[r].nodeName;if(typeof o=="string"){var a=i.attributes[r].nodeValue;try{a=JSON.parse(i.attributes[r].nodeValue.replace(/'/g,'"'))}catch{a=i.attributes[r].nodeValue}a!=null&&(o=this.attr_prefix+o,typeof t[o]>"u"&&(t[o]=0),t[o]++,this.addNode(e,o,t[o],a))}}}if(i.childNodes&&i.childNodes.length){var l=!0;e&&(l=!1);for(var r=0;r<i.childNodes.length&&l;r++){var s=i.childNodes[r].nodeType;s===3||s===4||s===8||(l=!1)}if(l){e||(e="");for(var r=0;r<i.childNodes.length;r++)e+=i.childNodes[r].nodeValue}else{e||(e={});for(var r=0;r<i.childNodes.length;r++){var o=i.childNodes[r].nodeName;if(typeof o=="string"){var a=this.parseElement(i.childNodes[r]);a&&(typeof t[o]>"u"&&(t[o]=0),t[o]++,this.addNode(e,o,t[o],a))}}}}else e===null&&(e={});return e}};T.ObjTree.prototype.addNode=function(i,n,e,t){this.__force_array[n]?(e===1&&(i[n]=[]),i[n][i[n].length]=t):e===1?i[n]=t:e===2?i[n]=[i[n],t]:i[n][i[n].length]=t};T.ObjTree.prototype.writeXML=function(i){var n=this.hash_to_xml(null,i);return this.xmlDecl+n};T.ObjTree.prototype.hash_to_xml=function(i,n){var e=[],t=[];for(var r in n)if(nn(n,r)){var o=n[r];r.charAt(0)!==this.attr_prefix?typeof o>"u"||o==null?e[e.length]="<".concat(r," />"):typeof o=="object"&&o.constructor===Array?e[e.length]=this.array_to_xml(r,o):typeof o=="object"?e[e.length]=this.hash_to_xml(r,o):e[e.length]=this.scalar_to_xml(r,o):t[t.length]=" ".concat(r.substring(1),'="').concat(this.xml_escape(o),'"')}var a=t.join(""),l=e.join("");return typeof i>"u"||i==null||(e.length>0?l.match(/\n/)?l="<".concat(i).concat(a,`>
`).concat(l,"</").concat(i,`>
`):l="<".concat(i).concat(a,">").concat(l,"</").concat(i,`>
`):l="<".concat(i).concat(a,` />
`)),l};T.ObjTree.prototype.array_to_xml=function(i,n){for(var e=[],t=0;t<n.length;t++){var r=n[t];typeof r>"u"||r==null?e[e.length]="<".concat(i," />"):typeof r=="object"&&r.constructor===Array?e[e.length]=this.array_to_xml(i,r):typeof r=="object"?e[e.length]=this.hash_to_xml(i,r):e[e.length]=this.scalar_to_xml(i,r)}return e.join("")};T.ObjTree.prototype.scalar_to_xml=function(i,n){return i==="#text"?this.xml_escape(n):"<".concat(i,">").concat(this.xml_escape(n),"</").concat(i,`>
`)};T.ObjTree.prototype.xml_escape=function(i){return i.replace(/&/g,"&").replace(/</g,"<").replace(/>/g,">").replace(/"/g,'"')};var Rn=function(i){return new T.ObjTree().parseXML(i)};function Wt(i){return Object.prototype.toString.call(i)}function at(i){return"  ".repeat(i)}function pe(i){return Wt(i)==="[object Object]"?Object.keys(i).reduce(function(n,e){var t=e;return e.charAt(0)==="-"&&(t=e.substring(1)),n[t]=pe(i[e]),n},{}):Array.isArray(i)?i.map(function(n){return pe(n)}):i}function In(i){var n=i;try{typeof n!="string"&&(n=JSON.parse(i))}catch{n=JSON.stringify(pe(i)).replace(/"/g,"'")}return n}var lt=`	
`;function ie(i,n,e){var t=at(e),r="",o=lt+t;if(n==="-json")return"";if(n==="#text")return o+i;if(n==="#cdata-section")return"".concat(o,"<![CDATA[").concat(i,"]]>");if(n==="#comment")return"".concat(o,"<!--").concat(i,"-->");if("".concat(n).charAt(0)==="-")return" ".concat(n.substring(1),'="').concat(In(i),'"');if(Array.isArray(i))r+=i.map(function(d){return ie(d,n,e+1)}).join("");else if(Wt(i)==="[object Object]"){var a=Object.keys(i),l="",s=i["-json"]?lt+at(e+1)+i["-json"]:"";r+="".concat(e===0?"":o,"<").concat(n),a.forEach(function(d){d.charAt(0)==="-"?l+=ie(i[d],d,e+1):s+=ie(i[d],d,e+1)}),r+=l+(s!==""?">".concat(s).concat(o,"</").concat(n,">"):" />")}else r+="".concat(o,"<").concat(n,">").concat(i.toString(),"</").concat(n,">");return r}function Ln(i){var n="";for(var e in i)n+=ie(i[e],e,0);return n}var zn=function(){var i=function(n,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])},i(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}}(),Pe=function(){return Pe=Object.assign||function(i){for(var n,e=1,t=arguments.length;e<t;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r])}return i},Pe.apply(this,arguments)},st=function(i,n){var e={};for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&n.indexOf(t)<0&&(e[t]=i[t]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,t=Object.getOwnPropertySymbols(i);r<t.length;r++)n.indexOf(t[r])<0&&Object.prototype.propertyIsEnumerable.call(i,t[r])&&(e[t[r]]=i[t[r]]);return e},je=function(i){var n=typeof Symbol=="function"&&Symbol.iterator,e=n&&i[n],t=0;if(e)return e.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&t>=i.length&&(i=void 0),{value:i&&i[t++],done:!i}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")},N=function(i,n){var e=typeof Symbol=="function"&&i[Symbol.iterator];if(!e)return i;var t=e.call(i),r,o=[],a;try{for(;(n===void 0||n-- >0)&&!(r=t.next()).done;)o.push(r.value)}catch(l){a={error:l}}finally{try{r&&!r.done&&(e=t.return)&&e.call(t)}finally{if(a)throw a.error}}return o},L=function(i,n,e){if(e||arguments.length===2)for(var t=0,r=n.length,o;t<r;t++)(o||!(t in n))&&(o||(o=Array.prototype.slice.call(n,0,t)),o[t]=n[t]);return i.concat(o||Array.prototype.slice.call(n))},P;(function(i){i.START="bpmn:startEvent",i.END="bpmn:endEvent",i.INTERMEDIATE_CATCH="bpmn:intermediateCatchEvent",i.INTERMEDIATE_THROW="bpmn:intermediateThrowEvent",i.BOUNDARY="bpmn:boundaryEvent",i.PARALLEL_GATEWAY="bpmn:parallelGateway",i.INCLUSIVE_GATEWAY="bpmn:inclusiveGateway",i.EXCLUSIVE_GATEWAY="bpmn:exclusiveGateway",i.USER="bpmn:userTask",i.SYSTEM="bpmn:serviceTask",i.FLOW="bpmn:sequenceFlow",i.SUBPROCESS="bpmn:subProcess"})(P||(P={}));var Ht=["-name","-id","bpmn:incoming","bpmn:outgoing","-sourceRef","-targetRef","-children"],Wn=["properties","startPoint","endPoint","pointsList"],he={in:[],out:["properties.panels","properties.nodeSize","properties.definitionId","properties.timerValue","properties.timerType","properties.definitionType","properties.parent","properties.isBoundaryEventTouchingTask"]},Xt=function(i,n){var e=Object.keys(n||{});return e.forEach(function(t){if(i[t]){var r=n[t],o=r.in,a=r.out;o&&(i[t].in=o),a&&(i[t].out=a)}else i[t]=n[t]}),i},I={"bpmn:startEvent":{out:function(i){var n,e,t=i.properties;return((e=(n=I[t.definitionType])===null||n===void 0?void 0:n.out)===null||e===void 0?void 0:e.call(n,i))||{}}},"bpmn:intermediateCatchEvent":{out:function(i){var n,e,t=i.properties;return((e=(n=I[t.definitionType])===null||n===void 0?void 0:n.out)===null||e===void 0?void 0:e.call(n,i))||{}}},"bpmn:intermediateThrowEvent":{out:function(i){var n,e,t=i.properties;return((e=(n=I[t.definitionType])===null||n===void 0?void 0:n.out)===null||e===void 0?void 0:e.call(n,i))||{}}},"bpmn:boundaryEvent":{out:function(i){var n,e,t=i.properties;return((e=(n=I[t.definitionType])===null||n===void 0?void 0:n.out)===null||e===void 0?void 0:e.call(n,i))||{}}},"bpmn:sequenceFlow":{out:function(i){var n=i.properties,e=n.expressionType,t=n.condition;return t?e==="cdata"?{json:'<bpmn:conditionExpression xsi:type="bpmn2:tFormalExpression"><![CDATA[${'.concat(t,"}]]></bpmn:conditionExpression>")}:{json:'<bpmn:conditionExpression xsi:type="bpmn2:tFormalExpression">'.concat(t,"</bpmn:conditionExpression>")}:{json:""}}},"bpmn:timerEventDefinition":{out:function(i){var n=i.properties,e=n.timerType,t=n.timerValue,r=n.definitionId,o=function(){return"<bpmn:".concat(e,' xsi:type="bpmn:tFormalExpression">').concat(t,"</bpmn:").concat(e,">")};return{json:'<bpmn:timerEventDefinition id="'.concat(r,'"').concat(e&&t?">".concat(o(),"</bpmn:timerEventDefinition>"):"/>")}},in:function(i,n){var e,t,r,o,a=i,l=n["-id"],s="",d="";try{for(var u=je(Object.keys(n)),c=u.next();!c.done;c=u.next()){var f=c.value;f.includes("bpmn:")&&(r=N(f.split(":"),2),s=r[1],d=(o=n[f])===null||o===void 0?void 0:o["#text"])}}catch(h){e={error:h}}finally{try{c&&!c.done&&(t=u.return)&&t.call(u)}finally{if(e)throw e.error}}return{"-definitionId":l,"-definitionType":a,"-timerType":s,"-timerValue":d}}},"bpmn:conditionExpression":{in:function(i,n){var e,t="",r="";return n["#cdata-section"]?(r="cdata",t=((e=/^\$\{(.*)\}$/g.exec(n["#cdata-section"]))===null||e===void 0?void 0:e[1])||""):n["#text"]&&(r="normal",t=n["#text"]),{"-condition":t,"-expressionType":r}}}};function Hn(i){var n=i??{},e=n.retainedAttrsFields,t=n.excludeFields,r=n.transformer,o=new Set(L(L([],N(Wn),!1),N(e||[]),!1)),a={in:new Set(L(L([],N(he.in),!1),N((t==null?void 0:t.in)||[]),!1)),out:new Set(L(L([],N(he.out),!1),N((t==null?void 0:t.out)||[]),!1))};return I=Xt(I,r),function(l){var s=l.nodes,d=l.edges;function u(c,f){var h,v;if((c==null?void 0:c.flag)!==1){var p;if((p=I[c.type])&&p.out){var y=p.out(c),g=Object.keys(y);g.length>0&&g.forEach(function(E){c[E]=y[E]})}c!=null&&c.children&&(c.children=c.children.map(function(E){var $t=s.find(function(Oe){return Oe.id===E})||d.find(function(Oe){return Oe.id===E});return $t||{}}));var m={};if(typeof c=="string")return c;if(Array.isArray(c))return c.map(function(E){return u(E,"")}).filter(function(E){return E!=null});try{for(var b=je(Object.entries(c)),w=b.next();!w.done;w=b.next()){var O=N(w.value,2),M=O[0],x=O[1];if((x==null?void 0:x.flag)===1)return;var j=[f,M].filter(function(E){return E}).join(".");a.out.has(j)||(typeof x!="object"?M.indexOf("-")===0||["#text","#cdata-section","#comment"].includes(M)?m[M]=x:m["-".concat(M)]=x:o.has(j)?m["-".concat(M)]=u(x,j):m[M]=u(x,j))}}catch(E){h={error:E}}finally{try{w&&!w.done&&(v=b.return)&&v.call(b)}finally{if(h)throw h.error}}return m}}return u(l,"")}}function ve(i){var n,e,t={};try{for(var r=je(Object.entries(i)),o=r.next();!o.done;o=r.next()){var a=N(o.value,2),l=a[0],s=a[1];l.indexOf("-")===0?t[l.substring(1)]=pe(s):typeof s=="string"?t[l]=s:Object.prototype.toString.call(s)==="[object Object]"?t[l]=ve(s):Array.isArray(s)?t[l]=s.map(function(d){return ve(d)}):t[l]=s}}catch(d){n={error:d}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(n)throw n.error}}return t}function Xn(i,n,e){var t,r=new Map,o=Hn(e)(n);o.nodes.forEach(function(l){var s=l["-id"],d=l["-type"],u=l.text,c=l.children,f=st(l,["-id","-type","text","children"]),h={"-id":s};u!=null&&u["-value"]&&(h["-name"]=u["-value"]),f["-json"]&&(h["-json"]=f["-json"]),f["-properties"]&&Object.assign(h,f["-properties"]),c&&(h.children=c),i[d]||(i[d]=[]),i[d].push(h),r.set(s,h)});var a=o.edges.map(function(l){var s=l["-id"],d=l["-sourceNodeId"],u=l["-targetNodeId"],c=l.text,f=st(l,["-id","-sourceNodeId","-targetNodeId","text"]),h=r.get(u);h["bpmn:incoming"]||(h["bpmn:incoming"]=[]),h["bpmn:incoming"].push(s);var v={"-id":s,"-sourceRef":d,"-targetRef":u};return c!=null&&c["-value"]&&(v["-name"]=c["-value"]),f["-json"]&&(v["-json"]=f["-json"]),f["-properties"]&&Object.assign(v,f["-properties"]),v});return n.edges.forEach(function(l){var s=l.sourceNodeId,d=l.id,u=r.get(s);u["bpmn:outgoing"]||(u["bpmn:outgoing"]=[]),u["bpmn:outgoing"].push(d)}),(t=i["bpmn:subProcess"])===null||t===void 0||t.forEach(function(l){var s={"bpmn:incoming":new Set,"bpmn:outgoing":new Set},d=[];l.children.forEach(function(p){var y,g=r.get(p["-id"]);["bpmn:incoming","bpmn:outgoing"].forEach(function(b){g[b]&&g[b].forEach(function(w){s[b].add(w)})});var m=(y=i[p["-type"]])===null||y===void 0?void 0:y.findIndex(function(b){return b["-id"]===p["-id"]});m>=0&&i[p["-type"]].splice(m,1),r.delete(p["-id"]),l[p["-type"]]||(l[p["-type"]]=[]),l[p["-type"]].push(g)});var u=s["bpmn:incoming"],c=s["bpmn:outgoing"];c.forEach(function(p){u.has(p)&&d.push(p)});for(var f=function(p){var y=a.findIndex(function(g){return g["-id"]===d[p]});y>=0?(l["bpmn:sequenceFlow"]||(l["bpmn:sequenceFlow"]=[]),l["bpmn:sequenceFlow"].push(a[y]),a.splice(y,1)):p++,h=p},h,v=0;v<d.length;)f(v),v=h;delete l.children}),i[P.FLOW]=a,i}function Fn(i,n){i["bpmndi:BPMNEdge"]=n.edges.map(function(e){var t,r=e.id,o=e.pointsList.map(function(l){var s=l.x,d=l.y;return{"-x":s,"-y":d}}),a={"-id":"".concat(r,"_di"),"-bpmnElement":r,"di:waypoint":o};return!((t=e.text)===null||t===void 0)&&t.value&&(a["bpmndi:BPMNLabel"]={"dc:Bounds":{"-x":e.text.x-e.text.value.length*10/2,"-y":e.text.y-7,"-width":e.text.value.length*10,"-height":14}}),a}),i["bpmndi:BPMNShape"]=n.nodes.map(function(e){var t,r=e.id,o=100,a=80,l=e.x,s=e.y,d=D.shapeConfigMap.get(e.type);d&&(o=d.width,a=d.height),l-=o/2,s-=a/2;var u={"-id":"".concat(r,"_di"),"-bpmnElement":r,"dc:Bounds":{"-x":l,"-y":s,"-width":o,"-height":a}};return!((t=e.text)===null||t===void 0)&&t.value&&(u["bpmndi:BPMNLabel"]={"dc:Bounds":{"-x":e.text.x-e.text.value.length*10/2,"-y":e.text.y-7,"-width":e.text.value.length*10,"-height":14}}),u})}var Bn=["bpmn:incoming","bpmn:outgoing"];function $n(i,n){var e=[],t=[],r=new Map,o=n??{},a=o.transformer,l=o.excludeFields,s={in:new Set(L(L([],N(he.in),!1),N((l==null?void 0:l.in)||[]),!1)),out:new Set(L(L([],N(he.out),!1),N((l==null?void 0:l.out)||[]),!1))};I=Xt(I,a);var d=i["bpmn:definitions"];if(d){var u=d["bpmn:process"];(function(f,h){h.forEach(function(v){try{Object.keys(f).forEach(function(p){try{v(p)}catch(y){console.error(y)}})}catch(p){console.error(p)}})})(u,[function(f){function h(p){p["-children"]||(p["-children"]=[]),Object.keys(p).forEach(function(y){var g;y.indexOf("bpmn:")===0&&!Bn.includes(y)&&(u[y]||(u[y]=[]),!Array.isArray(u[y])&&(u[y]=[u[y]]),Array.isArray(p[y])?(g=u[y]).push.apply(g,L([],N(p[y]),!1)):u[y].push(p[y]),Array.isArray(p[y])?p[y].forEach(function(m){!y.includes("Flow")&&p["-children"].push(m["-id"])}):!y.includes("Flow")&&p["-children"].push(p[y]["-id"]),delete p[y])})}if(f==="bpmn:subProcess"){var v=u[f];Array.isArray(v)?v.forEach(function(p){f==="bpmn:subProcess"&&h(p)}):h(v)}},function(f){var h=function(p){Object.keys(p).forEach(function(y){var g,m;if(y.includes("bpmn:")){var b={};I[y]&&I[y].in?(b=(m=(g=I[y]).in)===null||m===void 0?void 0:m.call(g,y,Ot.cloneDeep(p[y])),delete p[y]):v(p[y]);var w=void 0;(w=Reflect.ownKeys(b)).length>0&&w.forEach(function(O){Reflect.set(p,O,b[O])})}})};function v(p){r.set(p["-id"],p),Array.isArray(p)?p.forEach(function(y){v(y)}):typeof p=="object"&&h(p)}v(u[f])},function(f){if(f.indexOf("bpmn:")===0){var h=u[f];if(f==="bpmn:sequenceFlow"){var v=d["bpmndi:BPMNDiagram"]["bpmndi:BPMNPlane"]["bpmndi:BPMNEdge"];t=Gn(h,v)}else{var p=d["bpmndi:BPMNDiagram"]["bpmndi:BPMNPlane"]["bpmndi:BPMNShape"];if(f==="bpmn:boundaryEvent"){var y=u[f],g=function(m){var b=m["-attachedToRef"],w=r.get(b);w["-boundaryEvents"]||(w["-boundaryEvents"]=[]),w["-boundaryEvents"].push(m["-id"])};Array.isArray(y)?y.forEach(function(m){g(m)}):g(y)}e=e.concat(kn(h,p,f))}}}])}var c=function(f,h,v){Object.keys(f).forEach(function(p){var y=v?"".concat(v,".").concat(p):p;h.has(y)?delete f[p]:typeof f[p]=="object"&&c(f[p],h,y)})};return e.forEach(function(f){var h,v;if(!((h=n==null?void 0:n.mapping)===null||h===void 0)&&h.in){var p=(v=n==null?void 0:n.mapping)===null||v===void 0?void 0:v.in,y=f.type;p[y]&&(f.type=p[y])}c(f,s.in,"")}),t.forEach(function(f){var h,v;if(!((h=n==null?void 0:n.mapping)===null||h===void 0)&&h.in){var p=(v=n==null?void 0:n.mapping)===null||v===void 0?void 0:v.in,y=f.type;p[y]&&(f.type=p[y])}c(f,s.in,"")}),{nodes:e,edges:t}}function kn(i,n,e){var t=[];if(Array.isArray(i))i.forEach(function(a){var l;Array.isArray(n)?l=n.find(function(d){return d["-bpmnElement"]===a["-id"]}):l=n;var s=dt(l,e,a);t.push(s)});else{var r=void 0;Array.isArray(n)?r=n.find(function(a){return a["-bpmnElement"]===i["-id"]}):r=n;var o=dt(r,e,i);t.push(o)}return t}function dt(i,n,e){var t=Number(i["dc:Bounds"]["-x"]),r=Number(i["dc:Bounds"]["-y"]),o=e["-children"],a=e["-name"],l=D.shapeConfigMap.get(n);l&&(t+=l.width/2,r+=l.height/2);var s={};Object.entries(e).forEach(function(f){var h=N(f,2),v=h[0],p=h[1];Ht.includes(v)||(s[v]=p)}),s=ve(s);var d;if(a&&(d={x:t,y:r,value:a},i["bpmndi:BPMNLabel"]&&i["bpmndi:BPMNLabel"]["dc:Bounds"])){var u=i["bpmndi:BPMNLabel"]["dc:Bounds"];d.x=Number(u["-x"])+Number(u["-width"])/2,d.y=Number(u["-y"])+Number(u["-height"])/2}var c={id:i["-bpmnElement"],type:n,x:t,y:r,properties:s};return o&&(c.children=o),d&&(c.text=d),c}function Gn(i,n){var e=[];if(Array.isArray(i))i.forEach(function(r){var o;Array.isArray(n)?o=n.find(function(a){return a["-bpmnElement"]===r["-id"]}):o=n,e.push(ut(o,r))});else{var t=void 0;Array.isArray(n)?t=n.find(function(r){return r["-bpmnElement"]===i["-id"]}):t=n,e.push(ut(t,i))}return e}function ut(i,n){var e,t=n["-name"]?"".concat(n["-name"]):"";if(t){var r=i["bpmndi:BPMNLabel"]["dc:Bounds"],o=0;t.split(`
`).forEach(function(d){o<d.length&&(o=d.length)}),e={value:t,x:Number(r["-x"])+o*10/2,y:Number(r["-y"])+7}}var a={};Object.entries(n).forEach(function(d){var u=N(d,2),c=u[0],f=u[1];Ht.includes(c)||(a[c]=f)}),a=ve(a);var l=i["di:waypoint"].map(function(d){return{x:Number(d["-x"]),y:Number(d["-y"])}}),s={id:n["-id"],type:P.FLOW,pointsList:l,sourceNodeId:n["-sourceRef"],targetNodeId:n["-targetRef"],properties:a};return e&&(s.text=e),s}var D=function(){function i(n){var e=n.lf,t=this;this.adapterOut=function(r,o){var a,l,s=Pe({},t.processAttributes);Xn(s,r,o);var d={"-id":"BPMNPlane_1","-bpmnElement":s["-id"]};Fn(d,r);var u=t.definitionAttributes;u["bpmn:process"]=s,u["bpmndi:BPMNDiagram"]={"-id":"BPMNDiagram_1","bpmndi:BPMNPlane":d};var c={"bpmn:definitions":u};if(!((a=o==null?void 0:o.mapping)===null||a===void 0)&&a.out){var f=(l=o==null?void 0:o.mapping)===null||l===void 0?void 0:l.out,h=function(v){Array.isArray(v)&&v.forEach(function(p){return h(p)}),typeof v=="object"&&Object.keys(v).forEach(function(p){var y;(y=f[p])?(v[y]=Ot.cloneDeep(v[p]),delete v[p],h(v[y])):h(v[p])})};h(c)}return c},this.adapterIn=function(r,o){if(r)return $n(r,o)},e.adapterIn=this.adapterIn,e.adapterOut=this.adapterOut,this.processAttributes={"-isExecutable":"true","-id":"Process"},this.definitionAttributes={"-id":"Definitions","-xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","-xmlns:bpmn":"http://www.omg.org/spec/BPMN/20100524/MODEL","-xmlns:bpmndi":"http://www.omg.org/spec/BPMN/20100524/DI","-xmlns:dc":"http://www.omg.org/spec/DD/20100524/DC","-xmlns:di":"http://www.omg.org/spec/DD/20100524/DI","-targetNamespace":"http://logic-flow.org","-exporter":"logicflow","-exporterVersion":"1.2.10"}}return i.prototype.setCustomShape=function(n,e){i.shapeConfigMap.set(n,e)},i.pluginName="bpmn-adapter",i.shapeConfigMap=new Map,i}();D.shapeConfigMap.set(P.START,{width:Je.width,height:Je.height});D.shapeConfigMap.set(P.END,{width:Ze.width,height:Ze.height});D.shapeConfigMap.set(P.INTERMEDIATE_CATCH,{width:fe.width,height:fe.height});D.shapeConfigMap.set(P.INTERMEDIATE_THROW,{width:fe.width,height:fe.height});D.shapeConfigMap.set(P.BOUNDARY,{width:Qe.width,height:Qe.height});D.shapeConfigMap.set(P.PARALLEL_GATEWAY,{width:et.width,height:et.height});D.shapeConfigMap.set(P.INCLUSIVE_GATEWAY,{width:tt.width,height:tt.height});D.shapeConfigMap.set(P.EXCLUSIVE_GATEWAY,{width:nt.width,height:nt.height});D.shapeConfigMap.set(P.SYSTEM,{width:rt.width,height:rt.height});D.shapeConfigMap.set(P.USER,{width:it.width,height:it.height});D.shapeConfigMap.set(P.SUBPROCESS,{width:ot.width,height:ot.height});(function(i){zn(n,i);function n(e){var t=i.call(this,e)||this;t.adapterXmlIn=function(a){var l=Rn(a);return t.adapterIn(l,t.props)},t.adapterXmlOut=function(a){var l=t.adapterOut(a,t.props);return Ln(l)};var r=e.lf,o=e.props;return r.adapterIn=t.adapterXmlIn,r.adapterOut=t.adapterXmlOut,t.props=o,t}return n.pluginName="BPMNAdapter",n})(D);function Yn(i,n,e){var t=n.x,r=n.y,o=i.x,a=i.y,l=o-t,s=a-r,d=l*Math.cos(e)-s*Math.sin(e),u=l*Math.sin(e)+s*Math.cos(e),c=d+t,f=u+r;return{x:c,y:f}}var Un=function(){var i=function(n,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])},i(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}}(),ye=function(){return ye=Object.assign||function(i){for(var n,e=1,t=arguments.length;e<t;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r])}return i},ye.apply(this,arguments)},qn=function(i,n){var e=typeof Symbol=="function"&&i[Symbol.iterator];if(!e)return i;var t=e.call(i),r,o=[],a;try{for(;(n===void 0||n-- >0)&&!(r=t.next()).done;)o.push(r.value)}catch(l){a={error:l}}finally{try{r&&!r.done&&(e=t.return)&&e.call(t)}finally{if(a)throw a.error}}return o},Vn=function(i,n,e){if(e||arguments.length===2)for(var t=0,r=n.length,o;t<r;t++)(o||!(t in n))&&(o||(o=Array.prototype.slice.call(n,0,t)),o[t]=n[t]);return i.concat(o||Array.prototype.slice.call(n))};(function(i){Un(n,i);function n(){var e=i.apply(this,Vn([],qn(arguments),!1))||this;return e.childrenPositionMap=new Map,e.onNodeRotate=function(t){var r=t.model,o=e.props,a=o.model,l=o.graphModel,s=a.transformWithContainer,d=a.isRestrict,u=e.childrenPositionMap;if(!(!s||d)&&r.id===a.id){var c={x:a.x,y:a.y};W(Array.from(a.children),function(f){var h=l.getNodeModelById(f);if(h){var v={x:h.x,y:h.y};u.has(h.id)?v=u.get(h.id):u.set(h.id,v);var p=r.rotate*(180/Math.PI);p<0&&(p+=360);var y=p*(Math.PI/180),g=Yn(v,c,y);h.moveTo(g.x,g.y),h.rotate=r.rotate}})}},e.onNodeResize=function(t){var r=t.deltaX,o=t.deltaY,a=t.index,l=t.model,s=t.preData,d=e.props,u=d.model,c=d.graphModel,f=u.transformWithContainer,h=u.isRestrict;if(!(!f||h)&&l.id===u.id){var v=s.properties,p=v||{},y=p.width,g=p.height;W(Array.from(u.children),function(m){var b=c.getNodeModelById(m);if(b){var w=b.width/y*r,O=b.height/g*o;Zt({deltaX:w,deltaY:O,index:a,nodeModel:b,graphModel:c,cancelCallback:function(){}})}})}},e.onNodeMouseMove=function(t){var r=t.deltaX,o=t.deltaY,a=t.data,l=e.props,s=l.model,d=l.graphModel,u=d.transformModel,c=u.SCALE_X,f=u.SCALE_Y;if(a.id===s.id){var h=e.getNodesInGroup(s,d);d.moveNodes(h,r/c,o/f,!0)}},e.graphRendered=function(){var t=e.props.model;t.isCollapsed&&t.toggleCollapse(!0)},e}return n.prototype.componentDidMount=function(){i.prototype.componentDidMount.call(this);var e=this.props.graphModel.eventCenter;e.on("node:rotate",this.onNodeRotate),e.on("node:resize",this.onNodeResize),e.on("node:mousemove",this.onNodeMouseMove),e.on("graph:rendered",this.graphRendered)},n.prototype.componentWillUnmount=function(){i.prototype.componentWillUnmount.call(this);var e=this.props.graphModel.eventCenter;e.off("node:rotate",this.onNodeRotate),e.off("node:resize",this.onNodeResize),e.off("node:mousemove",this.onNodeMouseMove),e.off("graph:rendered",this.graphRendered)},n.prototype.getNodesInGroup=function(e,t){var r=this,o=[];return e.isGroup&&W(Array.from(e.children),function(a){o.push(a);var l=t.getNodeModelById(a);l!=null&&l.isGroup&&(o=o.concat(r.getNodesInGroup(l,t)))}),o},n.prototype.getResizeControl=function(){var e=this.props.model,t=e.resizable,r=e.isCollapsed,o=t&&!r;return o?i.prototype.getResizeControl.call(this):null},n.prototype.getAppendAreaShape=function(){var e=this.props.model,t=e.width,r=e.height,o=e.x,a=e.y,l=e.radius,s=e.groupAddable;if(!s)return null;var d=e.getNodeStyle().strokeWidth,u=d===void 0?0:d,c=e.getAddableOutlineStyle(),f=t+u+8,h=r+u+8;return _("rect",ye(ye({},c),{width:f,height:h,x:o-f/2,y:a-h/2,rx:l,ry:l}))},n.prototype.getCollapseIcon=function(e,t){return"M ".concat(e+3,",").concat(t+6," ").concat(e+11,",").concat(t+6," M").concat(e+7,",").concat(t+2," ").concat(e+7,",").concat(t+10)},n.prototype.getExpandIcon=function(e,t){return"M ".concat(e+3,",").concat(t+6," ").concat(e+11,",").concat(t+6," ")},n.prototype.getOperateIcon=function(){var e=this.props.model,t=e.x,r=e.y,o=e.width,a=e.height,l=t-o/2+10,s=r-a/2+10;if(!e.collapsible)return null;var d=e!=null&&e.isCollapsed?this.getCollapseIcon(l,s):this.getExpandIcon(l,s),u=_("path",{fill:"none",stroke:"#818281",strokeWidth:2,"pointer-events":"none",d});return _("g",{},[_("rect",{height:12,width:14,rx:2,ry:2,strokeWidth:1,fill:"#f4f5f6",stroke:"#cecece",cursor:"pointer",x:l,y:s,onClick:function(){e.toggleCollapse(!e.isCollapsed)}}),u])},n.prototype.getShape=function(){return _("g",{},[this.getAppendAreaShape(),i.prototype.getShape.call(this),this.getOperateIcon()])},n})(te);var Kn=function(){var i=function(n,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])},i(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}}(),ge=function(){return ge=Object.assign||function(i){for(var n,e=1,t=arguments.length;e<t;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r])}return i},ge.apply(this,arguments)},Se=function(i,n,e,t){var r=arguments.length,o=r<3?n:t===null?t=Object.getOwnPropertyDescriptor(n,e):t,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(i,n,e,t);else for(var l=i.length-1;l>=0;l--)(a=i[l])&&(o=(r<3?a(o):r>3?a(n,e,o):a(n,e))||o);return r>3&&o&&Object.defineProperty(n,e,o),o},U=function(i,n){var e=typeof Symbol=="function"&&i[Symbol.iterator];if(!e)return i;var t=e.call(i),r,o=[],a;try{for(;(n===void 0||n-- >0)&&!(r=t.next()).done;)o.push(r.value)}catch(l){a={error:l}}finally{try{r&&!r.done&&(e=t.return)&&e.call(t)}finally{if(a)throw a.error}}return o},q=function(i,n,e){if(e||arguments.length===2)for(var t=0,r=n.length,o;t<r;t++)(o||!(t in n))&&(o||(o=Array.prototype.slice.call(n,0,t)),o[t]=n[t]);return i.concat(o||Array.prototype.slice.call(n))},Jn=400,Zn=230,Qn=80,er=60,tr=-1e4;(function(i){Kn(n,i);function n(e,t){var r=i.call(this,e,t)||this;return r.isGroup=!0,r.isRestrict=!1,r.autoResize=!1,r.collapsible=!0,r.isCollapsed=!1,r.groupAddable=!1,r.transformWithContainer=!1,r.childrenLastCollapseStateDict=new Map,r.childrenLastCollapseStateDict=new Map,r.initNodeData(e),r.setAttributes(),r}return n.prototype.initNodeData=function(e){var t;i.prototype.initNodeData.call(this,e);var r=(t=e.properties)!==null&&t!==void 0?t:{},o=r.children,a=r.width,l=r.height,s=r.collapsedWidth,d=r.collapsedHeight,u=r.collapsible,c=r.isCollapsed,f=r.zIndex,h=r.isRestrict,v=r.autoResize,p=r.autoToFront,y=r.transformWithContainer;this.children=o?new Set(o):new Set,this.zIndex=f??tr,this.isCollapsed=c??!1;var g=a??Jn,m=l??Zn;this.width=g,this.height=m,this.expandWidth=g,this.expandHeight=m,this.collapsedWidth=s??Qn,this.collapsedHeight=d??er,this.isRestrict=h??!1,this.transformWithContainer=y??!1,this.autoResize=v??!1,this.collapsible=u??!0,this.autoToFront=p??!1,this.text.editable=!1,this.text.draggable=!1},n.prototype.setAttributes=function(){i.prototype.setAttributes.call(this)},n.prototype.getData=function(){var e=this,t=i.prototype.getData.call(this),r=[];return W(Array.from(this.children),function(o){var a=e.graphModel.getNodeModelById(o);a&&!a.virtual&&r.push(o)}),t.children=r,t.properties&&(t.properties.children=r,t.properties.isCollapsed=this.isCollapsed),t},n.prototype.getHistoryData=function(){var e=i.prototype.getHistoryData.call(this);e.children=Array.from(this.children),e.isGroup=!0;var t=this,r=t.x,o=t.y,a=t.collapsedWidth,l=t.collapsedHeight,s=t.expandWidth,d=t.expandHeight,u=t.isCollapsed;return u&&(e.x=r+s/2-a/2,e.y=o+d/2-l/2,e.text&&(e.text.x=e.text.x+s/2-a/2,e.text.y=e.text.y+d/2-l/2)),e},n.prototype.toggleCollapse=function(e){var t=this,r=!!e;this.isCollapsed=r,r?this.collapse():this.expand();var o=q(q([],U(this.incoming.edges),!1),U(this.outgoing.edges),!1),a=Array.from(this.children);W(a,function(l){var s,d,u=t.graphModel.elementsModelMap.get(l);if(u){var c=u.isCollapsed;if(u.isGroup){var f=u;if(f.isCollapsed||f.toggleCollapse(e),!e){var h=(s=t.childrenLastCollapseStateDict)===null||s===void 0?void 0:s.get(l);h!==void 0&&h!==u.isCollapsed&&f.toggleCollapse(h)}}if((d=t.childrenLastCollapseStateDict)===null||d===void 0||d.set(l,!!c),u.visible=!e,u.BaseType===Qt.NODE){var v=u.incoming.edges,p=u.outgoing.edges;o=q(q(q([],U(o),!1),U(v),!1),U(p),!1)}}}),this.collapseEdge(r,o)},n.prototype.collapse=function(){var e=this,t=e.x,r=e.y,o=e.text,a=e.width,l=e.height,s=e.collapsedWidth,d=e.collapsedHeight;this.x=t-a/2+s/2,this.y=r-l/2+d/2,this.text.x=o.x-a/2+s/2,this.text.y=o.y-l/2+d/2,this.expandWidth=a,this.expandHeight=l,this.width=s,this.height=d},n.prototype.expand=function(){var e=this,t=e.x,r=e.y,o=e.text,a=e.expandWidth,l=e.expandHeight,s=e.collapsedWidth,d=e.collapsedHeight;this.width=a,this.height=l,this.x=t+this.width/2-s/2,this.y=r+this.height/2-d/2,this.text.x=o.x+this.width/2-s/2,this.text.y=o.y+this.height/2-d/2},n.prototype.createVirtualEdge=function(e){e.pointsList=void 0;var t=this.graphModel.addEdge(e);t.virtual=!0,t.text.editable=!1,t.isCollapsedEdge=!0},n.prototype.collapseEdge=function(e,t){var r=this,o=this.graphModel;W(t,function(a,l){var s,d=a.getData(),u=d.targetNodeId,c=d.sourceNodeId,f=ge(ge({},d),{id:"".concat(d.id,"__").concat(l),text:(s=d.text)===null||s===void 0?void 0:s.value});a.virtual&&o.deleteEdgeById(a.id);var h=o.dynamicGroup.getGroupByNodeId(u);h||(h=o.getNodeModelById(u));var v=o.dynamicGroup.getGroupByNodeId(c);v||(v=o.getNodeModelById(c)),e&&a.visible&&(r.children.has(c)||r.id===c?(f.startPoint=void 0,f.sourceNodeId=r.id):(f.endPoint=void 0,f.targetNodeId=r.id),(h.id!==r.id||v.id!==r.id)&&r.createVirtualEdge(f),a.visible=!1),!e&&!a.visible&&(h&&h.isGroup&&h.isCollapsed?(f.targetNodeId=h.id,f.endPoint=void 0,r.createVirtualEdge(f)):v&&v.isGroup&&v.isCollapsed?(f.sourceNodeId=v.id,f.startPoint=void 0,r.createVirtualEdge(f)):a.visible=!0)})},n.prototype.isAllowAppendIn=function(e){return!0},n.prototype.setAllowAppendChild=function(e){this.groupAddable=e},n.prototype.addChild=function(e){this.children.add(e);var t=this.getData();this.graphModel.eventCenter.emit("group:add-node",{data:t})},n.prototype.removeChild=function(e){this.children.delete(e);var t=this.getData();this.graphModel.eventCenter.emit("group:remove-node",{data:t})},n.prototype.toBack=function(){this.zIndex--},n.prototype.getResizeOutlineStyle=function(){var e=i.prototype.getResizeOutlineStyle.call(this);return e.stroke="none",e},n.prototype.getAnchorStyle=function(){var e=i.prototype.getAnchorStyle.call(this);return e.stroke="transparent",e.fill="transparent",e.hover&&(e.hover.fill="transparent",e.hover.stroke="transparent"),e},n.prototype.getAddableOutlineStyle=function(){return{stroke:"#feb663",strokeWidth:2,strokeDasharray:"4 4",fill:"transparent"}},Se([A],n.prototype,"isCollapsed",void 0),Se([A],n.prototype,"groupAddable",void 0),Se([A],n.prototype,"transformWithContainer",void 0),n})(we);var ct;(function(i){i.HORIZONTAL="horizontal",i.VERTICAL="vertical"})(ct||(ct={}));var nr=function(){var i=function(n,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])},i(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}}(),k=function(){return k=Object.assign||function(i){for(var n,e=1,t=arguments.length;e<t;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r])}return i},k.apply(this,arguments)},rr=function(i,n,e,t){var r=arguments.length,o=r<3?n:t===null?t=Object.getOwnPropertyDescriptor(n,e):t,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(i,n,e,t);else for(var l=i.length-1;l>=0;l--)(a=i[l])&&(o=(r<3?a(o):r>3?a(n,e,o):a(n,e))||o);return r>3&&o&&Object.defineProperty(n,e,o),o},ir=function(i,n){var e=typeof Symbol=="function"&&i[Symbol.iterator];if(!e)return i;var t=e.call(i),r,o=[],a;try{for(;(n===void 0||n-- >0)&&!(r=t.next()).done;)o.push(r.value)}catch(l){a={error:l}}finally{try{r&&!r.done&&(e=t.return)&&e.call(t)}finally{if(a)throw a.error}}return o},or=function(i){nr(n,i);function n(e){var t=i.call(this,e)||this;t.textRef=kt(),t.setHoverOn=function(){var s=t.props.element;s.isDragging||t.state.isHovered||(t.setState({isHovered:!0}),s.setHovered(!0))},t.setHoverOff=function(){var s=t.props.element;t.state.isHovered&&(t.setState({isHovered:!1}),s.setHovered(!1))},t.handleMouseDown=function(s){var d,u=t.props,c=u.label,f=u.graphModel,h=f.editConfigModel.nodeTextDraggable;((d=c.draggable)!==null&&d!==void 0?d:h)&&!t.state.isDragging&&(t.setState({isDragging:!0}),t.stepDrag.handleMouseDown(s))},t.handleDragging=function(s){var d=s.deltaX,u=s.deltaY,c=t.props,f=c.label,h=c.element,v=c.graphModel,p=v.transformModel,y=ir(p.fixDeltaXY(d,u),2),g=y[0],m=y[1],b=h.properties._label,w=b,O=Re(w,function(j){return j.id===f.id}),M=w[O];w[O]=k(k({},M),{x:M.x+g,y:M.y+m});var x=v.getElement(h.id);x==null||x.setProperty("_label",w),v.eventCenter.emit("label:drag",{data:f.getData(),model:f})},t.handleDragEnd=function(){t.setState({isDragging:!1})},t.handleDbClick=function(s){var d=t.props,u=d.label,c=d.element,f=d.graphModel;if(f.eventCenter.emit("label:dblclick",{data:u.getData(),e:s,model:c}),!u.editable){c.setSelected(!0);return}if(c.setSelected(),c.setElementState(De.TEXT_EDIT),t.setState({isEditing:!0}),t.textRef.current){t.textRef.current.contentEditable="true",t.textRef.current.focus();var h=document.createRange(),v=window.getSelection();h.selectNodeContents(t.textRef.current),h.collapse(!1),v==null||v.removeAllRanges(),v==null||v.addRange(h)}},t.handleBlur=function(s){var d=t.props,u=d.label,c=d.element,f=d.graphModel.eventCenter;f.emit("label:blur",{e:s,model:c,data:u.getData(),element:t.textRef.current}),t.setState({isDragging:!1,isHovered:!1})},t.reCalcLabelSize=function(){};var r=e.label,o=e.graphModel,a=o.gridSize,l=o.eventCenter;return t.stepDrag=new wt({onDragging:t.handleDragging,onDragEnd:t.handleDragEnd,step:a,eventType:"LABEL",model:r,eventCenter:l}),t.state={isEditing:!1,isHovered:!1,isDragging:!1},t}return n.prototype.componentDidMount=function(){var e=this,t=this.props,r=t.label,o=t.element,a=t.graphModel;a.eventCenter.on("blank:click,node:click,edge:click",function(){var l,s,d,u;if(e.state.isEditing){e.setState({isEditing:!1});var c=(s=(l=e.textRef.current)===null||l===void 0?void 0:l.innerText)!==null&&s!==void 0?s:"",f=(u=(d=e.textRef.current)===null||d===void 0?void 0:d.innerHTML)!==null&&u!==void 0?u:"",h=o.properties._label,v=h,p=Re(v,function(m){return m.id===r.id}),y=v[p];v[p]=k(k({},y),{value:c,content:f});var g=a.getElement(o.id);g==null||g.setProperty("_label",v),o.setElementState(De.DEFAULT)}e.textRef.current&&(e.textRef.current.contentEditable="false")})},n.prototype.componentDidUpdate=function(){},n.prototype.componentWillUnmount=function(){var e=this.props.graphModel;e.eventCenter.off("blank:click,node:click,edge:click")},n.prototype.render=function(){var e,t=this.props,r=t.label,o=t.element,a=t.graphModel,l=this.state,s=l.isDragging,d=l.isHovered,u=l.isEditing,c=a.transformModel,f=c.getTransformStyle().transform,h=r.id,v=r.x,p=r.y,y=r.zIndex,g=r.vertical,m=r.style,b=r.rotate,w=r.content,O=r.labelWidth,M=r.textOverflowMode,x=O??(o.BaseType==="node"?o.width-20:80),j={left:"".concat(v-x/2,"px"),top:"".concat(p-10,"px"),width:"".concat(x,"px"),height:"20px",zIndex:y??1,transform:b?"".concat(f," rotate(").concat(b,"deg)"):"".concat(f," rotate(").concat(g?-.25:0,"turn)")};return S("div",{id:"element-container-".concat(h),className:Le("lf-label-editor-container"),style:j,onMouseDown:this.handleMouseDown,onDblClick:this.handleDbClick,onBlur:this.handleBlur,onMouseEnter:this.setHoverOn,onMouseOver:this.setHoverOn,onMouseLeave:this.setHoverOff,children:S("div",{ref:this.textRef,id:"editor-container-".concat(h),className:Le("lf-label-editor",(e={"lf-label-editor-dragging":s,"lf-label-editor-editing":u,"lf-label-editor-hover":!u&&d},e["lf-label-editor-".concat(M)]=!u,e)),style:k({maxWidth:"".concat(x,"px"),width:"".concat(x,"px")},m),dangerouslySetInnerHTML:{__html:w}})})},n=rr([Mt],n),n}(xe),R=function(i,n,e,t){var r=arguments.length,o=r<3?n:t===null?t=Object.getOwnPropertyDescriptor(n,e):t,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(i,n,e,t);else for(var l=i.length-1;l>=0;l--)(a=i[l])&&(o=(r<3?a(o):r>3?a(n,e,o):a(n,e))||o);return r>3&&o&&Object.defineProperty(n,e,o),o},ar=en,lr=function(){function i(n,e,t){var r;this.type="label",this.content="",this.value="",this.style={},this.vertical=!1,this.editable=!0,this.draggable=!0,this.textOverflowMode="default",this.element=e,this.graphModel=t,this.id=(r=n.id)!==null&&r!==void 0?r:ar(),this.initLabelData(n)}return i.prototype.initLabelData=function(n){rn(this,n)},i.prototype.getData=function(){return{id:this.id,x:this.x,y:this.y,content:this.content,value:this.value,rotate:this.rotate,style:an(this.style),draggable:this.draggable,editable:this.editable,labelWidth:this.labelWidth,textOverflowMode:this.textOverflowMode,vertical:this.vertical}},R([A],i.prototype,"x",void 0),R([A],i.prototype,"y",void 0),R([A],i.prototype,"content",void 0),R([A],i.prototype,"value",void 0),R([A],i.prototype,"rotate",void 0),R([A],i.prototype,"style",void 0),R([A],i.prototype,"zIndex",void 0),R([A],i.prototype,"vertical",void 0),R([A],i.prototype,"editable",void 0),R([A],i.prototype,"draggable",void 0),R([A],i.prototype,"labelWidth",void 0),R([A],i.prototype,"textOverflowMode",void 0),i}(),ft={toolbar:{allowMultiParagraphSelection:!0,buttons:["bold","colorpicker","italic","underline","strikethrough","quote","justifyLeft","justifyCenter","justifyRight","justifyFull","superscript","subscript","orderedlist","unorderedlist","pre","removeFormat","outdent","indent","h2","h3"],standardizeSelectionStart:!1,updateOnEmptySelection:!1},placeholder:{text:"请输入内容",hideOnClick:!0},disableEditing:!0},pt=oe.extensions.button.extend({name:"colorpicker",tagNames:["mark"],contentDefault:"<b>Color</b>",aria:"Color Picker",action:"colorPicker",init:function(){var i=this;ze.init(),oe.extensions.button.prototype.init.call(this),this.colorPicker=new ln({parent:this.button,color:"#000",onDone:function(n){i.coloredText&&i.coloredText.isAppliedToSelection()&&i.coloredText.undoToSelection(),i.coloredText=ze.createClassApplier("colored",{elementTagName:"span",elementProperties:{style:{color:n.hex}},normalize:!0}),i.coloredText.toggleSelection(),i.base.checkContentChanged(),i.setInactive()}})},getButton:function(){return this.button},handleClick:function(){this.setActive(),this.colorPicker.show()},isAlreadyApplied:function(i){return i.nodeName.toLowerCase()==="mark"},isActive:function(){return this.button.classList.contains("medium-editor-button-active")},setInactive:function(){this.button.classList.remove("medium-editor-button-active")},setActive:function(){this.button.classList.add("medium-editor-button-active")}}),sr=function(){var i=function(n,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])},i(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}}(),dr=function(i,n,e,t){var r=arguments.length,o=r<3?n:t===null?t=Object.getOwnPropertyDescriptor(n,e):t,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(i,n,e,t);else for(var l=i.length-1;l>=0;l--)(a=i[l])&&(o=(r<3?a(o):r>3?a(n,e,o):a(n,e))||o);return r>3&&o&&Object.defineProperty(n,e,o),o},ht=function(i,n){var e=typeof Symbol=="function"&&i[Symbol.iterator];if(!e)return i;var t=e.call(i),r,o=[],a;try{for(;(n===void 0||n-- >0)&&!(r=t.next()).done;)o.push(r.value)}catch(l){a={error:l}}finally{try{r&&!r.done&&(e=t.return)&&e.call(t)}finally{if(a)throw a.error}}return o},vt=function(i,n,e){if(e||arguments.length===2)for(var t=0,r=n.length,o;t<r;t++)(o||!(t in n))&&(o||(o=Array.prototype.slice.call(n,0,t)),o[t]=n[t]);return i.concat(o||Array.prototype.slice.call(n))};(function(i){sr(n,i);function n(e){var t=i.call(this,e)||this;t.labelMap=new Map;var r=e.lf,o=e.graphModel;return t.lf=r,t.graphModel=o,t.state={tick:0},t}return n.prototype.componentDidMount=function(){var e=this,t=this.props.graphModel;this.editor=new oe(".lf-label-editor",Ie(ft,{autoLink:!0,extensions:{colorPicker:new pt}})),t.eventCenter.on("text:update,node:mousemove,node:resize,node:rotate,node:drag,label:drop,node:drop",function(){}),t.eventCenter.on("node:properties-change,node:properties-delete",function(){e.setState({tick:e.state.tick+1})})},n.prototype.componentDidUpdate=function(){var e;this.editor&&this.editor.elements.length>0?this.editor.addElements(".lf-label-editor"):((e=this.editor)===null||e===void 0||e.destroy(),this.editor=new oe(".lf-label-editor",Ie(ft,{autoLink:!0,extensions:{colorPicker:new pt}})))},n.prototype.componentWillUnmount=function(){var e;(e=this.editor)===null||e===void 0||e.destroy()},n.prototype.getLabels=function(){var e=this,t=this.props,r=t.lf.extension,o=t.graphModel,a=vt(vt([],ht(o.nodes),!1),ht(o.edges),!1),l=r.label;if(l){var s=[];return W(a,function(d){var u,c,f=d.getData(),h=(c=(u=f.properties)===null||u===void 0?void 0:u._label)!==null&&c!==void 0?c:[];W(h,function(v){var p=e.labelMap,y=new lr(v,d,o);p.set(y.id,y),s.push(S(or,{label:y,element:d,graphModel:o},y.id))})}),s}return null},n.prototype.render=function(){return S("foreignObject",{id:"lf-label-overlay",class:"lf-label-overlay",children:this.getLabels()})},n.toolName="label-edit-tool",n=dr([Mt],n),n})(xe);var ur=function(i,n){var e=typeof Symbol=="function"&&i[Symbol.iterator];if(!e)return i;var t=e.call(i),r,o=[],a;try{for(;(n===void 0||n-- >0)&&!(r=t.next()).done;)o.push(r.value)}catch(l){a={error:l}}finally{try{r&&!r.done&&(e=t.return)&&e.call(t)}finally{if(a)throw a.error}}return o},cr=function(i,n,e){if(e||arguments.length===2)for(var t=0,r=n.length,o;t<r;t++)(o||!(t in n))&&(o||(o=Array.prototype.slice.call(n,0,t)),o[t]=n[t]);return i.concat(o||Array.prototype.slice.call(n))},V="lf:defaultNodeMenu",K="lf:defaultEdgeMenu",J="lf:defaultGraphMenu",yt="lf:defaultSelectionMenu",Tr=function(){function i(n){var e=n.lf,t=this;this.__currentData=null,this.lf=e;var r=e.options.isSilentMode;r||(this.__menuDOM=document.createElement("ul"),this.menuTypeMap=new Map,this.init(),this.lf.setMenuConfig=function(o){t.setMenuConfig(o)},this.lf.addMenuConfig=function(o){t.addMenuConfig(o)},this.lf.setMenuByType=function(o){t.setMenuByType(o)})}return i.prototype.init=function(){var n=this,e,t,r,o,a=[{text:"删除",callback:function(d){n.lf.deleteNode(d.id)}},{text:"编辑文本",callback:function(d){n.lf.graphModel.editText(d.id)}},{text:"复制",callback:function(d){n.lf.cloneNode(d.id)}}];(e=this.menuTypeMap)===null||e===void 0||e.set(V,a);var l=[{text:"删除",callback:function(d){n.lf.deleteEdge(d.id)}},{text:"编辑文本",callback:function(d){n.lf.graphModel.editText(d.id)}}];(t=this.menuTypeMap)===null||t===void 0||t.set(K,l),(r=this.menuTypeMap)===null||r===void 0||r.set(J,[]);var s=[{text:"删除",callback:function(d){n.lf.clearSelectElements(),d.edges.forEach(function(u){return n.lf.deleteEdge(u.id)}),d.nodes.forEach(function(u){return n.lf.deleteNode(u.id)})}}];(o=this.menuTypeMap)===null||o===void 0||o.set(yt,s)},i.prototype.render=function(n,e){var t=this;n.options.isSilentMode||(this.__container=e,this.__currentData=null,this.__menuDOM&&(this.__menuDOM.className="lf-menu",e.appendChild(this.__menuDOM),this.__menuDOM.addEventListener("click",function(r){r.stopPropagation();for(var o=r.target;Array.from(o.classList).indexOf("lf-menu-item")===-1&&Array.from(o.classList).indexOf("lf-menu")===-1;)o=o==null?void 0:o.parentElement;Array.from(o.classList).indexOf("lf-menu-item")>-1?(o.onclickCallback(t.__currentData),t.__menuDOM&&(t.__menuDOM.style.display="none"),t.__currentData=null):console.warn("点击区域不在菜单项内，请检查代码！")},!0)),this.lf.on("node:contextmenu",function(r){var o,a,l=r.data,s=r.position,d=r.e,u=s.domOverlayPosition,c=u.x,f=u.y,h=l.id,v=t.lf.graphModel.getNodeModelById(h);if(v){var p=[],y=(o=t.menuTypeMap)===null||o===void 0?void 0:o.get(v.type);v&&v.menu&&Array.isArray(v.menu)?p=v.menu:y?p=y:p=(a=t.menuTypeMap)===null||a===void 0?void 0:a.get(V),t.__currentData=l,t.showMenu(c,f,p,{width:v.width,height:v.height,clientX:d.clientX,clientY:d.clientY})}}),this.lf.on("edge:contextmenu",function(r){var o,a,l,s=r.data,d=r.position,u=r.e,c=d.domOverlayPosition,f=c.x,h=c.y,v=s.id,p=t.lf.graphModel.getEdgeModelById(v);if(p){var y=[],g=(o=t.menuTypeMap)===null||o===void 0?void 0:o.get(p.type);p&&p.menu&&Array.isArray(p.menu)?y=p.menu:g?y=g:y=(l=(a=t.menuTypeMap)===null||a===void 0?void 0:a.get(K))!==null&&l!==void 0?l:[],t.__currentData=s,t.showMenu(f,h,y,{width:p.width,height:p.height,clientX:u.clientX,clientY:u.clientY})}}),this.lf.on("blank:contextmenu",function(r){var o,a,l=r.position,s=(a=(o=t.menuTypeMap)===null||o===void 0?void 0:o.get(J))!==null&&a!==void 0?a:[],d=l.domOverlayPosition,u=d.x,c=d.y;t.showMenu(u,c,s)}),this.lf.on("selection:contextmenu",function(r){var o,a=r.data,l=r.position,s=(o=t.menuTypeMap)===null||o===void 0?void 0:o.get(yt),d=l.domOverlayPosition,u=d.x,c=d.y;t.__currentData=a,t.showMenu(u,c,s)}),this.lf.on("node:mousedown",function(){t.__menuDOM.style.display="none"}),this.lf.on("edge:click",function(){t.__menuDOM.style.display="none"}),this.lf.on("blank:click",function(){t.__menuDOM.style.display="none"}))},i.prototype.destroy=function(){var n;this.__menuDOM&&((n=this===null||this===void 0?void 0:this.__container)===null||n===void 0||n.removeChild(this.__menuDOM),this.__menuDOM=void 0)},i.prototype.showMenu=function(n,e,t,r){if(!(!t||!t.length)){var o=this.__menuDOM;if(o){if(o.innerHTML="",o.append.apply(o,cr([],ur(this.__getMenuDom(t)),!1)),!o.children.length)return;if(o.style.display="block",!r){o.style.top="".concat(e,"px"),o.style.left="".concat(n,"px");return}var a=r.width,l=r.height,s=r.clientX,d=r.clientY,u=this.lf.graphModel,c=o.offsetWidth,f=!0,h=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,v=h-s,p=u.rootEl.getBoundingClientRect(),y=p.left+p.width;y<h&&(v=y-s),v<c&&(f=!1),f?o.style.left="".concat(n,"px"):o.style.left="".concat(n-a,"px");var g=o.offsetHeight,m=!0,b=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,w=b-d,O=p.top+p.height;O<b&&(w=O-d),w<g&&(m=!1),m?o.style.top="".concat(e,"px"):o.style.top="".concat(e-l,"px")}}},i.prototype.setMenuByType=function(n){var e,t=n.type,r=n.menu;!t||!r||(e=this.menuTypeMap)===null||e===void 0||e.set(t,r)},i.prototype.__getMenuDom=function(n){var e=[];return n&&n.length>0&&n.forEach(function(t){var r=document.createElement("li");if(t.className?r.className="lf-menu-item ".concat(t.className):r.className="lf-menu-item",t.icon===!0){var o=document.createElement("span");o.className="lf-menu-item-icon",r.appendChild(o)}var a=document.createElement("span");a.className="lf-menu-item-text",t.text&&(a.innerText=t.text),r.appendChild(a),r.onclickCallback=t.callback,e.push(r)}),e},i.prototype.setMenuConfig=function(n){var e,t,r;n&&(n.nodeMenu!==void 0&&((e=this.menuTypeMap)===null||e===void 0||e.set(V,n.nodeMenu?n.nodeMenu:[])),n.edgeMenu!==void 0&&((t=this.menuTypeMap)===null||t===void 0||t.set(K,n.edgeMenu?n.edgeMenu:[])),n.graphMenu!==void 0&&((r=this.menuTypeMap)===null||r===void 0||r.set(J,n.graphMenu?n.graphMenu:[])))},i.prototype.addMenuConfig=function(n){var e,t,r,o,a,l,s,d,u;if(n){if(Array.isArray(n.nodeMenu)){var c=(t=(e=this.menuTypeMap)===null||e===void 0?void 0:e.get(V))!==null&&t!==void 0?t:[];(r=this.menuTypeMap)===null||r===void 0||r.set(V,c.concat(n.nodeMenu))}if(Array.isArray(n.edgeMenu)){var c=(a=(o=this.menuTypeMap)===null||o===void 0?void 0:o.get(K))!==null&&a!==void 0?a:[];(l=this.menuTypeMap)===null||l===void 0||l.set(K,c.concat(n.edgeMenu))}if(Array.isArray(n.graphMenu)){var c=(d=(s=this.menuTypeMap)===null||s===void 0?void 0:s.get(J))!==null&&d!==void 0?d:[];(u=this.menuTypeMap)===null||u===void 0||u.set(J,c.concat(n.graphMenu))}}},i.prototype.changeMenuItem=function(n,e){if(n==="add")this.addMenuConfig(e);else if(n==="reset")this.setMenuConfig(e);else throw new Error("The first parameter of changeMenuConfig should be 'add' or 'reset'")},i.pluginName="menu",i}(),jr=function(){function i(n){var e=n.lf,t=this;this.lf=e,this.lf.setPatternItems=function(r){t.setPatternItems(r)}}return i.prototype.render=function(n,e){var t=this;if(this.destroy(),!this.shapeList||this.shapeList.length===0){this.domContainer=e;return}this.panelEl=document.createElement("div"),this.panelEl.className="lf-dndpanel",this.shapeList.forEach(function(r){var o;(o=t.panelEl)===null||o===void 0||o.appendChild(t.createDndItem(r))}),e.appendChild(this.panelEl),this.domContainer=e},i.prototype.destroy=function(){this.domContainer&&this.panelEl&&this.domContainer.contains(this.panelEl)&&this.domContainer.removeChild(this.panelEl)},i.prototype.setPatternItems=function(n){this.shapeList=n,this.domContainer&&this.render(this.lf,this.domContainer)},i.prototype.createDndItem=function(n){var e=this,t=document.createElement("div");t.className=n.className?"lf-dnd-item ".concat(n.className):"lf-dnd-item";var r=document.createElement("div");if(r.className="lf-dnd-shape",n.icon&&(r.style.backgroundImage="url(".concat(n.icon,")")),t.appendChild(r),n.label){var o=document.createElement("div");o.innerText=n.label,o.className="lf-dnd-text",t.appendChild(o)}return n.disabled?(t.classList.add("disabled"),t.onmousedown=function(){n.callback&&n.callback(e.lf,e.domContainer)},t):(t.onmousedown=function(){n.type&&e.lf.dnd.startDrag({type:n.type,properties:n.properties,text:n.text}),n.callback&&n.callback(e.lf,e.domContainer)},t.ondblclick=function(a){e.lf.graphModel.eventCenter.emit("dnd:panel-dbclick",{e:a,data:n})},t.onclick=function(a){e.lf.graphModel.eventCenter.emit("dnd:panel-click",{e:a,data:n})},t.oncontextmenu=function(a){e.lf.graphModel.eventCenter.emit("dnd:panel-contextmenu",{e:a,data:n})},t)},i.pluginName="dndPanel",i}(),Dr=function(){function i(n){var e=n.lf,t=this;this.disabled=!0,this.isDefaultStopMoveGraph=!1,this.isWholeNode=!0,this.isWholeEdge=!0,this.draw=function(o){var a=t.lf.getPointByClient(o.clientX,o.clientY).domOverlayPosition,l=a.x,s=a.y;if(t.endPoint={x:l,y:s},t.startPoint){var d=t.startPoint,u=d.x,c=d.y,f=u,h=c,v=l-u,p=s-c;l<u&&(f=l,v=u-l),s<c&&(h=s,p=c-s),t.wrapper&&(t.wrapper.style.left="".concat(f,"px"),t.wrapper.style.top="".concat(h,"px"),t.wrapper.style.width="".concat(v,"px"),t.wrapper.style.height="".concat(p,"px"))}},this.drawOff=function(){var o;if(document.removeEventListener("mousemove",t.draw),document.removeEventListener("mouseup",t.drawOff),t.wrapper&&(t.wrapper.oncontextmenu=null,(o=t.container)===null||o===void 0||o.removeChild(t.wrapper)),t.startPoint&&t.endPoint){var a=t.startPoint,l=a.x,s=a.y,d=t.endPoint,u=d.x,c=d.y,f=[Math.min(l,u),Math.min(s,c)],h=[Math.max(l,u),Math.max(s,c)];if(t.lf.emit("selection:selected-area",{topLeft:f,bottomRight:h}),Math.abs(u-l)<10&&Math.abs(c-s)<10)return;var v=t.lf.graphModel.getAreaElement(f,h,t.isWholeEdge,t.isWholeNode,!0),p=t.lf.graphModel,y=p.dynamicGroup,g=p.group;v.forEach(function(m){(!g||!g.getNodeGroup(m.id))&&t.lf.selectElementById(m.id,!0),(!y||!y.getGroupByNodeId(m.id))&&t.lf.selectElementById(m.id,!0)}),t.lf.emit("selection:selected",{elements:v,leftTopPoint:f,rightBottomPoint:h})}},this.lf=e;var r=e.getEditConfig().stopMoveGraph;this.isDefaultStopMoveGraph=r,e.openSelectionSelect=function(){t.openSelectionSelect()},e.closeSelectionSelect=function(){t.closeSelectionSelect()}}return i.prototype.render=function(n,e){var t=this;this.container=e,n.on("blank:mousedown",function(r){var o=r.e,a=n.getEditConfig();if(!(!a.stopMoveGraph||t.disabled)){var l=o.button===2;if(!l){var s=n.getPointByClient(o.clientX,o.clientY).domOverlayPosition,d=s.x,u=s.y;t.startPoint={x:d,y:u},t.endPoint={x:d,y:u};var c=document.createElement("div");c.className="lf-selection-select",c.oncontextmenu=function(h){h.preventDefault()},c.style.top="".concat(t.startPoint.y,"px"),c.style.left="".concat(t.startPoint.x,"px"),e.appendChild(c),t.wrapper=c,document.addEventListener("mousemove",t.draw),document.addEventListener("mouseup",t.drawOff)}}})},i.prototype.setSelectionSense=function(n,e){n===void 0&&(n=!0),e===void 0&&(e=!0),this.isWholeEdge=n,this.isWholeNode=e},i.prototype.openSelectionSelect=function(){var n=this.lf.getEditConfig().stopMoveGraph;n||(this.isDefaultStopMoveGraph=!1,this.lf.updateEditConfig({stopMoveGraph:!0})),this.open()},i.prototype.closeSelectionSelect=function(){this.isDefaultStopMoveGraph||this.lf.updateEditConfig({stopMoveGraph:!1}),this.close()},i.prototype.open=function(){this.disabled=!1},i.prototype.close=function(){this.disabled=!0},i.pluginName="selectionSelect",i}();var Ft=function(){var i=function(n,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])},i(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}}(),G=function(){return G=Object.assign||function(i){for(var n,e=1,t=arguments.length;e<t;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r])}return i},G.apply(this,arguments)},ee=function(i,n){var e=typeof Symbol=="function"&&i[Symbol.iterator];if(!e)return i;var t=e.call(i),r,o=[],a;try{for(;(n===void 0||n-- >0)&&!(r=t.next()).done;)o.push(r.value)}catch(l){a={error:l}}finally{try{r&&!r.done&&(e=t.return)&&e.call(t)}finally{if(a)throw a.error}}return o},fr={tr:"tl",lb:"tl",tl:"tr",rb:"tr",br:"bl",lt:"bl",bl:"br",rt:"br"};function pr(i){for(var n=i,e=1;e<n.length-1;){var t=ee(n[e-1],2),r=t[0],o=t[1],a=ee(n[e],2),l=a[0],s=a[1],d=ee(n[e+1],2),u=d[0],c=d[1];r===l&&l===u||o===s&&s===c?n.splice(e,1):e++}return n}function hr(i,n,e,t){var r=[i[0],i[1]],o=[i[0],i[1]];switch(e){case"tl":return n==="tr"?(r[1]+=t,o[0]+=t):n==="lb"&&(r[0]+=t,o[1]+=t),[r,o];case"tr":return n==="tl"?(r[1]+=t,o[0]-=t):n==="rb"&&(r[0]-=t,o[1]+=t),[r,o];case"bl":return n==="br"?(r[1]-=t,o[0]+=t):n==="lt"&&(r[0]+=t,o[1]-=t),[r,o];case"br":return n==="bl"?(r[1]-=t,o[0]-=t):n==="rt"&&(r[0]-=t,o[1]-=t),[r,o];default:return[]}}function vr(i,n,e,t){var r,o="",a="";i[0]===n[0]?o=i[1]>n[1]?"t":"b":i[1]===n[1]&&(o=i[0]>n[0]?"l":"r"),n[0]===e[0]?a=n[1]>e[1]?"t":"b":n[1]===e[1]&&(a=n[0]>e[0]?"l":"r");var l=Math.min(Math.hypot(n[0]-i[0],n[1]-i[1])/2,Math.hypot(e[0]-n[0],e[1]-n[1])/2,t)||1/5*t,s="".concat(o).concat(a),d=fr[s]||"-",u="L ".concat(i[0]," ").concat(i[1]);if(d==="-")u+="L ".concat(n[0]," ").concat(n[1]," L ").concat(e[0]," ").concat(e[1]);else{var c=ee(hr(n,s,d,l),2),f=c[0],h=c[1];f&&h&&(u+="L ".concat(f[0]," ").concat(f[1]," Q ").concat(n[0]," ").concat(n[1]," ").concat(h[0]," ").concat(h[1]),r=ee(h,2),n[0]=r[0],n[1]=r[1])}return u}function yr(i,n){var e=0,t="";if(i.length===2)t+="M".concat(i[e][0]," ").concat(i[e++][1]," L ").concat(i[e][0]," ").concat(i[e][1]);else{for(t+="M".concat(i[e][0]," ").concat(i[e++][1]);e+1<i.length;){var r=i[e-1],o=i[e],a=i[e+++1];t+=vr(r,o,a,n)}t+="L ".concat(i[e][0]," ").concat(i[e][1])}return t}(function(i){Ft(n,i);function n(){return i!==null&&i.apply(this,arguments)||this}return n.prototype.getEdge=function(){var e=this.props.model,t=e.points,r=e.isAnimation,o=e.arrowConfig,a=e.radius,l=a===void 0?5:a,s=e.getEdgeStyle(),d=e.getEdgeAnimationStyle(),u=pr(t.split(" ").map(function(h){return h.split(",").map(function(v){return+v})})),c=yr(u,l),f=G(G(G({style:r?d:{}},s),o),{fill:"none"});return _("path",G({d:c},f))},n})(Te);(function(i){Ft(n,i);function n(){return i!==null&&i.apply(this,arguments)||this}return n})(Ce);var Bt=function(){var i=function(n,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])},i(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}}(),me=function(){return me=Object.assign||function(i){for(var n,e=1,t=arguments.length;e<t;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r])}return i},me.apply(this,arguments)},gr=function(i,n){var e=typeof Symbol=="function"&&i[Symbol.iterator];if(!e)return i;var t=e.call(i),r,o=[],a;try{for(;(n===void 0||n-- >0)&&!(r=t.next()).done;)o.push(r.value)}catch(l){a={error:l}}finally{try{r&&!r.done&&(e=t.return)&&e.call(t)}finally{if(a)throw a.error}}return o},mr=function(i,n,e){if(e||arguments.length===2)for(var t=0,r=n.length,o;t<r;t++)(o||!(t in n))&&(o||(o=Array.prototype.slice.call(n,0,t)),o[t]=n[t]);return i.concat(o||Array.prototype.slice.call(n))},_r=function(i){Bt(n,i);function n(){return i!==null&&i.apply(this,arguments)||this}return n.prototype.getLabelShape=function(){var e=this.props.model,t=e.id,r=e.x,o=e.y,a=e.width,l=e.height,s=e.properties,d=this.props.model.getNodeStyle();return _("svg",{x:r-a/2,y:o-l/2,width:50,height:24,style:"z-index: 0; background: none; overflow: auto;"},[s.labelText?_("text",{x:0,y:-5,fontSize:"16px",fill:d.stroke},s.labelText):"",s.disabledDelete?"":_("text",{x:s.labelText?50:0,y:-5,fontSize:"24px",cursor:"pointer",fill:d.stroke,onclick:this.handleCustomDeleteIconClick.bind(this,t)},"x")])},n.prototype.getShape=function(){var e=this.props.model,t=e.x,r=e.y,o=e.width,a=e.height,l=e.id,s=this.props.model.getNodeStyle();return _("g",{},[_("rect",me(me({},s),{x:t-o/2,y:r-a/2,width:o,height:a,id:l})),this.getLabelShape()])},n.prototype.toFront=function(){},n.prototype.handleCustomDeleteIconClick=function(e){var t=this.props.graphModel;t.deleteNode(e)},n}(xt),xr=function(i){Bt(n,i);function n(){var e=i.apply(this,mr([],gr(arguments),!1))||this;return e.d=10,e}return n.prototype.initNodeData=function(e){e.text={value:"",x:e.x,y:e.y,draggable:!1,editable:!1},i.prototype.initNodeData.call(this,e),this.zIndex=0,this.draggable=!0},n.prototype.setAttributes=function(){var e=this,t;this.points=[],((t=this.properties)===null||t===void 0?void 0:t.node_selection_ids).length>1&&setTimeout(function(){var r;e.updatePointsByNodes(((r=e.properties)===null||r===void 0?void 0:r.node_selection_ids)||[])})},n.prototype.getNodeStyle=function(){var e=i.prototype.getNodeStyle.call(this);return e.stroke=this.properties.strokeColor||"#008000",e.strokeDasharray="10 5",e},n.prototype.getDefaultAnchor=function(){return[]},n.prototype.updatePoints=function(e){this.points=e},n.prototype.updateCoordinate=function(e){var t=e.x,r=e.y;this.x=t,this.y=r},n.prototype.updatePointsByNodes=function(e){var t=this,r=[],o=1/0,a=1/0,l=-1/0,s=-1/0;e.forEach(function(d){var u=t.graphModel.getNodeModelById(d);if(u){var c=u.width,f=u.height,h=u.x,v=u.y;o=Math.min(o,h-c/2-t.d),a=Math.min(a,v-f/2-t.d),l=Math.max(l,h+c/2+t.d),s=Math.max(s,v+f/2+t.d)}}),r.push([o,a],[l,a],[l,s],[o,s]),![o,a,l,s].some(function(d){return Math.abs(d)===1/0})&&(this.updatePoints(r),this.updateCoordinate({x:(l+o)/2,y:(s+a)/2}))},n}(_t);(function(){function i(n){var e=n.lf;this.selectNodes=[],this.d=10,e.register({type:"node-selection",view:_r,model:xr})}return Object.defineProperty(i.prototype,"selectNodesIds",{get:function(){return this.selectNodes.map(function(n){return n.id})},enumerable:!1,configurable:!0}),i.prototype.addNodeSelection=function(){var n=this.lf.addNode({type:"node-selection",text:"",properties:{node_selection_ids:this.selectNodesIds}});n.updatePointsByNodes(this.selectNodesIds)},i.prototype.updateNodeSelection=function(){var n=this.getNodeSelection();n&&(this.lf.setProperties(n.id,{node_selection_ids:this.selectNodesIds}),this.lf.getNodeModelById(n.id).updatePointsByNodes(this.selectNodesIds))},i.prototype.getNodeSelection=function(){var n=this,e=this.selectNodesIds,t=this.lf.getGraphRawData(),r=e.filter(function(o){return o!==n.currentClickNode.id});return t.nodes.find(function(o){if(o.type==="node-selection"){var a=on(o,"properties.node_selection_ids",[]);return r.every(function(l){return a.includes(l)})}return!1})},i.prototype.render=function(n){var e=this;this.lf=n,n.on("node:click",function(t){if(!(!t.e.shiftKey||t.data.type==="node-selection")){e.currentClickNode=t.data;var r=!1;e.selectNodesIds.includes(t.data.id)&&(e.lf.getNodeModelById(t.data.id).setSelected(!1),r=!0);var o=n.getSelectElements(!0).nodes;e.selectNodes=o,e.selectNodes.length===1?r?e.updateNodeSelection():e.addNodeSelection():e.selectNodes.length>1&&e.updateNodeSelection()}}),n.graphModel.addNodeMoveRules(function(t,r,o){if(t.type==="node-selection"){var a=t.properties.node_selection_ids;return n.graphModel.moveNodes(a,r,o,!0),!0}return!0})},i.pluginName="node-selection",i})();var wr=function(){var i=function(n,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])},i(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}}(),_e=function(){return _e=Object.assign||function(i){for(var n,e=1,t=arguments.length;e<t;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r])}return i},_e.apply(this,arguments)};(function(i){wr(n,i);function n(){return i!==null&&i.apply(this,arguments)||this}return n.prototype.getLabelShape=function(){var e=this.props.model,t=e.x,r=e.y,o=e.width,a=e.height,l=e.properties;return _("text",{x:t-o/2+5,y:r-a/2+16,fontSize:12,fill:"blue"},l.moreText)},n.prototype.getShape=function(){var e=this.props.model,t=e.x,r=e.y,o=e.width,a=e.height,l=this.props.model.getNodeStyle();return _("g",{},[_("rect",_e(_e({},l),{fill:"#FFFFFF",x:t-o/2,y:r-a/2})),this.getLabelShape()])},n})(te);export{jr as D,Tr as M,Dr as S};
