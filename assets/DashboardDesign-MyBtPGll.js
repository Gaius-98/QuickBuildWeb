import{u as H,c as ue,a as ee}from"./dashboardDesign-CkkLIFs-.js";import{_ as de}from"./CodeEditor.vue_vue_type_script_setup_true_name_EvCode_lang-D5LKvrgb.js";import{s as B}from"./nodemodule-pinia@2.1.7_typescript@5.4.2_vue@3.4.21-DRg4DShQ.js";import{M as te,F as J,h as K,I as ae,B as oe,Y as le,U as me,V as ce,G as ve,e as ne,W as _e,a as fe}from"./nodemodule-ant-design-vue@4.1.2_vue@3.4.21-D4V-KPiA.js";import{a4 as A,P as j}from"./nodemodule-@ant-design_icons-vue@7.0.1_vue@3.4.21-CO80cFpd.js";import{d as E,K as h,M as f,c as e,F as V,O as z,aI as a,G as O,ar as ye,aq as ge,L as c,m as be,a2 as q,N as he,b as G,V as xe,ak as Se,au as Y,y as Ce,z as ke}from"./nodemodule-@vue_runtime-core@3.4.21-Cnn673wu.js";import{r as _,u as i,x as se}from"./nodemodule-@vue_reactivity@3.4.21-DbkE7Gi6.js";import{n as re,O as De,l as we}from"./nodemodule-@vue_shared@3.4.21-Ctf17_ps.js";import{_ as F,c as W}from"./main-Ch5DcOKu.js";import{_ as Ue}from"./ConfigForm.vue_vue_type_script_setup_true_lang-DyibkxcF.js";import{S as Ie}from"./SchemaForm-D3orP-C7.js";import{w as Q}from"./nodemodule-@vue_runtime-dom@3.4.21-CDjXREoQ.js";import"./nodemodule-js-cookie@3.0.5-Cz0CWeBA.js";import"./dashboard-BwkU-ECm.js";import"./DynamicConfig-Bvc-VGnT.js";import"./nodemodule-lodash-es@4.17.21-DcfALcKD.js";import"./nodemodule-html2canvas@1.4.1-Cc_bx5YD.js";import"./nodemodule-vue-codemirror@6.1.1_codemirror@6.0.1_vue@3.4.21-Bq8cZfR3.js";import"./nodemodule-codemirror@6.0.1-Bz5Rqezr.js";import"./nodemodule-@codemirror_view@6.36.8-B6Z_C-qt.js";import"./nodemodule-@codemirror_state@6.5.2-CeTbMir1.js";import"./nodemodule-@marijn_find-cluster-break@1.0.2-DXwl3gUT.js";import"./nodemodule-style-mod@4.1.2-Bc2inJdb.js";import"./nodemodule-w3c-keyname@2.2.8-Vcq4gwWv.js";import"./nodemodule-@codemirror_language@6.11.0-B1CABpZA.js";import"./nodemodule-@lezer_common@1.2.3-DJDOv6L0.js";import"./nodemodule-@lezer_highlight@1.2.1-GwqidMBt.js";import"./nodemodule-@codemirror_commands@6.8.1-DuK1gsD8.js";import"./nodemodule-@codemirror_search@6.5.11-Dlx77ofC.js";import"./nodemodule-crelt@1.0.6-C8TCjufn.js";import"./nodemodule-@codemirror_autocomplete@6.18.6-BkBYzrUm.js";import"./nodemodule-@codemirror_lint@6.8.5-DUOWSouu.js";import"./nodemodule-@codemirror_lang-javascript@6.2.2-kmhBjvJk.js";import"./nodemodule-@lezer_javascript@1.5.1-DGDtd2DH.js";import"./nodemodule-@lezer_lr@1.4.2-CXohaufN.js";import"./nodemodule-@uiw_codemirror-theme-vscode@4.23.6_@codemirror_language@6.11.0_@codemirror_state@6.5.2_@codemirror_view@6.36.8-DmLrXduT.js";import"./nodemodule-@babel_runtime@7.27.1-Bq4_u9L9.js";import"./nodemodule-@uiw_codemirror-themes@4.23.6_@codemirror_language@6.11.0_@codemirror_state@6.5.2_@codemirror_view@6.36.8-CCcrmnXF.js";import"./nodemodule-resize-observer-polyfill@1.5.1-B1PUzC5B.js";import"./nodemodule-dayjs@1.11.13-B6I98uus.js";import"./nodemodule-classnames@2.5.1-BK5ccKcQ.js";import"./nodemodule-@ctrl_tinycolor@3.6.1-DOFZgDuz.js";import"./nodemodule-@ant-design_colors@6.0.0-CBJ--Aym.js";import"./nodemodule-throttle-debounce@5.0.2-CUWDS_la.js";import"./nodemodule-async-validator@4.2.5-9PlIezaS.js";import"./nodemodule-scroll-into-view-if-needed@2.2.31-CLVC0ehY.js";import"./nodemodule-compute-scroll-into-view@1.0.20-1gs_hJI2.js";import"./nodemodule-vue-types@3.0.2_vue@3.4.21-CF28atMM.js";import"./nodemodule-dom-align@1.12.4-CRCehRfe.js";import"./nodemodule-@emotion_hash@0.9.2-WldOFDRm.js";import"./nodemodule-@emotion_unitless@0.8.1-sScrWPmR.js";import"./nodemodule-stylis@4.3.6-D5iaQeiq.js";import"./nodemodule-@ant-design_icons-svg@4.4.2-C9VH68wD.js";/* empty css                                       */import"./nodemodule-axios@1.6.8-BZ84_VUH.js";import"./nodemodule-vue-router@4.3.0_vue@3.4.21-BC_007Jj.js";import"./nodemodule-@vueuse_core@10.9.0_vue@3.4.21-CS6n5tIH.js";import"./nodemodule-@vueuse_shared@10.9.0_vue@3.4.21-IMP1eStj.js";import"./nodemodule-gaius-utils@1.1.8_@types_node@20.11.28_typescript@5.4.2_vite@5.1.6-LqpbgJb2.js";import"./nodemodule-drag-grid-layout-v3@0.0.15_@types_node@20.11.28_typescript@5.4.2_vite@5.1.6-CKjsc2SR.js";import"./nodemodule-echarts@5.5.1-D0X1tymK.js";import"./nodemodule-tslib@2.3.0-BDyQ-Jie.js";import"./nodemodule-zrender@5.6.0-BXroVW6P.js";import"./nodemodule-uuid@9.0.1-CtRu48qb.js";/* empty css                   */const Ne=x=>(ye("data-v-00532e9e"),x=x(),ge(),x),$e={class:"material-area"},qe={class:"material-layout-area"},Me=Ne(()=>f("div",{class:"title"},"内置组件",-1)),Te={class:"content"},Le=["data-material"],Oe={class:"material-label"},Pe={style:{height:"650px"}},Ve={style:{height:"80px","overflow-y":"auto"}},Be={style:{height:"200px","overflow-y":"auto"}},ze=E({__name:"MaterialArea",setup(x){const C=H(),{customModules:k,customComps:U}=B(C),{onAddModules:u}=C,M=_({internalComp:ue,customComp:[]}),d=r=>{var s,o;const t=r.target;(s=r.dataTransfer)==null||s.setData("material",t.dataset.material),(o=r.dataTransfer)==null||o.setData("material-type",t.dataset.materialType)},y=_(!1);_({title:"element",package:"element-plus",version:"2.9.2",exportName:"ElementPlus",urls:["https://cdn.jsdelivr.net/npm/element-plus@2.9.2/dist/index.full.min.js","https://cdn.jsdelivr.net/npm/element-plus@2.9.2/dist/index.min.css"],children:[{componentName:"ElEmpty",exportName:"ElEmpty",id:"1",schema:`{
    "description": {
        "type": "input",
        "label": "描述"
    }

      }`}]});const l=_({}),g=()=>{y.value=!1},I=()=>{u(l.value),g()},D=()=>{l.value.children.push({componentName:"",exportName:"",id:new Date().getTime().toString()})},$=r=>{const t=l.value.children.findIndex(s=>s.id==r.id);t!=-1&&l.value.children.splice(t,1)},m=()=>{l.value.urls.push("")},p=r=>{const t=l.value.urls.findIndex(s=>s==r);t!=-1&&l.value.urls.splice(t,1)};return(r,t)=>{const s=ae,o=K,S=oe,N=le,w=de,R=J,T=te;return c(),h("div",$e,[f("div",qe,[Me,f("div",Te,[(c(!0),h(V,null,z(M.value.internalComp,n=>(c(),h("div",{key:n.name,draggable:"true",onDragstart:d,"data-material":n.name,"data-material-type":"internal",class:"material-item"},[f("span",{class:re(["iconfont material-icon",n.icon])},null,2),f("span",Oe,De(n.label),1)],40,Le))),128))])]),e(T,{title:"添加自定义组件",width:"800px",open:y.value,"onUpdate:open":t[4]||(t[4]=n=>y.value=n),onOk:I,onCancel:g},{default:a(()=>[f("div",Pe,[e(R,{model:l.value,"label-col":{style:{width:"150px"}}},{default:a(()=>[e(o,{label:"名称"},{default:a(()=>[e(s,{value:l.value.title,"onUpdate:value":t[0]||(t[0]=n=>l.value.title=n)},null,8,["value"])]),_:1}),e(o,{label:"组件库名称"},{default:a(()=>[e(s,{value:l.value.package,"onUpdate:value":t[1]||(t[1]=n=>l.value.package=n)},null,8,["value"])]),_:1}),e(o,{label:"版本"},{default:a(()=>[e(s,{value:l.value.version,"onUpdate:value":t[2]||(t[2]=n=>l.value.version=n)},null,8,["value"])]),_:1}),e(o,{label:"导出名称"},{default:a(()=>[e(s,{value:l.value.exportName,"onUpdate:value":t[3]||(t[3]=n=>l.value.exportName=n)},null,8,["value"])]),_:1}),e(o,{label:"CDN地址"},{default:a(()=>[f("div",Ve,[(c(!0),h(V,null,z(l.value.urls,(n,P)=>(c(),h("div",{key:n,style:{display:"flex","margin-bottom":"8px"},align:"baseline"},[e(s,{value:l.value.urls[P],"onUpdate:value":b=>l.value.urls[P]=b},null,8,["value","onUpdate:value"]),e(i(A),{onClick:b=>p(n),style:{padding:"0 10px"}},null,8,["onClick"])]))),128))]),e(o,null,{default:a(()=>[e(S,{type:"dashed",block:"",onClick:m},{default:a(()=>[e(i(j)),O(" 增加CDN地址 ")]),_:1})]),_:1})]),_:1}),e(o,{label:"子组件"},{default:a(()=>[f("div",Be,[(c(!0),h(V,null,z(l.value.children,(n,P)=>(c(),h("div",{key:n.id,style:{display:"flex","margin-bottom":"8px","border-bottom":"1px solid #ccc"},align:"baseline"},[e(N,null,{default:a(()=>[f("div",null,[e(N,null,{default:a(()=>[e(o,{label:"组件名",rules:{required:!0}},{default:a(()=>[e(s,{value:n.componentName,"onUpdate:value":b=>n.componentName=b},null,8,["value","onUpdate:value"])]),_:2},1024),e(o,{label:"导出名称",rules:{required:!0}},{default:a(()=>[e(s,{value:n.exportName,"onUpdate:value":b=>n.exportName=b},null,8,["value","onUpdate:value"])]),_:2},1024)]),_:2},1024),e(o,{label:"配置Schema",rules:{required:!0}},{default:a(()=>[e(w,{value:n.schema,"onUpdate:value":b=>n.schema=b,theme:"light",height:"110"},null,8,["value","onUpdate:value"])]),_:2},1024)]),e(i(A),{onClick:b=>$(n)},null,8,["onClick"])]),_:2},1024)]))),128))]),e(o,null,{default:a(()=>[e(S,{type:"dashed",block:"",onClick:D},{default:a(()=>[e(i(j)),O(" 增加子组件 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])])]),_:1},8,["open"])])}}}),Ee=F(ze,[["__scopeId","data-v-00532e9e"]]),Fe={text:{type:"input",label:"文本内容"}},Re={src:{type:"input",label:"图片地址"}},We={src:{type:"input",label:"页面地址"}},Ae=x=>({dataset:{type:"select",label:"数据集",options:x},dimension:{type:"select",label:"维度",options:[],mode:"multiple"},target:{type:"select",label:"指标",options:[],mode:"multiple"}}),je={"qb-text":Fe,"qb-image":Re,"qb-iframe":We,"qb-chart":Ae},Ge={title1:{type:"divider",label:"标题",component:{title:"标题"},formLayout:!1},"option.title.show":{type:"switch",label:"显示标题"},"option.title.text":{type:"string",label:"标题文本"},"option.title.link":{type:"string",label:"文本超链接"},title2:{type:"divider",label:"布局",component:{title:"布局"},formLayout:!1},"option.grid.left":{type:"string",label:"左边距"},"option.grid.right":{type:"string",label:"右边距"},"option.grid.top":{type:"string",label:"上边距"},"option.grid.bottom":{type:"string",label:"下边距"},title3:{type:"divider",label:"图例",component:{title:"图例"},formLayout:!1},"option.legend.show":{type:"switch",label:"显示图例"},"option.legend.type":{type:"select",label:"图例类型",component:{dataSource:[{label:"普通图例",value:"plain"},{label:"翻页图例",value:"scroll"}]}},"option.legend.orient":{type:"select",label:"图例朝向",component:{dataSource:[{value:"horizontal",label:"横向"},{value:"vertical",label:"纵向"}]}},title4:{type:"divider",label:"边框",component:{title:"边框"},formLayout:!1},borderWidth:{type:"string",label:"边框宽度",tooltip:"请注明单位，一般为：px"},borderColor:{type:"string",label:"边框颜色",component:{name:"color-picker"}},borderStyle:{type:"radio",label:"边框样式",component:{dataSource:[{label:"无边框",value:"none"},{label:"虚线",value:"dashed"},{label:"实线",value:"solid"}],buttonStyle:"solid"}},borderRadius:{type:"string",label:"边框圆角",tooltip:"请注明单位，可以为%或者px"}},X={title1:{type:"divider",label:"布局",component:{title:"布局"},formLayout:!1},paddingLeft:{type:"string",label:"左边距",tooltip:"请注明单位，一般为：px"},paddingTop:{type:"string",label:"上边距",tooltip:"请注明单位，一般为：px"},paddingRight:{type:"string",label:"右边距",tooltip:"请注明单位，一般为：px"},paddingBottom:{type:"string",label:"下边距",tooltip:"请注明单位，一般为：px"},title2:{type:"divider",label:"背景",component:{title:"背景"},formLayout:!1},backgroundColor:{type:"string",label:"背景色",component:{name:"color-picker"}},title3:{type:"divider",label:"边框",component:{title:"边框"},formLayout:!1},borderWidth:{type:"string",label:"边框宽度",tooltip:"请注明单位，一般为：px"},borderColor:{type:"string",label:"边框颜色",component:{name:"color-picker"}},borderStyle:{type:"radio",label:"边框样式",component:{dataSource:[{label:"无边框",value:"none"},{label:"虚线",value:"dashed"},{label:"实线",value:"solid"}],buttonStyle:"solid"}},borderRadius:{type:"string",label:"边框圆角",tooltip:"请注明单位，可以为%或者px"}},He={class:"material-cfg"},Je=E({__name:"MaterialCfg",setup(x){const C=H(),{customCompSchema:k}=B(C),U=ee(),{curComp:u}=B(U),{updateItem:M}=U,d=_({}),y=_({}),l=_({}),g=_({layout:{labelAlign:"left",layout:"horizontal",labelCol:{style:{width:"100px"}}},properties:X}),I=_([]);W.getDatasetDict().then(m=>{const{code:p,data:r,msg:t}=m;p==200&&(I.value=r)});const D=_([]),$=()=>{d.value.dimension=[],d.value.target=[],W.getFieldByDatasetId(d.value.dataset).then(m=>{const{code:p,data:r,msg:t}=m;p==200&&(D.value=r.map(s=>({value:s,label:s})))})};return be(()=>u.value.id,()=>{var m;g.value.properties=X,((m=u.value)==null?void 0:m.type)==="custom"?k.value&&(y.value=JSON.parse(k.value[u.value.component])):u.value.component=="qb-chart"?g.value.properties=Ge:y.value=je[u.value.component],d.value=u.value.props,u.value.component=="qb-chart"&&W.getFieldByDatasetId(d.value.dataset).then(p=>{const{code:r,data:t,msg:s}=p;r==200&&(D.value=t.map(o=>({value:o,label:o})))}),l.value=u.value.style},{deep:!0}),(m,p)=>{const r=ve,t=ne,s=K,o=J,S=ce,N=me;return c(),h("div",He,[e(N,{size:"small"},{default:a(()=>[e(S,{key:"prop",tab:"属性"},{default:a(()=>[i(u).id?i(u).component!="qb-chart"?(c(),q(Ue,{class:"material-cfg-contain",key:i(u).id,data:d.value,schema:y.value},null,8,["data","schema"])):i(u).component=="qb-chart"?(c(),q(o,{key:2},{default:a(()=>[e(s,{label:"数据集"},{default:a(()=>[e(t,{value:d.value.dataset,"onUpdate:value":p[0]||(p[0]=w=>d.value.dataset=w),options:I.value,onChange:$},null,8,["value","options"])]),_:1}),e(s,{label:"维度"},{default:a(()=>[e(t,{value:d.value.dimension,"onUpdate:value":p[1]||(p[1]=w=>d.value.dimension=w),options:D.value,mode:"tags"},null,8,["value","options"])]),_:1}),e(s,{label:"指标"},{default:a(()=>[e(t,{value:d.value.target,"onUpdate:value":p[2]||(p[2]=w=>d.value.target=w),options:D.value,mode:"tags"},null,8,["value","options"])]),_:1})]),_:1})):he("",!0):(c(),q(r,{key:0}))]),_:1}),e(S,{key:"style",tab:"样式"},{default:a(()=>[(c(),q(i(Ie),{schema:g.value,size:"small",formData:l.value,key:i(u).id},null,8,["schema","formData"]))]),_:1})]),_:1})])}}}),Ke=F(Je,[["__scopeId","data-v-9019cea1"]]),Ye=12,Qe=8,Xe=E({__name:"DashboardDesign",props:{readonly:{type:Boolean,default:!1}},setup(x){const C=ee(),{dgList:k}=B(C),{initDgItem:U,add:u,selectItem:M,transformProps:d}=C,y=_(),l=_(0),g=x,{readonly:I}=se(g),D=m=>{const p=m.dataTransfer.getData("material-type");let r;p=="custom"?r={name:m.dataTransfer.getData("material"),id:new Date().getTime().toString(),label:"自定义组件",icon:"",type:"custom",component:m.dataTransfer.getData("material"),props:{},style:{},rowStart:1,colStart:1,rowSpan:5,colSpan:2}:r=U(m.dataTransfer.getData("material"));const t=m.x/(l.value/Ye),s=m.y/Qe;r.colStart=Math.floor(t),r.rowStart=Math.floor(s),u(r)},$=_({});return G(()=>{l.value=y.value.clientWidth}),(m,p)=>{const r=xe("grid-layout");return c(),h("div",{class:"editor-container",ref_key:"container",ref:y,onDragover:p[0]||(p[0]=Q(()=>{},["prevent","stop"])),onDrop:Q(D,["stop"])},[e(r,{list:i(k),class:re(["layout",{readonly:i(I)}]),readonly:i(I),"onItem:click":i(M)},{"layout-item":a(({item:t})=>[f("div",{class:"comp-container",style:we(t.style)},[t.type&&t.type==="custom"?(c(),q(Y($.value[t.component]),Se({key:0},i(d)(t.props),{key:t.id}),null,16)):(c(),q(Y(t.component),{"style-config":t.style,attrs:i(d)(t.props),key:t.id},null,8,["style-config","attrs"]))],4)]),_:1},8,["list","class","readonly","onItem:click"])],544)}}}),Z=F(Xe,[["__scopeId","data-v-3def8c50"]]),Ze={class:"dg-design"},et={class:"dg-design-container"},tt={class:"middle-part"},at={style:{height:"300px","overflow-y":"auto"}},ot=E({__name:"DashboardDesign",props:{id:{}},setup(x){const C=H(),{varPools:k,dgInfo:U,loading:u}=B(C),{onSave:M,getDetail:d}=C;window.name="dg-design";const y=x,{id:l}=se(y);G(()=>{l.value&&d(l.value)});const g=_(!1),I=()=>{g.value=!0},D=()=>{M()};G(()=>{});const $=()=>{k.value.vars.push({name:"",type:"",defaultValue:""})},m=_([{label:"字符串",value:"string"},{label:"数字",value:"number"},{label:"布尔",value:"boolean"},{label:"数组",value:"array"},{label:"对象",value:"object"}]),p=s=>{const o=k.value.vars.findIndex(S=>S.name===s.name);o!=-1&&k.value.vars.splice(o,1)},r=()=>{U.value.id||fe.warning("请保存后再预览"),t.value=!0},t=_(!1);return(s,o)=>{const S=ae,N=oe,w=le,R=_e,T=K,n=ne,P=J,b=te,ie=ke("loading");return c(),h(V,null,[Ce((c(),h("div",Ze,[e(R,{ghost:!1,style:{border:"1px solid rgb(235, 237, 240)",padding:"10px 24px"}},{title:a(()=>[e(S,{bordered:!1,class:"form-name",value:i(U).name,"onUpdate:value":o[0]||(o[0]=v=>i(U).name=v)},null,8,["value"])]),extra:a(()=>[e(w,null,{default:a(()=>[e(N,{type:"primary",onClick:o[1]||(o[1]=v=>I())},{default:a(()=>[O("变量池")]),_:1}),e(N,{class:"preview-btn",onClick:o[2]||(o[2]=v=>r())},{default:a(()=>[O(" 预览 ")]),_:1}),e(N,{onClick:o[3]||(o[3]=v=>D()),type:"primary",class:"save-btn"},{default:a(()=>[O(" 保存 ")]),_:1})]),_:1})]),_:1}),f("div",et,[e(Ee,{class:"left-part"}),f("div",tt,[e(Z)]),e(Ke,{class:"right-part"})])])),[[ie,i(u),void 0,{fullscreen:!0}]]),e(b,{title:"变量池",open:g.value,"onUpdate:open":o[4]||(o[4]=v=>g.value=v),width:"800px",footer:null},{default:a(()=>[e(P,null,{default:a(()=>[f("div",at,[(c(!0),h(V,null,z(i(k).vars,(v,pe)=>(c(),q(w,{key:pe,style:{display:"flex","margin-bottom":"8px"},align:"baseline"},{default:a(()=>[e(T,{label:"变量名",required:!0},{default:a(()=>[e(S,{value:v.name,"onUpdate:value":L=>v.name=L},null,8,["value","onUpdate:value"])]),_:2},1024),e(T,{label:"变量类型",required:!0},{default:a(()=>[e(n,{style:{width:"150px"},value:v.type,"onUpdate:value":L=>v.type=L,options:m.value},null,8,["value","onUpdate:value","options"])]),_:2},1024),e(T,{label:"默认值",required:!0},{default:a(()=>[e(S,{value:v.defaultValue,"onUpdate:value":L=>v.defaultValue=L},null,8,["value","onUpdate:value"])]),_:2},1024),e(i(A),{onClick:L=>p(v)},null,8,["onClick"])]),_:2},1024))),128))]),e(T,null,{default:a(()=>[e(N,{type:"dashed",block:"",onClick:$},{default:a(()=>[e(i(j)),O(" 添加变量 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),e(b,{title:"预览",open:t.value,"onUpdate:open":o[5]||(o[5]=v=>t.value=v),width:"100%","wrap-class-name":"full-modal",footer:null},{default:a(()=>[e(Z,{style:{height:"500px"},readonly:!0})]),_:1},8,["open"])],64)}}}),_a=F(ot,[["__scopeId","data-v-d7040792"]]);export{_a as default};
