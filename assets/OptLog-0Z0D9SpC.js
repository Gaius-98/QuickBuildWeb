import{a as G,c as K}from"./iconfont-BCn86eVw.js";import{g as j,M as A,F as J,h as Q,I as W,R as X,B as Z,i as ee,T as te,D as ae,v as oe}from"./nodemodule-ant-design-vue@4.1.2_vue@3.4.21-DQ6gDd-0.js";import{d as le,b as ne,K as z,c as t,aI as e,G as a,a2 as f,N as x,F as re,L as d}from"./nodemodule-@vue_runtime-core@3.4.21-Cnn673wu.js";import{a as se,r as p}from"./nodemodule-@vue_reactivity@3.4.21-DbkE7Gi6.js";import{O as l}from"./nodemodule-@vue_shared@3.4.21-Ctf17_ps.js";import{_ as ue}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./nodemodule-axios@1.6.8-BZ84_VUH.js";import"./nodemodule-js-cookie@3.0.5-Cz0CWeBA.js";import"./nodemodule-vue-router@4.3.0_vue@3.4.21-BC_007Jj.js";import"./nodemodule-@babel_runtime@7.26.9-Bq4_u9L9.js";import"./nodemodule-@vue_runtime-dom@3.4.21-CDjXREoQ.js";import"./nodemodule-@ant-design_icons-vue@7.0.1_vue@3.4.21-CO80cFpd.js";import"./nodemodule-@ant-design_icons-svg@4.4.2-C9VH68wD.js";import"./nodemodule-@ant-design_colors@6.0.0-CBJ--Aym.js";import"./nodemodule-@ctrl_tinycolor@3.6.1-DOFZgDuz.js";import"./nodemodule-lodash-es@4.17.21-DcfALcKD.js";import"./nodemodule-resize-observer-polyfill@1.5.1-B1PUzC5B.js";import"./nodemodule-dayjs@1.11.13-B6I98uus.js";import"./nodemodule-classnames@2.5.1-BK5ccKcQ.js";import"./nodemodule-throttle-debounce@5.0.2-CUWDS_la.js";import"./nodemodule-async-validator@4.2.5-9PlIezaS.js";import"./nodemodule-scroll-into-view-if-needed@2.2.31-CLVC0ehY.js";import"./nodemodule-compute-scroll-into-view@1.0.20-1gs_hJI2.js";import"./nodemodule-vue-types@3.0.2_vue@3.4.21-CF28atMM.js";import"./nodemodule-dom-align@1.12.4-CRCehRfe.js";import"./nodemodule-@emotion_hash@0.9.2-WldOFDRm.js";import"./nodemodule-@emotion_unitless@0.8.1-sScrWPmR.js";import"./nodemodule-stylis@4.3.6-D5iaQeiq.js";const ie={getList:C=>G({method:"get",url:"operationlog/list",params:C})},pe={class:"optLog"},me=le({__name:"OptLog",setup(C){const r=se({keyword:"",startTime:"",endTime:"",pageNumber:1,pageSize:20}),v=p(""),w=p([]),B=p([{title:"操作用户",key:"username",dataIndex:"username"},{title:"ip地址",key:"ip",dataIndex:"ip"},{title:"地址",key:"location",dataIndex:"location"},{title:"操作模块",key:"optModule",dataIndex:"optModule"},{title:"操作类型",key:"optType",dataIndex:"optType"},{title:"操作结果",key:"resStatus",dataIndex:"resStatus"},{title:"响应时间",key:"resTime",dataIndex:"resTime"},{title:"操作时间",key:"createTime",dataIndex:"createTime"},{title:"操作",key:"action",dataIndex:"action",width:"250px"}]),I=p(!1),M=p(),P=()=>{var i;(i=M.value)==null||i.resetFields(),k()},F=p(0),q=()=>{r.pageNumber=1,r.pageSize=20,k()},O=()=>{v.value?(r.startTime=v.value[0],r.endTime=v.value[1]):(r.startTime="",r.endTime="")},R=i=>{const{current:s,pageSize:c}=i;r.pageNumber=s,r.pageSize=c,k()},k=()=>{I.value=!0,ie.getList(r).then(i=>{const{code:s,data:c}=i;s==200&&(w.value=c.data,F.value=c.total),I.value=!1})},o=p({}),h=p(!1),U=i=>{o.value=i,h.value=!0},L=p([]),g=p(new Map),V=["green","cyan","red","pink","orange","blue","purple"];return ne(()=>{k(),K.getDict(["optType"]).then(i=>{const{code:s,data:c,msg:T}=i;s==200&&(L.value=c.optType,L.value.forEach((b,y)=>{g.value.set(b.value,{label:b.label,color:V[y]})}))})}),(i,s)=>{const c=W,T=Q,b=X,y=Z,Y=J,N=j,_=te,E=ee,n=oe,H=ae,$=A;return d(),z("div",pe,[t(N,{class:"search-area"},{default:e(()=>[t(Y,{ref_key:"searchFormRef",ref:M,model:r,layout:"inline",onFinish:q},{default:e(()=>[t(T,{label:"用户名",name:"keyword"},{default:e(()=>[t(c,{value:r.keyword,"onUpdate:value":s[0]||(s[0]=u=>r.keyword=u)},null,8,["value"])]),_:1}),t(T,{label:"操作日期"},{default:e(()=>[t(b,{value:v.value,"onUpdate:value":s[1]||(s[1]=u=>v.value=u),showTime:!0,valueFormat:"YYYY-MM-DD HH:mm:ss",onChange:s[2]||(s[2]=u=>O())},null,8,["value"])]),_:1}),t(T,null,{default:e(()=>[t(y,{type:"primary","html-type":"submit"},{default:e(()=>[a("搜索")]),_:1}),t(y,{style:{margin:"0 8px"},onClick:P},{default:e(()=>[a(" 重置 ")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(N,null,{default:e(()=>[t(E,{loading:I.value,columns:B.value,"data-source":w.value,scroll:{y:600},onChange:R,pagination:{current:r.pageNumber,total:F.value,showSizeChanger:!0,pageSize:r.pageSize}},{bodyCell:e(({column:u,record:m})=>{var D;return[u.key=="optType"?(d(),f(_,{key:0,color:(D=g.value.get(m.optType))==null?void 0:D.color},{default:e(()=>{var S;return[a(l((S=g.value.get(m.optType))==null?void 0:S.label),1)]}),_:2},1032,["color"])):x("",!0),u.key=="resTime"?(d(),f(_,{key:1,color:parseInt(m.resTime)<500?"#87d068":"#f50"},{default:e(()=>[a(l(m.resTime),1)]),_:2},1032,["color"])):x("",!0),u.key=="resStatus"?(d(),z(re,{key:2},[m.resStatus=="1"?(d(),f(_,{key:0,color:"#87d068"},{default:e(()=>[a("成功")]),_:1})):(d(),f(_,{key:1,color:"#f50"},{default:e(()=>[a("失败")]),_:1}))],64)):x("",!0),u.key=="action"?(d(),f(y,{key:3,type:"link",onClick:S=>U(m)},{default:e(()=>[a("查看")]),_:2},1032,["onClick"])):x("",!0)]}),_:1},8,["loading","columns","data-source","pagination"])]),_:1}),t($,{open:h.value,"onUpdate:open":s[3]||(s[3]=u=>h.value=u),title:"查看详情",footer:null,width:"1000px"},{default:e(()=>[t(H,{column:2},{default:e(()=>[t(n,{label:"操作用户"},{default:e(()=>[a(l(o.value.username),1)]),_:1}),t(n,{label:"操作IP"},{default:e(()=>[a(l(o.value.ip),1)]),_:1}),t(n,{label:"操作地点"},{default:e(()=>[a(l(o.value.location),1)]),_:1}),t(n,{label:"操作时间"},{default:e(()=>[a(l(o.value.createTime),1)]),_:1}),t(n,{label:"请求类型"},{default:e(()=>[a(l(o.value.reqType),1)]),_:1}),t(n,{label:"请求地址"},{default:e(()=>[a(l(o.value.reqUrl),1)]),_:1}),t(n,{label:"请求参数"},{default:e(()=>[a(l(o.value.reqParam),1)]),_:1}),t(n,{label:"模块名称"},{default:e(()=>[a(l(o.value.moduleName),1)]),_:1}),t(n,{label:"方法名称"},{default:e(()=>[a(l(o.value.funcName),1)]),_:1}),t(n,{label:"操作模块"},{default:e(()=>[a(l(o.value.optModule),1)]),_:1}),t(n,{label:"操作类型"},{default:e(()=>{var u;return[t(_,{color:(u=g.value.get(o.value.optType))==null?void 0:u.color},{default:e(()=>{var m;return[a(l((m=g.value.get(o.value.optType))==null?void 0:m.label),1)]}),_:1},8,["color"])]}),_:1}),t(n,{label:"操作结果"},{default:e(()=>[o.value.resStatus=="1"?(d(),f(_,{key:0,color:"#87d068"},{default:e(()=>[a("成功")]),_:1})):(d(),f(_,{key:1,color:"#f50"},{default:e(()=>[a("失败")]),_:1}))]),_:1}),t(n,{label:"响应时间"},{default:e(()=>[t(_,{color:parseInt(o.value.resTime)<500?"#87d068":"#f50"},{default:e(()=>[a(l(o.value.resTime),1)]),_:1},8,["color"])]),_:1}),t(n,{label:"请求结果",span:4},{default:e(()=>[a(l(o.value.res),1)]),_:1}),t(n,{label:"异常信息",span:4},{default:e(()=>[a(l(o.value.errMsg),1)]),_:1})]),_:1})]),_:1},8,["open"])])}}}),Ve=ue(me,[["__scopeId","data-v-f0f56045"]]);export{Ve as default};
