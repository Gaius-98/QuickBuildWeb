import{bV as k,d as re,bf as ne,r as u,p as B,c as se,F as ue,q as C,f as a,w as t,$ as d,v as O,H as F,e as c,I as b,J as I,a as R,bj as de,o as i}from"./iconfont-DlnTACa0.js";import{a as ie}from"./menu-BiFG523B.js";import{C as me}from"./index-DWh7MMD2.js";import{M as pe}from"./index-rRoPRs5X.js";import{F as ce,_ as _e}from"./index-3zxQoAaC.js";import{I as ve,b as fe}from"./index-DstlK8U5.js";import{B as ye}from"./EyeOutlined-MSEk9XoR.js";import{T as ge}from"./index-CcL4KyIF.js";import{_ as ke,b as be,S as he}from"./RadioButton-CjVxn_Oc.js";import{_ as xe,a as Ce}from"./index-C5YNH3Jl.js";import{_ as we}from"./index-b8kqwElj.js";import{_ as Ne}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-DFAyz8EE.js";import"./useFlexGapSupport-CiVQ43IU.js";import"./_getPrototype-CreJcRG-.js";import"./initDefaultProps-CCuNUPvT.js";import"./CheckOutlined-DhghRCOv.js";import"./index-CkgH7Yyy.js";import"./shallowequal-CYaRVoeZ.js";import"./index-Cj_T3PZy.js";import"./PlusOutlined-boFLuxir.js";import"./index-Df99mV5f.js";import"./pickAttrs-C_Pg0-pd.js";import"./ActionButton-GOh5bmF9.js";import"./cloneDeep-eMWwQ7HD.js";import"./Col-7N7sU2gK.js";import"./index-C6qv0Jk3.js";import"./css-CjeDAR7Q.js";import"./index-DVHdQjvX.js";import"./LeftOutlined-DjA3wwZo.js";import"./RightOutlined-DiQ8sQL1.js";import"./useBreakpoint-BBubvWxm.js";import"./zh_CN-CAyhejr6.js";import"./index-BZJkr9T5.js";import"./dropdown-CS9IU7I3.js";import"./index-BJM6GpkM.js";const h={getList:m=>k({method:"get",url:"role/list",params:m}),getDetail:m=>k({method:"get",url:"role/detail",params:{id:m}}),remove:m=>k({method:"get",url:"role/remove",params:{id:m}}),add:m=>k({method:"post",url:"role/add",data:m}),update:m=>k({method:"post",url:"role/update",data:m})},Me={class:"role"},Fe={class:"tools"},Ie={style:{height:"150px","overflow-y":"auto"}},Te=re({__name:"RoleView",setup(m){const p=ne({keyword:"",pageNumber:1,pageSize:10}),T=u([]),$=u([{title:"角色名",key:"roleName",dataIndex:"roleName",width:"200px"},{title:"状态",key:"status",dataIndex:"status",width:"100px"},{title:"备注",key:"remark",dataIndex:"remark"},{title:"创建时间",key:"createTime",dataIndex:"createTime"},{title:"操作",key:"action",dataIndex:"action",width:"250px"}]),w=u(!1),S=u(),L=()=>{var o;(o=S.value)==null||o.resetFields(),_()},P=u(0),j=()=>{p.pageNumber=1,p.pageSize=10,_()},A=o=>{const{current:e,pageSize:n}=o;p.pageNumber=e,p.pageSize=n,_()},_=()=>{w.value=!0,h.getList(p).then(o=>{const{code:e,data:n}=o;e==200&&(T.value=n.data,P.value=n.total),w.value=!1})},D=u([]);B(()=>{_(),se.getDict(["dataPerm"]).then(o=>{const{code:e,data:n,msg:s}=o;e==200&&(D.value=n.dataPerm)})});const v=u(!1),l=u({roleName:"",roleKey:"",status:"1",remark:"",roleMenus:[],dataPerm:"1"}),f=u("add"),E=ue(()=>({add:"新增角色",edit:"编辑角色"})[f.value]),N=u(),H=()=>{f.value="add",v.value=!0,l.value={roleName:"",roleKey:"",status:"1",remark:"",roleMenus:[],dataPerm:"1"}},J=async o=>{const{code:e,data:n}=await h.getDetail(o.roleId);e==200&&(l.value=n,f.value="edit",v.value=!0)},G=async o=>{const{code:e,msg:n,data:s}=await h.remove(o.roleId);e==200&&(R.success(s),_())},K=()=>{var o;(o=N.value)==null||o.resetFields()},Q=()=>{var o;(o=N.value)==null||o.validate().then(()=>{let e;f.value=="add"?e=h.add:e=h.update,l.value.roleMenus instanceof Array||(l.value.roleMenus=l.value.roleMenus.checked),e(l.value).then(n=>{const{code:s}=n;s==200&&(R.success(f.value=="add"?"新增成功":"编辑成功"),_()),K(),v.value=!1})})},U=u([]),W=()=>{ie.getAllMenu().then(o=>{const{code:e,data:n,msg:s}=o;e==200&&(U.value=n)})};return B(()=>{W()}),(o,e)=>{const n=ve,s=_e,y=ye,z=ce,V=me,x=ge,X=we,Y=xe,q=be,Z=ke,ee=Ce,te=he,ae=fe,oe=pe,M=de("has-perm");return i(),C("div",Me,[a(V,{class:"search-area"},{default:t(()=>[a(z,{ref_key:"searchFormRef",ref:S,layout:"inline",model:p,onFinish:j},{default:t(()=>[a(s,{label:"角色名称",prop:"keyword"},{default:t(()=>[a(n,{value:p.keyword,"onUpdate:value":e[0]||(e[0]=r=>p.keyword=r)},null,8,["value"])]),_:1}),a(s,null,{default:t(()=>[a(y,{type:"primary","html-type":"submit"},{default:t(()=>[d("搜索")]),_:1}),a(y,{style:{margin:"0 8px"},onClick:L},{default:t(()=>[d(" 重置 ")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(V,null,{default:t(()=>[O("div",Fe,[F((i(),c(y,{type:"primary",onClick:H},{default:t(()=>[d("新增")]),_:1})),[[M,"system:role:add"]])]),a(Y,{loading:w.value,columns:$.value,"data-source":T.value,scroll:{y:560},onChange:A,pagination:{current:p.pageNumber,total:P.value,showSizeChanger:!0,pageSize:p.pageSize}},{bodyCell:t(({column:r,record:g})=>[r.key=="status"?(i(),C(I,{key:0},[g.status=="1"?(i(),c(x,{key:0,color:"#87d068"},{default:t(()=>[d("启用")]),_:1})):(i(),c(x,{key:1,color:"#f50"},{default:t(()=>[d("停用")]),_:1}))],64)):b("",!0),r.key=="action"?(i(),C(I,{key:1},[F((i(),c(y,{type:"link",onClick:le=>J(g)},{default:t(()=>[d("编辑")]),_:2},1032,["onClick"])),[[M,"system:role:update"]]),a(X,{title:"确定要删除吗?","ok-text":"确定","cancel-text":"取消",onConfirm:le=>G(g)},{default:t(()=>[F((i(),c(y,{type:"link",danger:""},{default:t(()=>[d("删除")]),_:1})),[[M,"system:role:remove"]])]),_:2},1032,["onConfirm"])],64)):b("",!0),r.key=="roleType"?(i(),C(I,{key:2},[g.roleType=="app"?(i(),c(x,{key:0,color:"#2db7f5"},{default:t(()=>[d("菜单")]),_:1})):b("",!0),g.roleType=="directory"?(i(),c(x,{key:1,color:"#87d068"},{default:t(()=>[d("目录")]),_:1})):b("",!0)],64)):b("",!0)]),_:1},8,["loading","columns","data-source","pagination"])]),_:1}),a(oe,{open:v.value,"onUpdate:open":e[7]||(e[7]=r=>v.value=r),onOk:Q,title:E.value,onCancel:K},{default:t(()=>[a(z,{model:l.value,"label-col":{span:8},ref_key:"modalFormRef",ref:N},{default:t(()=>[a(s,{label:"角色名",required:"",prop:"roleName"},{default:t(()=>[a(n,{value:l.value.roleName,"onUpdate:value":e[1]||(e[1]=r=>l.value.roleName=r)},null,8,["value"])]),_:1}),a(s,{label:"角色ID",required:"",prop:"roleKey"},{default:t(()=>[a(n,{value:l.value.roleKey,"onUpdate:value":e[2]||(e[2]=r=>l.value.roleKey=r)},null,8,["value"])]),_:1}),a(s,{label:"状态",required:"",prop:"status"},{default:t(()=>[a(Z,{value:l.value.status,"onUpdate:value":e[3]||(e[3]=r=>l.value.status=r),"button-style":"solid"},{default:t(()=>[a(q,{value:"1"},{default:t(()=>[d("启用 ")]),_:1}),a(q,{value:"0"},{default:t(()=>[d("停用 ")]),_:1})]),_:1},8,["value"])]),_:1}),a(s,{label:"菜单权限",prop:"roleMenus"},{default:t(()=>[O("div",Ie,[a(ee,{checkedKeys:l.value.roleMenus,"onUpdate:checkedKeys":e[4]||(e[4]=r=>l.value.roleMenus=r),"tree-data":U.value,checkStrictly:!0,checkable:"","field-names":{children:"children",title:"label",key:"id"}},null,8,["checkedKeys","tree-data"])])]),_:1}),a(s,{label:"数据权限",required:"",prop:"dataPerm"},{default:t(()=>[a(te,{value:l.value.dataPerm,"onUpdate:value":e[5]||(e[5]=r=>l.value.dataPerm=r),options:D.value},null,8,["value","options"])]),_:1}),a(s,{label:"备注",prop:"remark"},{default:t(()=>[a(ae,{value:l.value.remark,"onUpdate:value":e[6]||(e[6]=r=>l.value.remark=r),rows:5},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","title"])])}}}),pt=Ne(Te,[["__scopeId","data-v-795fb0a3"]]);export{pt as default};
