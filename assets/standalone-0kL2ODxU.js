import"./iconfont-RswF9Ywb.js";import{f as E,r as d,t as k,v as w,g as h,s as M,x as q,o as g,y,l as L,w as R,i as f,A as S,k as z,h as G,B as H,C as N,D as Q,E as D,F as P,G as W,H as T,I as A,m as V,p as F,$ as U}from"./.pnpm-BfHkGPSW.js";import{c as O}from"./componentsSchema-gFhwa5FU.js";import{_ as I}from"./_plugin-vue_export-helper-DlAUqK2U.js";const j=E("dgDesign",()=>{const o=d({}),t=d([]),n=d({});return{dashboardData:o,add:s=>{t.value.push(s)},remove:s=>{const{id:l}=s,e=t.value.findIndex(a=>a.id===l);e!==-1&&t.value.splice(e,1)},dgList:t,initDgItem:s=>{const l=O.findIndex(a=>a.name===s);if(l===-1)throw new Error("组件不存在");const e=k(O[l]);return e.id=new Date().getTime().toString(),e},selectItem:s=>{n.value=s,window.parent.postMessage({type:"select",data:w(s)},window.location.origin)},curComp:n,updateItem:s=>{const{id:l}=s,e=t.value.findIndex(a=>a.id===l);e!==-1&&t.value.splice(e,1,s)}}}),J=12,K=8,X=h({__name:"StandalonePage",setup(o){const t=j(),{dgList:n}=M(t),{initDgItem:c,add:p,selectItem:i,updateItem:r}=t,u=d(),s=d(0),l=e=>{const a=c(e.dataTransfer.getData("material")),_=e.x/(s.value/J),m=e.y/K;a.colStart=Math.floor(_),a.rowStart=Math.floor(m),p(a)};return window.addEventListener("message",e=>{e.data,e.data.type==="refresh"&&r(e.data.data)}),q(()=>{s.value=u.value.clientWidth}),(e,a)=>{const _=z("grid-layout");return g(),y("div",{class:"container",ref_key:"container",ref:u,onDragover:a[0]||(a[0]=S(()=>{},["prevent","stop"])),onDrop:S(l,["stop"])},[L(_,{list:f(n),class:"layout","onItem:click":f(i)},{"layout-item":R(({item:m})=>[(g(),G(H(m.component),{attrs:m.props,"style-config":m.style},null,8,["attrs","style-config"]))]),_:1},8,["list","onItem:click"])],544)}}}),Y=I(X,[["__scopeId","data-v-e6e2262d"]]),Z=h({__name:"QBChart",props:{attrs:{default:()=>({dataset:"",dimension:[],target:[]})},styleConfig:{default:()=>({})}},setup(o){const t=o,{attrs:n,styleConfig:c}=t,p=d(!0),i=d();let r;const u=d(0),s=d(""),l=d(),e=async()=>{s.value=n.dataset,l.value=[{title:"title1",value:100},{title:"title2",value:200},{title:"title3",value:300}]},a=()=>{const{dimension:C,target:v}=n,b=w(c.option),$=w(c.series),B=[];return v.forEach(pt=>{B.push(k($))}),b.series=B,{...b,dataset:{source:w(l.value),dimensions:[...C,...v]}}},_=()=>{s.value!=n.dataset?e().then(()=>{r?(r.clear(),r.setOption(a())):i.value&&(r=Q(i.value),r.setOption(a()))}):r?(r.clear(),r.setOption(a())):i.value&&(r=Q(i.value),r.setOption(a())),p.value=!1},m=new ResizeObserver(C=>{u.value&&clearTimeout(u.value),u.value=window.setTimeout(()=>{try{r.resize()}catch(v){console.warn(`chart重新设置大小失败,失败原因：${v}`)}},50)});return q(()=>{_(),m.observe(i.value)}),N(()=>[t.attrs,t.styleConfig],()=>{_()},{deep:!0}),(C,v)=>(g(),y("div",{ref_key:"QBChart",ref:i,class:"qb-chart"},null,512))}}),tt=I(Z,[["__scopeId","data-v-996b3f25"]]),et={class:"qb-iframe"},st=["src"],at=h({__name:"QBIframe",props:{attrs:{default:()=>({src:""})},preview:{type:Boolean,default:!1}},setup(o){const t=o,{attrs:n,preview:c}=D(t);return(p,i)=>(g(),y("div",et,[P("iframe",{class:W(f(c)?"":"no-effect"),src:f(n).src,style:{width:"100%",height:"100%",border:"none"}},null,10,st)]))}}),ot=I(at,[["__scopeId","data-v-67323949"]]),nt=["src"],rt=h({__name:"QBImage",props:{attrs:{default:()=>({src:""})},styleConfig:{default:()=>({})}},setup(o){const t=o,{attrs:n,styleConfig:c}=D(t);return(p,i)=>(g(),y("img",{class:"qb-image",style:T([{width:"100%",height:"100%"},f(c)]),src:f(n).src},null,12,nt))}}),ct=I(rt,[["__scopeId","data-v-3b56b274"]]),it=h({__name:"QBText",props:{attrs:{default:()=>({text:""})},styleConfig:{default:()=>({})}},setup(o){const t=o,{attrs:n}=D(t);return(c,p)=>(g(),y("div",{class:"qb-text",style:T(c.styleConfig)},A(f(n).text),5))}}),lt=I(it,[["__scopeId","data-v-ad3a33fa"]]),dt=o=>{o.component("qb-chart",tt),o.component("qb-iframe",ot),o.component("qb-image",ct),o.component("qb-text",lt)},x=V(Y);x.use(F());x.use(dt);x.component("GridLayout",U);x.mount("#standalone-app");
