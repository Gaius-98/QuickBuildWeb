import{_ as ue}from"./CodeEditor.vue_vue_type_script_setup_true_name_EvCode_lang-Cm7zMyI4.js";import{c as re}from"./componentsSchema-BilSLpq2.js";import{f as de,r as f,Q as B,g as F,s as J,y as G,z as g,A as n,j as e,P as I,X as E,O as N,k as w,ak as W,a2 as Z,w as a,v as ie,x as K,K as ce,L as Y,a3 as ee,a4 as te,a5 as ae,bh as j,U as Q,b6 as le,ap as oe,aq as ne,o as c,b2 as pe,b3 as me,i as z,aG as _e,J as ve,b4 as fe,W as be}from"./.pnpm-C-9D1c9J.js";import{_ as X}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as ye}from"./ConfigForm.vue_vue_type_script_setup_true_lang-C0JOQpwm.js";import{S as ge}from"./SchemaForm-CjXkAgbF.js";import"./main-Cai9BzRR.js";import"./iconfont-RswF9Ywb.js";/* empty css                   */const H=de("dashboardDesign",()=>{const r=f([]),C=d=>{r.value.push(d)},h=B(()=>{const d={};return r.value.map(p=>{p.children.forEach(b=>{d[b.componentName]=b.schema})}),d}),D=B(()=>{let d=[];return r.value.forEach(p=>{const b=p.children.map(k=>({label:k.componentName,value:k.exportName}));d=d.concat(b)}),d}),U=f({datasets:[],vars:[{name:"test",type:"string",defaultValue:"这是一段测试文本"}]});return{customModules:r,customCompSchema:h,onAddModules:C,customComps:D,varPools:U,getContentWindow:()=>document.querySelector(".standalone-iframe").contentWindow}}),se=r=>(oe("data-v-63b2d937"),r=r(),ne(),r),he={class:"material-area"},xe={class:"material-layout-area"},Ce=se(()=>n("div",{class:"title"},"内置组件",-1)),ke={class:"content"},Se=["data-material"],we={class:"material-label"},De={class:"material-data-area"},Ue=se(()=>n("div",{class:"title"},"自定义组件",-1)),Ne={class:"content"},$e=["data-material"],Me={style:{height:"650px"}},qe={style:{height:"80px","overflow-y":"auto"}},Ie={style:{height:"200px","overflow-y":"auto"}},Ve=F({__name:"MaterialArea",setup(r){const C=H(),{customModules:h,customComps:D}=J(C),{onAddModules:U}=C,s=f({internalComp:re,customComp:[]}),d=_=>{var i,u;const o=_.target;(i=_.dataTransfer)==null||i.setData("material",o.dataset.material),(u=_.dataTransfer)==null||u.setData("material-type",o.dataset.materialType)},p=f(!1),b=()=>{p.value=!0,l.value=ie(k.value)},k=f({title:"element",package:"element-plus",version:"2.9.2",exportName:"ElementPlus",urls:["https://cdn.jsdelivr.net/npm/element-plus@2.9.2/dist/index.full.min.js","https://cdn.jsdelivr.net/npm/element-plus@2.9.2/dist/index.min.css"],children:[{componentName:"ElEmpty",exportName:"ElEmpty",id:"1",schema:`{
    "description": {
        "type": "input",
        "label": "描述"
    }

      }`}]}),l=f({}),q=()=>{p.value=!1},x=()=>{U(l.value),s.value.customComp=s.value.customComp.concat(D.value),y==null||y.postMessage({type:"add-custom-comp",data:K(l.value)}),q()},$=()=>{l.value.children.push({componentName:"",exportName:"",id:new Date().getTime().toString()})},V=_=>{const o=l.value.children.findIndex(i=>i.id==_.id);o!=-1&&l.value.children.splice(o,1)},M=()=>{l.value.urls.push("")},m=_=>{const o=l.value.urls.findIndex(i=>i==_);o!=-1&&l.value.urls.splice(o,1)};let y=null;return G(()=>{y=document.querySelector(".standalone-iframe").contentWindow}),(_,o)=>{const i=ae,u=te,P=Q,T=le,L=ue,v=ee,O=Z;return c(),g("div",he,[n("div",xe,[Ce,n("div",ke,[(c(!0),g(I,null,E(s.value.internalComp,t=>(c(),g("div",{key:t.name,draggable:"true",onDragstart:d,"data-material":t.name,"data-material-type":"internal",class:"material-item"},[n("span",{class:ce(["iconfont material-icon",t.icon])},null,2),n("span",we,Y(t.label),1)],40,Se))),128))])]),n("div",De,[Ue,n("div",Ne,[(c(!0),g(I,null,E(s.value.customComp,t=>(c(),g("div",{type:"dashed",key:t.value,draggable:"true",onDragstart:d,"data-material":t.value,"data-material-type":"custom",class:"material-item"},Y(t.label),41,$e))),128)),n("div",{type:"dashed",onClick:b,class:"material-item"},[n("span",null,[e(w(W)),N(" 添加组件 ")])])])]),e(O,{title:"添加自定义组件",width:"800px",open:p.value,"onUpdate:open":o[4]||(o[4]=t=>p.value=t),onOk:x,onCancel:q},{default:a(()=>[n("div",Me,[e(v,{model:l.value,"label-col":{style:{width:"150px"}}},{default:a(()=>[e(u,{label:"名称"},{default:a(()=>[e(i,{value:l.value.title,"onUpdate:value":o[0]||(o[0]=t=>l.value.title=t)},null,8,["value"])]),_:1}),e(u,{label:"组件库名称"},{default:a(()=>[e(i,{value:l.value.package,"onUpdate:value":o[1]||(o[1]=t=>l.value.package=t)},null,8,["value"])]),_:1}),e(u,{label:"版本"},{default:a(()=>[e(i,{value:l.value.version,"onUpdate:value":o[2]||(o[2]=t=>l.value.version=t)},null,8,["value"])]),_:1}),e(u,{label:"导出名称"},{default:a(()=>[e(i,{value:l.value.exportName,"onUpdate:value":o[3]||(o[3]=t=>l.value.exportName=t)},null,8,["value"])]),_:1}),e(u,{label:"CDN地址"},{default:a(()=>[n("div",qe,[(c(!0),g(I,null,E(l.value.urls,(t,A)=>(c(),g("div",{key:t,style:{display:"flex","margin-bottom":"8px"},align:"baseline"},[e(i,{value:l.value.urls[A],"onUpdate:value":S=>l.value.urls[A]=S},null,8,["value","onUpdate:value"]),e(w(j),{onClick:S=>m(t),style:{padding:"0 10px"}},null,8,["onClick"])]))),128))]),e(u,null,{default:a(()=>[e(P,{type:"dashed",block:"",onClick:M},{default:a(()=>[e(w(W)),N(" 增加CDN地址 ")]),_:1})]),_:1})]),_:1}),e(u,{label:"子组件"},{default:a(()=>[n("div",Ie,[(c(!0),g(I,null,E(l.value.children,(t,A)=>(c(),g("div",{key:t.id,style:{display:"flex","margin-bottom":"8px","border-bottom":"1px solid #ccc"},align:"baseline"},[e(T,null,{default:a(()=>[n("div",null,[e(T,null,{default:a(()=>[e(u,{label:"组件名",rules:{required:!0}},{default:a(()=>[e(i,{value:t.componentName,"onUpdate:value":S=>t.componentName=S},null,8,["value","onUpdate:value"])]),_:2},1024),e(u,{label:"导出名称",rules:{required:!0}},{default:a(()=>[e(i,{value:t.exportName,"onUpdate:value":S=>t.exportName=S},null,8,["value","onUpdate:value"])]),_:2},1024)]),_:2},1024),e(u,{label:"配置Schema",rules:{required:!0}},{default:a(()=>[e(L,{value:t.schema,"onUpdate:value":S=>t.schema=S,theme:"light",height:"110"},null,8,["value","onUpdate:value"])]),_:2},1024)]),e(w(j),{onClick:S=>V(t)},null,8,["onClick"])]),_:2},1024)]))),128))]),e(u,null,{default:a(()=>[e(P,{type:"dashed",block:"",onClick:$},{default:a(()=>[e(w(W)),N(" 增加子组件 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])])]),_:1},8,["open"])])}}}),Ee=X(Ve,[["__scopeId","data-v-63b2d937"]]),Pe={text:{type:"input",label:"文本内容"}},Te={src:{type:"input",label:"图片地址"}},We={src:{type:"input",label:"页面地址"}},Le=r=>({dataset:{type:"select",label:"数据集",options:r},dimension:{type:"select",label:"维度",options:[],mode:"multiple"},target:{type:"select",label:"指标",options:[],mode:"multiple"}}),R={"qb-text":Pe,"qb-image":Te,"qb-iframe":We,"qb-chart":Le},Oe={title1:{type:"divider",label:"布局",component:{title:"布局"},formLayout:!1},paddingLeft:{type:"string",label:"左边距",tooltip:"请注明单位，一般为：px"},paddingTop:{type:"string",label:"上边距",tooltip:"请注明单位，一般为：px"},paddingRight:{type:"string",label:"右边距",tooltip:"请注明单位，一般为：px"},paddingBottom:{type:"string",label:"下边距",tooltip:"请注明单位，一般为：px"},title2:{type:"divider",label:"背景",component:{title:"背景"},formLayout:!1},backgroundColor:{type:"string",label:"背景色",component:{name:"color-picker"}},title3:{type:"divider",label:"边框",component:{title:"边框"},formLayout:!1},borderWidth:{type:"string",label:"边框宽度",tooltip:"请注明单位，一般为：px"},borderColor:{type:"string",label:"边框颜色",component:{name:"color-picker"}},borderStyle:{type:"radio",label:"边框样式",component:{dataSource:[{label:"无边框",value:"none"},{label:"虚线",value:"dashed"},{label:"实线",value:"solid"}],buttonStyle:"solid"}},borderRadius:{type:"string",label:"边框圆角",tooltip:"请注明单位，可以为%或者px"}},Ae={class:"material-cfg"},Re={class:"material-cfg-btn"},Be=F({__name:"MaterialCfg",setup(r){const C=H(),{customCompSchema:h}=J(C),{getContentWindow:D}=C,U=f({}),s=f({}),d=f({}),p=f({}),b=f({layout:{labelAlign:"left",layout:"horizontal",labelCol:{style:{width:"100px"}}},properties:Oe});window.addEventListener("message",x=>{var $;(x.data.type==="select"||x.data.type==="update-item")&&(s.value=x.data.data,(($=s.value)==null?void 0:$.type)==="custom"?h.value&&(d.value=JSON.parse(h.value[s.value.component])):typeof R[s.value.component]=="function"?d.value=R[s.value.component]([]):d.value=R[s.value.component],U.value=x.data.data.props,p.value=s.value.style)});let k=null;const l=x=>{if(k)k.postMessage({type:"refresh",data:x});else throw new Error("contentWindow is null")},q=()=>{l(K(s.value))};return G(()=>{k=D()}),(x,$)=>{const V=_e,M=me,m=pe,y=Q;return c(),g("div",Ae,[e(m,{size:"small"},{default:a(()=>[e(M,{key:"prop",tab:"属性"},{default:a(()=>[s.value.id?(c(),z(ye,{class:"material-cfg-contain",key:s.value.id,data:U.value,schema:d.value},null,8,["data","schema"])):(c(),z(V,{key:0}))]),_:1}),e(M,{key:"style",tab:"样式"},{default:a(()=>[e(w(ge),{schema:b.value,size:"small",formData:p.value},null,8,["schema","formData"])]),_:1})]),_:1}),n("div",Re,[e(y,{onClick:q,disabled:!s.value.id},{default:a(()=>[N("刷新")]),_:1},8,["disabled"])])])}}}),je=X(Be,[["__scopeId","data-v-8785a708"]]),ze=r=>(oe("data-v-9747f432"),r=r(),ne(),r),Fe={class:"dg-design"},Je={class:"dg-design-container"},Ge=ze(()=>n("div",{class:"middle-part"},[n("iframe",{width:"100%",height:"100%",src:"/standalone/standalone.html",style:{border:"0"},class:"standalone-iframe"})],-1)),Ke={style:{height:"300px","overflow-y":"auto"}},Qe=F({__name:"DashboardDesign",props:{id:{}},setup(r){const C=H(),{varPools:h}=J(C);let D;const{getContentWindow:U}=C;window.name="dg-design";const s=r,{id:d}=ve(s),p=B(()=>d.value),b=f(!1),k=()=>{b.value=!0},l=()=>{};G(()=>{D=U()});const q=()=>{D.postMessage({type:"refresh-var",data:K(h.value)})},x=()=>{h.value.vars.push({name:"",type:"",defaultValue:""})},$=f([{label:"字符串",value:"string"},{label:"数字",value:"number"},{label:"布尔",value:"boolean"},{label:"数组",value:"array"},{label:"对象",value:"object"}]),V=M=>{const m=h.value.vars.findIndex(y=>y.name===M.name);m!=-1&&h.value.vars.splice(m,1)};return(M,m)=>{const y=ae,_=le,o=Q,i=fe,u=te,P=be,T=ee,L=Z;return c(),g(I,null,[n("div",Fe,[e(i,{subTitle:p.value,ghost:!1,style:{border:"1px solid rgb(235, 237, 240)",padding:"10px 24px"}},{title:a(()=>[e(y,{bordered:!1,class:"form-name"})]),extra:a(()=>[e(_),e(_),e(_,null,{default:a(()=>[e(o,{type:"primary",onClick:m[0]||(m[0]=v=>k())},{default:a(()=>[N("变量池")]),_:1}),e(o,{class:"preview-btn"},{default:a(()=>[N(" 预览 ")]),_:1}),e(o,{onClick:m[1]||(m[1]=v=>l()),type:"primary",class:"save-btn"},{default:a(()=>[N(" 保存 ")]),_:1})]),_:1})]),_:1},8,["subTitle"]),n("div",Je,[e(Ee,{class:"left-part"}),Ge,e(je,{class:"right-part"})])]),e(L,{title:"变量池",open:b.value,"onUpdate:open":m[2]||(m[2]=v=>b.value=v),width:"800px",footer:null,onCancel:q},{default:a(()=>[e(T,null,{default:a(()=>[n("div",Ke,[(c(!0),g(I,null,E(w(h).vars,(v,O)=>(c(),z(_,{key:O,style:{display:"flex","margin-bottom":"8px"},align:"baseline"},{default:a(()=>[e(u,{label:"变量名",required:!0},{default:a(()=>[e(y,{value:v.name,"onUpdate:value":t=>v.name=t},null,8,["value","onUpdate:value"])]),_:2},1024),e(u,{label:"变量类型",required:!0},{default:a(()=>[e(P,{style:{width:"150px"},value:v.type,"onUpdate:value":t=>v.type=t,options:$.value},null,8,["value","onUpdate:value","options"])]),_:2},1024),e(u,{label:"默认值",required:!0},{default:a(()=>[e(y,{value:v.defaultValue,"onUpdate:value":t=>v.defaultValue=t},null,8,["value","onUpdate:value"])]),_:2},1024),e(w(j),{onClick:t=>V(v)},null,8,["onClick"])]),_:2},1024))),128))]),e(u,null,{default:a(()=>[e(o,{type:"dashed",block:"",onClick:x},{default:a(()=>[e(w(W)),N(" 添加变量 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])],64)}}}),nt=X(Qe,[["__scopeId","data-v-9747f432"]]);export{nt as default};
