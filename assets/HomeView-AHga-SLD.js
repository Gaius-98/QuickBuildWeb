var K=Object.defineProperty;var W=(l,e,t)=>e in l?K(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t;var k=(l,e,t)=>(W(l,typeof e!="symbol"?e+"":e,t),t);import{_ as J}from"./CodeEditor.vue_vue_type_script_setup_true_name_EvCode_lang-BDDN2zUy.js";import{I as H,V as Q,g as w,x as I,r as h,o as c,z as x,m as g,w as v,F as E,J as B,h as m,i as d,K as X,T as Y,v as A,y as j,D,L as M,M as S,N as V,O as C,P as Z,A as ee,B as $,Q as F,R as te,U as ae,W as L,X as U,Y as ne,$ as oe,a0 as le,k as se,G as N,a1 as ce,a2 as ue}from"./.pnpm-0Rj9Ahsw.js";import{_ as T}from"./_plugin-vue_export-helper-DlAUqK2U.js";class re{constructor(e){k(this,"state",{});e&&(this.state=e)}getValue(e){const{_value:t,_mode:n,_dynExp:a}=e;return n==="static"?t:this.resolveDynamicValue(a)}createDynamicConfigData(e){return{_value:e||"",_mode:"static",_dynExp:""}}resolveDynamicValue(e){try{return new Function("state",`return ${e}`)(this.state)}catch(t){return console.error("评估动态表达式时出错:",t),null}}isDynamicConfigData(e){return typeof e=="object"&&e!==null&&["static","dynamic"].includes(e._mode)}processObject(e){const t=H(e);if(Array.isArray(t))return t.map(n=>this.processObject(n));if(typeof t=="object"&&t!==null){const n={};for(const a in t){const o=t[a];this.isDynamicConfigData(o)?n[a]=this.getValue(o):typeof o=="object"&&o!==null?n[a]=this.processObject(o):n[a]=o}return n}else return t}}class ie{constructor(e){k(this,"libs");k(this,"scripts",[]);k(this,"styles",[]);k(this,"componentsMap",new Map);k(this,"components",{});this.libs=e,this.init()}init(){window.Vue||(window.Vue=Q),this.handleLibs(),this.handleUrls()}handleUrls(){this.libs.map(t=>t.urls).flat().forEach(t=>{t.endsWith("js")?this.scripts.push(t):t.endsWith("css")&&this.styles.push(t)})}load(){return new Promise((e,t)=>{Promise.allSettled([...this.styles.map(n=>this.loadStyle(n)),...this.scripts.map(n=>this.loadScript(n))]).then(()=>{this.registerComponents(),e(this.components)}).catch(n=>{t(n)})})}registerComponents(){for(const[e,t]of this.componentsMap)Array.isArray(t)?t.forEach(n=>{this.components[n.componentName]=window[e][n.exportName]}):this.components[t.componentName]=window[t.exportName]}handleLibChildren(e){const t=e.children.map(n=>({exportName:n.exportName,componentName:n.componentName}));this.componentsMap.set(e.exportName,t)}handleLibs(e=this.libs){e.forEach(t=>{this.isLibTree(t)?this.handleLibChildren(t):this.componentsMap.set(t.exportName,{exportName:t.exportName,componentName:t.componentName})})}isLibTree(e){return"children"in e}loadScript(e){return new Promise((t,n)=>{const a=document.createElement("script");a.src=e,a.async=!1,a.onload=t,a.onerror=n,document.body.appendChild(a)})}loadStyle(e){return new Promise((t,n)=>{const a=document.createElement("link");a.rel="stylesheet",a.href=e,a.onload=t,a.onerror=n,document.head.appendChild(a)})}}const de={class:"config-array"},pe=w({__name:"ConfigArray",props:{title:{default:"标题"},closable:{type:Boolean,default:!0},schema:{default:()=>({})},data:{}},setup(l){const e=l,{title:t,closable:n,data:a}=I(e),o=h(0),f=()=>{o.value=a.value.length||0,a.value.push({})},r=s=>{let p=0;a.value.forEach((y,_)=>{y.key===s&&(p=_-1)}),a.value=a.value.filter(y=>y.key!==s),a.value.length&&o.value===s&&(p>=0?o.value=a.value[p].key:o.value=a.value[0].key)},i=(s,p)=>{p==="add"?f():r(s)};return(s,p)=>{const y=X,_=Y;return c(),x("div",de,[g(_,{activeKey:o.value,"onUpdate:activeKey":p[0]||(p[0]=u=>o.value=u),type:"editable-card",onEdit:i,class:"config-array-tab"},{default:v(()=>[(c(!0),x(E,null,B(d(a),(u,b)=>(c(),m(y,{key:b+1,tab:`${d(t)}${b+1}`,closable:d(n)},{default:v(()=>[g(q,{schema:s.schema,data:d(a)[b],"onUpdate:data":z=>d(a)[b]=z},null,8,["schema","data","onUpdate:data"])]),_:2},1032,["tab","closable"]))),128))]),_:1},8,["activeKey"])])}}}),me=S("div",{class:"iconfont icon-brackets-curly"},null,-1),P=w({__name:"ConfigInput",props:A({compact:{type:Boolean,default:!0},size:{default:"default"}},{data:{required:!0,default:{_value:"",_mode:"static",_dynExp:""}},dataModifiers:{}}),emits:["update:data"],setup(l){const e=j(l,"data"),t=l,{size:n,compact:a}=I(t),o=D(()=>e.value._mode==="dynamic"),f=()=>{e.value._mode=e.value._mode==="dynamic"?"static":"dynamic"},r=i=>{e.value._mode==="dynamic"?e.value._dynExp=i.target.value:e.value._value=i.target.value};return(i,s)=>{const p=V,y=C,_=Z;return c(),m(_,{size:d(n),compact:d(a)},{default:v(()=>[g(p,M({value:o.value?e.value._dynExp:e.value._value,onChange:r,style:{width:"calc(100% - 35px)"},prefix:o.value?"{":"",suffix:o.value?"}":""},i.$attrs),null,16,["value","prefix","suffix"]),g(y,{title:o.value?`绑定中:${e.value._dynExp}`:"变量绑定",type:o.value?"primary":"",onClick:s[0]||(s[0]=u=>f())},{icon:v(()=>[me]),_:1},8,["title","type"])]),_:1},8,["size","compact"])}}}),_e=l=>(L("data-v-8fc419f7"),l=l(),U(),l),ve={class:"config-radio"},ye=_e(()=>S("div",{class:"iconfont icon-brackets-curly"},null,-1)),fe=w({__name:"ConfigRadio",props:A({options:{default:()=>[]},fields:{default:()=>({label:"label",value:"value",title:"title"})},icon:{type:Boolean,default:!1}},{data:{required:!0,default:{_value:"",_mode:"static",_dynExp:""}},dataModifiers:{}}),emits:["update:data"],setup(l){const e=j(l,"data"),t=l,{options:n,fields:a}=I(t),o=D(()=>e.value._mode==="dynamic"),f=()=>{e.value._mode=e.value._mode==="dynamic"?"static":"dynamic"};return(r,i)=>{const s=te,p=ae,y=V,_=C;return c(),x("div",ve,[o.value?(c(),m(y,{key:1,value:e.value._dynExp,"onUpdate:value":i[1]||(i[1]=u=>e.value._dynExp=u),style:{width:"calc(100% - 35px)"},prefix:"{",suffix:"}"},null,8,["value"])):(c(),m(p,M({key:0},r.$attrs,{style:{width:"calc(100% - 35px)"},value:e.value._value,"onUpdate:value":i[0]||(i[0]=u=>e.value._value=u),"button-style":"solid"}),{default:v(()=>[(c(!0),x(E,null,B(d(n),u=>(c(),m(s,{key:u[d(a).value],title:u[d(a).title]||u[d(a).label],value:u[d(a).value]},{default:v(()=>[r.icon?(c(),x("div",{key:0,class:ee(["iconfont",u.label])},null,2)):(c(),x(E,{key:1},[$(F(u[d(a).label]),1)],64))]),_:2},1032,["title","value"]))),128))]),_:1},16,["value"])),g(_,{title:o.value?`绑定中:${e.value._dynExp}`:"变量绑定",type:o.value?"primary":"",onClick:i[2]||(i[2]=u=>f())},{icon:v(()=>[ye]),_:1},8,["title","type"])])}}}),he=T(fe,[["__scopeId","data-v-8fc419f7"]]),be=l=>(L("data-v-dcd1c0f1"),l=l(),U(),l),ge={class:"config-select"},xe=be(()=>S("div",{class:"iconfont icon-brackets-curly"},null,-1)),ke=w({__name:"ConfigSelect",props:{data:{required:!0,default:{_value:"",_mode:"static",_dynExp:""}},dataModifiers:{}},emits:["update:data"],setup(l){const e=j(l,"data"),t=D(()=>e.value._mode==="dynamic"),n=()=>{e.value._mode=e.value._mode==="dynamic"?"static":"dynamic"};return(a,o)=>{const f=ne,r=V,i=C;return c(),x("div",ge,[t.value?(c(),m(r,{key:1,value:e.value._dynExp,"onUpdate:value":o[1]||(o[1]=s=>e.value._dynExp=s),style:{width:"calc(100% - 35px)"},prefix:"{",suffix:"}"},null,8,["value"])):(c(),m(f,M({key:0,style:{width:"calc(100% - 35px)"}},a.$attrs,{value:e.value._value,"onUpdate:value":o[0]||(o[0]=s=>e.value._value=s)}),null,16,["value"])),g(i,{title:t.value?`绑定中:${e.value._dynExp}`:"变量绑定",type:t.value?"primary":"",onClick:o[2]||(o[2]=s=>n())},{icon:v(()=>[xe]),_:1},8,["title","type"])])}}}),we=T(ke,[["__scopeId","data-v-dcd1c0f1"]]),Ee=l=>(L("data-v-4206e5c3"),l=l(),U(),l),Se={class:"config-switch"},Ce=Ee(()=>S("div",{class:"iconfont icon-brackets-curly"},null,-1)),$e=w({__name:"ConfigSwitch",props:{data:{required:!0,default:{__value:!1,_mode:"static",_dynExp:""}},dataModifiers:{}},emits:["update:data"],setup(l){const e=j(l,"data"),t=D(()=>e.value._mode==="dynamic"),n=()=>{e.value._mode=e.value._mode==="dynamic"?"static":"dynamic"};return(a,o)=>{const f=oe,r=V,i=C;return c(),x("div",Se,[t.value?(c(),m(r,{key:1,value:e.value._dynExp,"onUpdate:value":o[1]||(o[1]=s=>e.value._dynExp=s),style:{width:"calc(100% - 35px)"},prefix:"{",suffix:"}"},null,8,["value"])):(c(),m(f,M({key:0},a.$attrs,{checked:e.value._value,"onUpdate:checked":o[0]||(o[0]=s=>e.value._value=s)}),null,16,["checked"])),g(i,{title:t.value?`绑定中:${e.value._dynExp}`:"变量绑定",type:t.value?"primary":"",onClick:o[2]||(o[2]=s=>n())},{icon:v(()=>[Ce]),_:1},8,["title","type"])])}}}),Ne=T($e,[["__scopeId","data-v-4206e5c3"]]),q=w({__name:"ConfigForm",props:{schema:{default:()=>({})},data:{default:()=>({})}},setup(l){const e=l,{schema:t,data:n}=I(e),a=()=>{Object.keys(t.value).forEach(r=>{n.value[r]||(n.value[r]=o(t.value[r].type))})},o=r=>{switch(r){case"array":return[];case"object":return{};case"input":case"select":case"radio":return{_value:"",_mode:"static",_dynExp:""};case"switch":return{_value:!1,_mode:"static",_dynExp:""};default:return{_value:"",_mode:"static",_dynExp:""}}};a();const f=r=>{switch(r){case"input":return P;case"radio":return he;case"select":return we;case"switch":return Ne;default:return P}};return(r,i)=>{const s=se("config-form",!0),p=ce,y=le;return c(),m(y,{model:d(n)},{default:v(()=>[(c(!0),x(E,null,B(d(t),(_,u)=>(c(),m(p,{key:u,label:_.label,name:u},{default:v(()=>[_.type==="object"?(c(),m(s,{key:0,schema:_.properties,data:d(n)[u]},null,8,["schema","data"])):_.type==="array"?(c(),m(pe,{key:1,schema:_.items,data:d(n)[u]},null,8,["schema","data"])):(c(),m(N(f(_.type)),{key:2,data:d(n)[u],"onUpdate:data":b=>d(n)[u]=b},null,40,["data","onUpdate:data"]))]),_:2},1032,["label","name"]))),128))]),_:1},8,["model"])}}}),Ve=w({__name:"HomeView",setup(l){const e=h({}),t=h({input:{type:"input",label:"输入框"},select:{type:"select",label:"选择框"},arr:{type:"array",label:"数组",items:{title:{type:"input",label:"标题"}}},arr2:{type:"array",label:"数组",items:{test:{type:"input",label:"测试"}}},test:{type:"object",label:"测试对象",properties:{a:{type:"input",label:"a"},b:{type:"input",label:"b"}}}}),n=h({string:"配置表单",arr:[1,2,3,4],number:125654});h([{label:"1",value:"1"},{label:"2",value:"2"}]),h([{label:"icon-lock1",value:"1",title:"锁定"},{label:"icon-unlock1",value:"2",title:"解锁"}]);const a=h(!1),o=()=>{e.value,a.value=!0},f=()=>{new re(n.value).processObject(e.value)},r=h("测试");h({package:"ConfigInput",version:"",exportName:"",main:"",cdn:"",componentName:""});const i=[{title:"element",package:"element-plus",version:"1.0.2",exportName:"ElementPlus",urls:["https://cdn.jsdelivr.net/npm/element-plus@2.9.2/dist/index.full.min.js","https://cdn.jsdelivr.net/npm/element-plus@2.9.2/dist/index.min.css"],children:[{componentName:"ElButton",exportName:"ElButton"},{componentName:"ElInput",exportName:"ElInput"}]},{title:"",package:"drag-grid-layout-v3",version:"1.0.0",exportName:"drag-grid-layout-v3",children:[{componentName:"GridLayout",exportName:"GridLayout"}],urls:["https://cdn.jsdelivr.net/npm/drag-grid-layout-v3@0.0.4/lib/drag-grid-layout-v3.umd.js","https://cdn.jsdelivr.net/npm/drag-grid-layout-v3@0.0.4/lib/style.css"]}],s=h(),p=h(),y=h(),_=new ie(i),u=h([{key:1,id:1,rowStart:1,colStart:1,rowSpan:20,colSpan:3,extra:{color:"red"}},{key:1,id:2,rowStart:2,colStart:4,rowSpan:40,colSpan:2,extra:{color:"blue"}},{key:1,id:3,rowStart:4,colStart:6,rowSpan:10,colSpan:5,extra:{color:"pink"}},{key:1,id:4,rowStart:5,colStart:1,rowSpan:30,colSpan:6,extra:{color:"green"}}]);return _.load().then(b=>{s.value=b.ElButton,p.value=b.ElInput,y.value=b.GridLayout}),(b,z)=>{const R=J,G=C;return c(),x(E,null,[g(R,{value:JSON.stringify(n.value,null,4),disabled:""},null,8,["value"]),g(q,{data:e.value,schema:t.value},null,8,["data","schema"]),g(G,{onClick:o},{default:v(()=>[$("配置项")]),_:1}),g(G,{onClick:f},{default:v(()=>[$("数据")]),_:1}),(c(),m(N(s.value),{type:"success"},{default:v(()=>[$("el")]),_:1})),(c(),m(N(p.value),{placeholder:"请输入内容",Value:r.value},null,8,["Value"])),(c(),m(N(y.value),{placeholder:"请输入内容",list:u.value},{"layout-item":v(({item:O})=>[S("div",{style:ue({backgroundColor:O.extra.color,width:"100%",height:"100%"})},F(O),5)]),_:1},8,["list"]))],64)}}});export{Ve as default};
