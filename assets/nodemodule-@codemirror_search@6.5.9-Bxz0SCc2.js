import{E as x,V as Z,c as q,D as d,d as ee,r as me}from"./nodemodule-@codemirror_view@6.36.3-NX7sJwro.js";import{b as te,S as W,P as pe,E as g,F as re,e as ne,c as ge,d as xe,f as Se,C as p,l as ye,m as Me,i as se}from"./nodemodule-@codemirror_state@6.5.2-CeTbMir1.js";import{c as u}from"./nodemodule-crelt@1.0.6-C8TCjufn.js";const J=typeof String.prototype.normalize=="function"?r=>r.normalize("NFKD"):r=>r;class b{constructor(e,t,n=0,s=e.length,i,l){this.test=l,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(n,s),this.bufferStart=n,this.normalize=i?o=>i(J(o)):J,this.query=this.normalize(t)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return ge(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let t=Se(e),n=this.bufferStart+this.bufferPos;this.bufferPos+=xe(e);let s=this.normalize(t);if(s.length)for(let i=0,l=n;;i++){let o=s.charCodeAt(i),c=this.match(o,l,this.bufferPos+this.bufferStart);if(i==s.length-1){if(c)return this.value=c,this;break}l==n&&i<t.length&&t.charCodeAt(i)==o&&l++}}}match(e,t,n){let s=null;for(let i=0;i<this.matches.length;i+=2){let l=this.matches[i],o=!1;this.query.charCodeAt(l)==e&&(l==this.query.length-1?s={from:this.matches[i+1],to:n}:(this.matches[i]++,o=!0)),o||(this.matches.splice(i,2),i-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?s={from:t,to:n}:this.matches.push(1,t)),s&&this.test&&!this.test(s.from,s.to,this.buffer,this.bufferStart)&&(s=null),s}}typeof Symbol<"u"&&(b.prototype[Symbol.iterator]=function(){return this});const ie={from:-1,to:-1,match:/.*/.exec("")},N="gm"+(/x/.unicode==null?"":"u");class le{constructor(e,t,n,s=0,i=e.length){if(this.text=e,this.to=i,this.curLine="",this.done=!1,this.value=ie,/\\[sWDnr]|\n|\r|\[\^/.test(t))return new oe(e,t,n,s,i);this.re=new RegExp(t,N+(n!=null&&n.ignoreCase?"i":"")),this.test=n==null?void 0:n.test,this.iter=e.iter();let l=e.lineAt(s);this.curLineStart=l.from,this.matchPos=R(e,s),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){let n=this.curLineStart+t.index,s=n+t[0].length;if(this.matchPos=R(this.text,s+(n==s?1:0)),n==this.curLineStart+this.curLine.length&&this.nextLine(),(n<s||n>this.value.to)&&(!this.test||this.test(n,s,t)))return this.value={from:n,to:s,match:t},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const Q=new WeakMap;class v{constructor(e,t){this.from=e,this.text=t}get to(){return this.from+this.text.length}static get(e,t,n){let s=Q.get(e);if(!s||s.from>=n||s.to<=t){let o=new v(t,e.sliceString(t,n));return Q.set(e,o),o}if(s.from==t&&s.to==n)return s;let{text:i,from:l}=s;return l>t&&(i=e.sliceString(t,l)+i,l=t),s.to<n&&(i+=e.sliceString(s.to,n)),Q.set(e,new v(l,i)),new v(t,i.slice(t-l,n-l))}}class oe{constructor(e,t,n,s,i){this.text=e,this.to=i,this.done=!1,this.value=ie,this.matchPos=R(e,s),this.re=new RegExp(t,N+(n!=null&&n.ignoreCase?"i":"")),this.test=n==null?void 0:n.test,this.flat=v.get(e,s,this.chunkEnd(s+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,t=this.re.exec(this.flat.text);if(t&&!t[0]&&t.index==e&&(this.re.lastIndex=e+1,t=this.re.exec(this.flat.text)),t){let n=this.flat.from+t.index,s=n+t[0].length;if((this.flat.to>=this.to||t.index+t[0].length<=this.flat.text.length-10)&&(!this.test||this.test(n,s,t)))return this.value={from:n,to:s,match:t},this.matchPos=R(this.text,s+(n==s?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=v.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(le.prototype[Symbol.iterator]=oe.prototype[Symbol.iterator]=function(){return this});function ve(r){try{return new RegExp(r,N),!0}catch{return!1}}function R(r,e){if(e>=r.length)return e;let t=r.lineAt(e),n;for(;e<t.to&&(n=t.text.charCodeAt(e-t.from))>=56320&&n<57344;)e++;return e}function _(r){let e=String(r.state.doc.lineAt(r.state.selection.main.head).number),t=u("input",{class:"cm-textfield",name:"line",value:e}),n=u("form",{class:"cm-gotoLine",onkeydown:i=>{i.keyCode==27?(i.preventDefault(),r.dispatch({effects:P.of(!1)}),r.focus()):i.keyCode==13&&(i.preventDefault(),s())},onsubmit:i=>{i.preventDefault(),s()}},u("label",r.state.phrase("Go to line"),": ",t)," ",u("button",{class:"cm-button",type:"submit"},r.state.phrase("go")));function s(){let i=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(t.value);if(!i)return;let{state:l}=r,o=l.doc.lineAt(l.selection.main.head),[,c,a,h,m]=i,A=h?+h.slice(1):0,k=a?+a:o.number;if(a&&m){let O=k/100;c&&(O=O*(c=="-"?-1:1)+o.number/l.doc.lines),k=Math.round(l.doc.lines*O)}else a&&c&&(k=k*(c=="-"?-1:1)+o.number);let G=l.doc.line(Math.max(1,Math.min(l.doc.lines,k))),j=g.cursor(G.from+Math.max(0,Math.min(A,G.length)));r.dispatch({effects:[P.of(!1),x.scrollIntoView(j.from,{y:"center"})],selection:j}),r.focus()}return{dom:n}}const P=W.define(),U=te.define({create(){return!0},update(r,e){for(let t of e.effects)t.is(P)&&(r=t.value);return r},provide:r=>ee.from(r,e=>e?_:null)}),be=r=>{let e=q(r,_);if(!e){let t=[P.of(!0)];r.state.field(U,!1)==null&&t.push(W.appendConfig.of([U,Ce])),r.dispatch({effects:t}),e=q(r,_)}return e&&e.dom.querySelector("input").select(),!0},Ce=x.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),ke={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},Le=re.define({combine(r){return ne(r,ke,{highlightWordAroundCursor:(e,t)=>e||t,minSelectionLength:Math.min,maxMatches:Math.min})}});function Ue(r){return[Fe,De]}const We=d.mark({class:"cm-selectionMatch"}),Ee=d.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function X(r,e,t,n){return(t==0||r(e.sliceDoc(t-1,t))!=p.Word)&&(n==e.doc.length||r(e.sliceDoc(n,n+1))!=p.Word)}function Ae(r,e,t,n){return r(e.sliceDoc(t,t+1))==p.Word&&r(e.sliceDoc(n-1,n))==p.Word}const De=Z.fromClass(class{constructor(r){this.decorations=this.getDeco(r)}update(r){(r.selectionSet||r.docChanged||r.viewportChanged)&&(this.decorations=this.getDeco(r.view))}getDeco(r){let e=r.state.facet(Le),{state:t}=r,n=t.selection;if(n.ranges.length>1)return d.none;let s=n.main,i,l=null;if(s.empty){if(!e.highlightWordAroundCursor)return d.none;let c=t.wordAt(s.head);if(!c)return d.none;l=t.charCategorizer(s.head),i=t.sliceDoc(c.from,c.to)}else{let c=s.to-s.from;if(c<e.minSelectionLength||c>200)return d.none;if(e.wholeWords){if(i=t.sliceDoc(s.from,s.to),l=t.charCategorizer(s.head),!(X(l,t,s.from,s.to)&&Ae(l,t,s.from,s.to)))return d.none}else if(i=t.sliceDoc(s.from,s.to),!i)return d.none}let o=[];for(let c of r.visibleRanges){let a=new b(t.doc,i,c.from,c.to);for(;!a.next().done;){let{from:h,to:m}=a.value;if((!l||X(l,t,h,m))&&(s.empty&&h<=s.from&&m>=s.to?o.push(Ee.range(h,m)):(h>=s.to||m<=s.from)&&o.push(We.range(h,m)),o.length>e.maxMatches))return d.none}}return d.set(o)}},{decorations:r=>r.decorations}),Fe=x.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),qe=({state:r,dispatch:e})=>{let{selection:t}=r,n=g.create(t.ranges.map(s=>r.wordAt(s.head)||g.cursor(s.head)),t.mainIndex);return n.eq(t)?!1:(e(r.update({selection:n})),!0)};function Re(r,e){let{main:t,ranges:n}=r.selection,s=r.wordAt(t.head),i=s&&s.from==t.from&&s.to==t.to;for(let l=!1,o=new b(r.doc,e,n[n.length-1].to);;)if(o.next(),o.done){if(l)return null;o=new b(r.doc,e,0,Math.max(0,n[n.length-1].from-1)),l=!0}else{if(l&&n.some(c=>c.from==o.value.from))continue;if(i){let c=r.wordAt(o.value.from);if(!c||c.from!=o.value.from||c.to!=o.value.to)continue}return o.value}}const Pe=({state:r,dispatch:e})=>{let{ranges:t}=r.selection;if(t.some(i=>i.from===i.to))return qe({state:r,dispatch:e});let n=r.sliceDoc(t[0].from,t[0].to);if(r.selection.ranges.some(i=>r.sliceDoc(i.from,i.to)!=n))return!1;let s=Re(r,n);return s?(e(r.update({selection:r.selection.addRange(g.range(s.from,s.to),!1),effects:x.scrollIntoView(s.to)})),!0):!1},C=re.define({combine(r){return ne(r,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new Ve(e),scrollToMatch:e=>x.scrollIntoView(e)})}});class ce{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||ve(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(t,n)=>n=="n"?`
`:n=="r"?"\r":n=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new $e(this):new we(this)}getCursor(e,t=0,n){let s=e.doc?e:ye.create({doc:e});return n==null&&(n=s.doc.length),this.regexp?M(this,s,t,n):y(this,s,t,n)}}class ae{constructor(e){this.spec=e}}function y(r,e,t,n){return new b(e.doc,r.unquoted,t,n,r.caseSensitive?void 0:s=>s.toLowerCase(),r.wholeWord?Ie(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function Ie(r,e){return(t,n,s,i)=>((i>t||i+s.length<n)&&(i=Math.max(0,t-2),s=r.sliceString(i,Math.min(r.length,n+2))),(e(I(s,t-i))!=p.Word||e(w(s,t-i))!=p.Word)&&(e(w(s,n-i))!=p.Word||e(I(s,n-i))!=p.Word))}class we extends ae{constructor(e){super(e)}nextMatch(e,t,n){let s=y(this.spec,e,n,e.doc.length).nextOverlapping();if(s.done){let i=Math.min(e.doc.length,t+this.spec.unquoted.length);s=y(this.spec,e,0,i).nextOverlapping()}return s.done||s.value.from==t&&s.value.to==n?null:s.value}prevMatchInRange(e,t,n){for(let s=n;;){let i=Math.max(t,s-1e4-this.spec.unquoted.length),l=y(this.spec,e,i,s),o=null;for(;!l.nextOverlapping().done;)o=l.value;if(o)return o;if(i==t)return null;s-=1e4}}prevMatch(e,t,n){let s=this.prevMatchInRange(e,0,t);return s||(s=this.prevMatchInRange(e,Math.max(0,n-this.spec.unquoted.length),e.doc.length)),s&&(s.from!=t||s.to!=n)?s:null}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,t){let n=y(this.spec,e,0,e.doc.length),s=[];for(;!n.next().done;){if(s.length>=t)return null;s.push(n.value)}return s}highlight(e,t,n,s){let i=y(this.spec,e,Math.max(0,t-this.spec.unquoted.length),Math.min(n+this.spec.unquoted.length,e.doc.length));for(;!i.next().done;)s(i.value.from,i.value.to)}}function M(r,e,t,n){return new le(e.doc,r.search,{ignoreCase:!r.caseSensitive,test:r.wholeWord?Te(e.charCategorizer(e.selection.main.head)):void 0},t,n)}function I(r,e){return r.slice(se(r,e,!1),e)}function w(r,e){return r.slice(e,se(r,e))}function Te(r){return(e,t,n)=>!n[0].length||(r(I(n.input,n.index))!=p.Word||r(w(n.input,n.index))!=p.Word)&&(r(w(n.input,n.index+n[0].length))!=p.Word||r(I(n.input,n.index+n[0].length))!=p.Word)}class $e extends ae{nextMatch(e,t,n){let s=M(this.spec,e,n,e.doc.length).next();return s.done&&(s=M(this.spec,e,0,t).next()),s.done?null:s.value}prevMatchInRange(e,t,n){for(let s=1;;s++){let i=Math.max(t,n-s*1e4),l=M(this.spec,e,i,n),o=null;for(;!l.next().done;)o=l.value;if(o&&(i==t||o.from>i+10))return o;if(i==t)return null}}prevMatch(e,t,n){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,n,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&]|\d+)/g,(t,n)=>{if(n=="&")return e.match[0];if(n=="$")return"$";for(let s=n.length;s>0;s--){let i=+n.slice(0,s);if(i>0&&i<e.match.length)return e.match[i]+n.slice(s)}return t})}matchAll(e,t){let n=M(this.spec,e,0,e.doc.length),s=[];for(;!n.next().done;){if(s.length>=t)return null;s.push(n.value)}return s}highlight(e,t,n,s){let i=M(this.spec,e,Math.max(0,t-250),Math.min(n+250,e.doc.length));for(;!i.next().done;)s(i.value.from,i.value.to)}}const L=W.define(),V=W.define(),S=te.define({create(r){return new z(B(r).create(),null)},update(r,e){for(let t of e.effects)t.is(L)?r=new z(t.value.create(),r.panel):t.is(V)&&(r=new z(r.query,t.value?H:null));return r},provide:r=>ee.from(r,e=>e.panel)});class z{constructor(e,t){this.query=e,this.panel=t}}const Oe=d.mark({class:"cm-searchMatch"}),Qe=d.mark({class:"cm-searchMatch cm-searchMatch-selected"}),ze=Z.fromClass(class{constructor(r){this.view=r,this.decorations=this.highlight(r.state.field(S))}update(r){let e=r.state.field(S);(e!=r.startState.field(S)||r.docChanged||r.selectionSet||r.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:r,panel:e}){if(!e||!r.spec.valid)return d.none;let{view:t}=this,n=new Me;for(let s=0,i=t.visibleRanges,l=i.length;s<l;s++){let{from:o,to:c}=i[s];for(;s<l-1&&c>i[s+1].from-2*250;)c=i[++s].to;r.highlight(t.state,o,c,(a,h)=>{let m=t.state.selection.ranges.some(A=>A.from==a&&A.to==h);n.add(a,h,m?Qe:Oe)})}return n.finish()}},{decorations:r=>r.decorations});function E(r){return e=>{let t=e.state.field(S,!1);return t&&t.query.spec.valid?r(e,t):fe(e)}}const T=E((r,{query:e})=>{let{to:t}=r.state.selection.main,n=e.nextMatch(r.state,t,t);if(!n)return!1;let s=g.single(n.from,n.to),i=r.state.facet(C);return r.dispatch({selection:s,effects:[K(r,n),i.scrollToMatch(s.main,r)],userEvent:"select.search"}),ue(r),!0}),$=E((r,{query:e})=>{let{state:t}=r,{from:n}=t.selection.main,s=e.prevMatch(t,n,n);if(!s)return!1;let i=g.single(s.from,s.to),l=r.state.facet(C);return r.dispatch({selection:i,effects:[K(r,s),l.scrollToMatch(i.main,r)],userEvent:"select.search"}),ue(r),!0}),_e=E((r,{query:e})=>{let t=e.matchAll(r.state,1e3);return!t||!t.length?!1:(r.dispatch({selection:g.create(t.map(n=>g.range(n.from,n.to))),userEvent:"select.search.matches"}),!0)}),Be=({state:r,dispatch:e})=>{let t=r.selection;if(t.ranges.length>1||t.main.empty)return!1;let{from:n,to:s}=t.main,i=[],l=0;for(let o=new b(r.doc,r.sliceDoc(n,s));!o.next().done;){if(i.length>1e3)return!1;o.value.from==n&&(l=i.length),i.push(g.range(o.value.from,o.value.to))}return e(r.update({selection:g.create(i,l),userEvent:"select.search.matches"})),!0},Y=E((r,{query:e})=>{let{state:t}=r,{from:n,to:s}=t.selection.main;if(t.readOnly)return!1;let i=e.nextMatch(t,n,n);if(!i)return!1;let l=i,o=[],c,a,h=[];if(l.from==n&&l.to==s&&(a=t.toText(e.getReplacement(l)),o.push({from:l.from,to:l.to,insert:a}),l=e.nextMatch(t,l.from,l.to),h.push(x.announce.of(t.phrase("replaced match on line $",t.doc.lineAt(n).number)+"."))),l){let m=o.length==0||o[0].from>=i.to?0:i.to-i.from-a.length;c=g.single(l.from-m,l.to-m),h.push(K(r,l)),h.push(t.facet(C).scrollToMatch(c.main,r))}return r.dispatch({changes:o,selection:c,effects:h,userEvent:"input.replace"}),!0}),Ne=E((r,{query:e})=>{if(r.state.readOnly)return!1;let t=e.matchAll(r.state,1e9).map(s=>{let{from:i,to:l}=s;return{from:i,to:l,insert:e.getReplacement(s)}});if(!t.length)return!1;let n=r.state.phrase("replaced $ matches",t.length)+".";return r.dispatch({changes:t,effects:x.announce.of(n),userEvent:"input.replace.all"}),!0});function H(r){return r.state.facet(C).createPanel(r)}function B(r,e){var t,n,s,i,l;let o=r.selection.main,c=o.empty||o.to>o.from+100?"":r.sliceDoc(o.from,o.to);if(e&&!c)return e;let a=r.facet(C);return new ce({search:((t=e==null?void 0:e.literal)!==null&&t!==void 0?t:a.literal)?c:c.replace(/\n/g,"\\n"),caseSensitive:(n=e==null?void 0:e.caseSensitive)!==null&&n!==void 0?n:a.caseSensitive,literal:(s=e==null?void 0:e.literal)!==null&&s!==void 0?s:a.literal,regexp:(i=e==null?void 0:e.regexp)!==null&&i!==void 0?i:a.regexp,wholeWord:(l=e==null?void 0:e.wholeWord)!==null&&l!==void 0?l:a.wholeWord})}function he(r){let e=q(r,H);return e&&e.dom.querySelector("[main-field]")}function ue(r){let e=he(r);e&&e==r.root.activeElement&&e.select()}const fe=r=>{let e=r.state.field(S,!1);if(e&&e.panel){let t=he(r);if(t&&t!=r.root.activeElement){let n=B(r.state,e.query.spec);n.valid&&r.dispatch({effects:L.of(n)}),t.focus(),t.select()}}else r.dispatch({effects:[V.of(!0),e?L.of(B(r.state,e.query.spec)):W.appendConfig.of(Ke)]});return!0},de=r=>{let e=r.state.field(S,!1);if(!e||!e.panel)return!1;let t=q(r,H);return t&&t.dom.contains(r.root.activeElement)&&r.focus(),r.dispatch({effects:V.of(!1)}),!0},Xe=[{key:"Mod-f",run:fe,scope:"editor search-panel"},{key:"F3",run:T,shift:$,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:T,shift:$,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:de,scope:"editor search-panel"},{key:"Mod-Shift-l",run:Be},{key:"Mod-Alt-g",run:be},{key:"Mod-d",run:Pe,preventDefault:!0}];class Ve{constructor(e){this.view=e;let t=this.query=e.state.field(S).query.spec;this.commit=this.commit.bind(this),this.searchField=u("input",{value:t.search,placeholder:f(e,"Find"),"aria-label":f(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=u("input",{value:t.replace,placeholder:f(e,"Replace"),"aria-label":f(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=u("input",{type:"checkbox",name:"case",form:"",checked:t.caseSensitive,onchange:this.commit}),this.reField=u("input",{type:"checkbox",name:"re",form:"",checked:t.regexp,onchange:this.commit}),this.wordField=u("input",{type:"checkbox",name:"word",form:"",checked:t.wholeWord,onchange:this.commit});function n(s,i,l){return u("button",{class:"cm-button",name:s,onclick:i,type:"button"},l)}this.dom=u("div",{onkeydown:s=>this.keydown(s),class:"cm-search"},[this.searchField,n("next",()=>T(e),[f(e,"next")]),n("prev",()=>$(e),[f(e,"previous")]),n("select",()=>_e(e),[f(e,"all")]),u("label",null,[this.caseField,f(e,"match case")]),u("label",null,[this.reField,f(e,"regexp")]),u("label",null,[this.wordField,f(e,"by word")]),...e.state.readOnly?[]:[u("br"),this.replaceField,n("replace",()=>Y(e),[f(e,"replace")]),n("replaceAll",()=>Ne(e),[f(e,"replace all")])],u("button",{name:"close",onclick:()=>de(e),"aria-label":f(e,"close"),type:"button"},["×"])])}commit(){let e=new ce({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:L.of(e)}))}keydown(e){me(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?$:T)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),Y(this.view))}update(e){for(let t of e.transactions)for(let n of t.effects)n.is(L)&&!n.value.eq(this.query)&&this.setQuery(n.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(C).top}}function f(r,e){return r.state.phrase(e)}const D=30,F=/[\s\.,:;?!]/;function K(r,{from:e,to:t}){let n=r.state.doc.lineAt(e),s=r.state.doc.lineAt(t).to,i=Math.max(n.from,e-D),l=Math.min(s,t+D),o=r.state.sliceDoc(i,l);if(i!=n.from){for(let c=0;c<D;c++)if(!F.test(o[c+1])&&F.test(o[c])){o=o.slice(c);break}}if(l!=s){for(let c=o.length-1;c>o.length-D;c--)if(!F.test(o[c-1])&&F.test(o[c])){o=o.slice(0,c);break}}return x.announce.of(`${r.state.phrase("current match")}. ${o} ${r.state.phrase("on line")} ${n.number}.`)}const He=x.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),Ke=[S,pe.low(ze),He];export{Ue as h,Xe as s};
