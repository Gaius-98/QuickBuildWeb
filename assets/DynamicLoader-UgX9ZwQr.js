var r=Object.defineProperty;var a=(o,t,e)=>t in o?r(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var i=(o,t,e)=>(a(o,typeof t!="symbol"?t+"":t,e),e);import{V as m}from"./.pnpm-CQCJb2bg.js";class h{constructor(t){i(this,"libs");i(this,"scripts",[]);i(this,"styles",[]);i(this,"componentsMap",new Map);i(this,"components",{});this.libs=t,this.init()}init(){window.Vue||(window.Vue=m),this.handleLibs(),this.handleUrls()}handleUrls(){this.libs.map(e=>e.urls).flat().forEach(e=>{e.endsWith("js")?this.scripts.push(e):e.endsWith("css")&&this.styles.push(e)})}load(){return new Promise((t,e)=>{Promise.allSettled([...this.styles.map(s=>this.loadStyle(s)),...this.scripts.map(s=>this.loadScript(s))]).then(()=>{this.registerComponents(),t(this.components)}).catch(s=>{e(s)})})}registerComponents(){for(const[t,e]of this.componentsMap)Array.isArray(e)?e.forEach(s=>{this.components[s.componentName]=window[t][s.exportName]}):this.components[e.componentName]=window[e.exportName]}handleLibChildren(t){const e=t.children.map(s=>({exportName:s.exportName,componentName:s.componentName}));this.componentsMap.set(t.exportName,e)}handleLibs(t=this.libs){t.forEach(e=>{this.isLibTree(e)?this.handleLibChildren(e):this.componentsMap.set(e.exportName,{exportName:e.exportName,componentName:e.componentName})})}isLibTree(t){return"children"in t}loadScript(t){return new Promise((e,s)=>{const n=document.createElement("script");n.src=t,n.async=!1,n.onload=e,n.onerror=s,document.body.appendChild(n)})}loadStyle(t){return new Promise((e,s)=>{const n=document.createElement("link");n.rel="stylesheet",n.href=t,n.onload=e,n.onerror=s,document.head.appendChild(n)})}}export{h as D};
