import{a as k,c as ne}from"./iconfont-D1HCqb49.js";import{a as re}from"./menu-CqVG9N7D.js";import{g as se,M as ue,F as de,h as ie,I as me,B as pe,i as ce,T as _e,j as ve,k as fe,o as ye,q as ge,e as ke,u as he,a as O}from"./nodemodule-ant-design-vue@4.1.2_vue@3.4.21-D4V-KPiA.js";import{d as be,b as R,q as xe,K as C,c as a,aI as t,G as u,M as V,y as F,a2 as c,N as h,F as I,z as Ce,L as d}from"./nodemodule-@vue_runtime-core@3.4.21-Cnn673wu.js";import{a as we,r as i}from"./nodemodule-@vue_reactivity@3.4.21-DbkE7Gi6.js";import{_ as Ne}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./nodemodule-axios@1.6.8-BZ84_VUH.js";import"./nodemodule-js-cookie@3.0.5-Cz0CWeBA.js";import"./nodemodule-vue-router@4.3.0_vue@3.4.21-BC_007Jj.js";import"./nodemodule-@babel_runtime@7.27.1-Bq4_u9L9.js";import"./nodemodule-@vue_runtime-dom@3.4.21-CDjXREoQ.js";import"./nodemodule-@vue_shared@3.4.21-Ctf17_ps.js";import"./nodemodule-@ant-design_icons-vue@7.0.1_vue@3.4.21-CO80cFpd.js";import"./nodemodule-@ant-design_icons-svg@4.4.2-C9VH68wD.js";import"./nodemodule-@ant-design_colors@6.0.0-CBJ--Aym.js";import"./nodemodule-@ctrl_tinycolor@3.6.1-DOFZgDuz.js";import"./nodemodule-lodash-es@4.17.21-DcfALcKD.js";import"./nodemodule-resize-observer-polyfill@1.5.1-B1PUzC5B.js";import"./nodemodule-dayjs@1.11.13-B6I98uus.js";import"./nodemodule-classnames@2.5.1-BK5ccKcQ.js";import"./nodemodule-throttle-debounce@5.0.2-CUWDS_la.js";import"./nodemodule-async-validator@4.2.5-9PlIezaS.js";import"./nodemodule-scroll-into-view-if-needed@2.2.31-CLVC0ehY.js";import"./nodemodule-compute-scroll-into-view@1.0.20-1gs_hJI2.js";import"./nodemodule-vue-types@3.0.2_vue@3.4.21-CF28atMM.js";import"./nodemodule-dom-align@1.12.4-CRCehRfe.js";import"./nodemodule-@emotion_hash@0.9.2-WldOFDRm.js";import"./nodemodule-@emotion_unitless@0.8.1-sScrWPmR.js";import"./nodemodule-stylis@4.3.6-D5iaQeiq.js";const b={getList:m=>k({method:"get",url:"role/list",params:m}),getDetail:m=>k({method:"get",url:"role/detail",params:{id:m}}),remove:m=>k({method:"get",url:"role/remove",params:{id:m}}),add:m=>k({method:"post",url:"role/add",data:m}),update:m=>k({method:"post",url:"role/update",data:m})},Me={class:"role"},Fe={class:"tools"},Ie={style:{height:"150px","overflow-y":"auto"}},Te=be({__name:"RoleView",setup(m){const p=we({keyword:"",pageNumber:1,pageSize:10}),T=i([]),L=i([{title:"角色名",key:"roleName",dataIndex:"roleName",width:"200px"},{title:"状态",key:"status",dataIndex:"status",width:"100px"},{title:"备注",key:"remark",dataIndex:"remark"},{title:"创建时间",key:"createTime",dataIndex:"createTime"},{title:"操作",key:"action",dataIndex:"action",width:"250px"}]),w=i(!1),P=i(),$=()=>{var o;(o=P.value)==null||o.resetFields(),_()},S=i(0),j=()=>{p.pageNumber=1,p.pageSize=10,_()},A=o=>{const{current:e,pageSize:r}=o;p.pageNumber=e,p.pageSize=r,_()},_=()=>{w.value=!0,b.getList(p).then(o=>{const{code:e,data:r}=o;e==200&&(T.value=r.data,S.value=r.total),w.value=!1})},D=i([]);R(()=>{_(),ne.getDict(["dataPerm"]).then(o=>{const{code:e,data:r,msg:s}=o;e==200&&(D.value=r.dataPerm)})});const v=i(!1),l=i({roleName:"",roleKey:"",status:"1",remark:"",roleMenus:[],dataPerm:"1"}),f=i("add"),E=xe(()=>({add:"新增角色",edit:"编辑角色"})[f.value]),N=i(),G=()=>{f.value="add",v.value=!0,l.value={roleName:"",roleKey:"",status:"1",remark:"",roleMenus:[],dataPerm:"1"}},H=async o=>{const{code:e,data:r}=await b.getDetail(o.roleId);e==200&&(l.value=r,f.value="edit",v.value=!0)},J=async o=>{const{code:e,msg:r,data:s}=await b.remove(o.roleId);e==200&&(O.success(s),_())},K=()=>{var o;(o=N.value)==null||o.resetFields()},Q=()=>{var o;(o=N.value)==null||o.validate().then(()=>{let e;f.value=="add"?e=b.add:e=b.update,l.value.roleMenus instanceof Array||(l.value.roleMenus=l.value.roleMenus.checked),e(l.value).then(r=>{const{code:s}=r;s==200&&(O.success(f.value=="add"?"新增成功":"编辑成功"),_()),K(),v.value=!1})})},z=i([]),W=()=>{re.getAllMenu().then(o=>{const{code:e,data:r,msg:s}=o;e==200&&(z.value=r)})};return R(()=>{W()}),(o,e)=>{const r=me,s=ie,y=pe,U=de,q=se,x=_e,X=ve,Y=ce,B=ye,Z=fe,ee=ge,te=ke,ae=he,oe=ue,M=Ce("has-perm");return d(),C("div",Me,[a(q,{class:"search-area"},{default:t(()=>[a(U,{ref_key:"searchFormRef",ref:P,layout:"inline",model:p,onFinish:j},{default:t(()=>[a(s,{label:"角色名称",prop:"keyword"},{default:t(()=>[a(r,{value:p.keyword,"onUpdate:value":e[0]||(e[0]=n=>p.keyword=n)},null,8,["value"])]),_:1}),a(s,null,{default:t(()=>[a(y,{type:"primary","html-type":"submit"},{default:t(()=>[u("搜索")]),_:1}),a(y,{style:{margin:"0 8px"},onClick:$},{default:t(()=>[u(" 重置 ")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(q,null,{default:t(()=>[V("div",Fe,[F((d(),c(y,{type:"primary",onClick:G},{default:t(()=>[u("新增")]),_:1})),[[M,"system:role:add"]])]),a(Y,{loading:w.value,columns:L.value,"data-source":T.value,scroll:{y:560},onChange:A,pagination:{current:p.pageNumber,total:S.value,showSizeChanger:!0,pageSize:p.pageSize}},{bodyCell:t(({column:n,record:g})=>[n.key=="status"?(d(),C(I,{key:0},[g.status=="1"?(d(),c(x,{key:0,color:"#87d068"},{default:t(()=>[u("启用")]),_:1})):(d(),c(x,{key:1,color:"#f50"},{default:t(()=>[u("停用")]),_:1}))],64)):h("",!0),n.key=="action"?(d(),C(I,{key:1},[F((d(),c(y,{type:"link",onClick:le=>H(g)},{default:t(()=>[u("编辑")]),_:2},1032,["onClick"])),[[M,"system:role:update"]]),a(X,{title:"确定要删除吗?","ok-text":"确定","cancel-text":"取消",onConfirm:le=>J(g)},{default:t(()=>[F((d(),c(y,{type:"link",danger:""},{default:t(()=>[u("删除")]),_:1})),[[M,"system:role:remove"]])]),_:2},1032,["onConfirm"])],64)):h("",!0),n.key=="roleType"?(d(),C(I,{key:2},[g.roleType=="app"?(d(),c(x,{key:0,color:"#2db7f5"},{default:t(()=>[u("菜单")]),_:1})):h("",!0),g.roleType=="directory"?(d(),c(x,{key:1,color:"#87d068"},{default:t(()=>[u("目录")]),_:1})):h("",!0)],64)):h("",!0)]),_:1},8,["loading","columns","data-source","pagination"])]),_:1}),a(oe,{open:v.value,"onUpdate:open":e[7]||(e[7]=n=>v.value=n),onOk:Q,title:E.value,onCancel:K},{default:t(()=>[a(U,{model:l.value,"label-col":{span:8},ref_key:"modalFormRef",ref:N},{default:t(()=>[a(s,{label:"角色名",required:"",prop:"roleName"},{default:t(()=>[a(r,{value:l.value.roleName,"onUpdate:value":e[1]||(e[1]=n=>l.value.roleName=n)},null,8,["value"])]),_:1}),a(s,{label:"角色ID",required:"",prop:"roleKey"},{default:t(()=>[a(r,{value:l.value.roleKey,"onUpdate:value":e[2]||(e[2]=n=>l.value.roleKey=n)},null,8,["value"])]),_:1}),a(s,{label:"状态",required:"",prop:"status"},{default:t(()=>[a(Z,{value:l.value.status,"onUpdate:value":e[3]||(e[3]=n=>l.value.status=n),"button-style":"solid"},{default:t(()=>[a(B,{value:"1"},{default:t(()=>[u("启用 ")]),_:1}),a(B,{value:"0"},{default:t(()=>[u("停用 ")]),_:1})]),_:1},8,["value"])]),_:1}),a(s,{label:"菜单权限",prop:"roleMenus"},{default:t(()=>[V("div",Ie,[a(ee,{checkedKeys:l.value.roleMenus,"onUpdate:checkedKeys":e[4]||(e[4]=n=>l.value.roleMenus=n),"tree-data":z.value,checkStrictly:!0,checkable:"","field-names":{children:"children",title:"label",key:"id"}},null,8,["checkedKeys","tree-data"])])]),_:1}),a(s,{label:"数据权限",required:"",prop:"dataPerm"},{default:t(()=>[a(te,{value:l.value.dataPerm,"onUpdate:value":e[5]||(e[5]=n=>l.value.dataPerm=n),options:D.value},null,8,["value","options"])]),_:1}),a(s,{label:"备注",prop:"remark"},{default:t(()=>[a(ae,{value:l.value.remark,"onUpdate:value":e[6]||(e[6]=n=>l.value.remark=n),rows:5},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","title"])])}}}),nt=Ne(Te,[["__scopeId","data-v-795fb0a3"]]);export{nt as default};
