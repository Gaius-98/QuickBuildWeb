var J=Object.defineProperty;var H=(s,e,t)=>e in s?J(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var C=(s,e,t)=>(H(s,typeof e!="symbol"?e+"":e,t),t);import{_ as Q}from"./CodeEditor.vue_vue_type_script_setup_true_name_EvCode_lang-DTvU44AW.js";import{I as X,g as I,v as z,y as D,x as G,D as L,o as i,h as v,w as u,m as r,J as P,i as b,K as N,L as U,M,N as Y,z as w,O as Z,P as q,Q as F,F as B,R,A as ee,B as $,T as K,U as te,V as ae,W as ne,r as _,X as T,Y as oe,$ as le,G as O,a0 as se,a1 as ie,a2 as ue}from"./.pnpm-i8FCJJ8r.js";import{_ as W}from"./_plugin-vue_export-helper-DlAUqK2U.js";class ce{constructor(e){C(this,"state");this.state=e}getValue(e){const{_value:t,_mode:o,_dynExp:n}=e;return o==="static"?t:this.resolveDynamicValue(n)}resolveDynamicValue(e){try{return new Function("state",`return ${e}`)(this.state)}catch(t){return console.error("评估动态表达式时出错:",t),null}}isDynamicConfigData(e){return typeof e=="object"&&e!==null&&["string","number","boolean"].includes(typeof e._value)&&["static","dynamic"].includes(e._mode)}processObject(e){const t=X(e);if(Array.isArray(t))return t.map(o=>this.processObject(o));if(typeof t=="object"&&t!==null){const o={};for(const n in t){const a=t[n];this.isDynamicConfigData(a)?o[n]=this.getValue(a):typeof a=="object"&&a!==null?o[n]=this.processObject(a):o[n]=a}return o}else return t}}const re=N("div",{class:"iconfont icon-brackets-curly"},null,-1),de=I({__name:"ConfigInput",props:z({compact:{type:Boolean,default:!0},size:{default:"default"}},{data:{required:!0,default:{_value:"",_mode:"static",_dynExp:""}},dataModifiers:{}}),emits:["update:data"],setup(s){const e=D(s,"data"),t=s,{size:o,compact:n}=G(t),a=L(()=>e.value._mode==="dynamic"),d=()=>{e.value._mode=e.value._mode==="dynamic"?"static":"dynamic"},y=c=>{e.value._mode==="dynamic"?e.value._dynExp=c.target.value:e.value._value=c.target.value};return(c,p)=>{const k=U,E=M,m=Y;return i(),v(m,{size:b(o),compact:b(n)},{default:u(()=>[r(k,P({value:a.value?e.value._dynExp:e.value._value,onChange:y,style:{width:"calc(100% - 35px)"},prefix:a.value?"{":"",suffix:a.value?"}":""},c.$attrs),null,16,["value","prefix","suffix"]),r(E,{title:a.value?`绑定中:${e.value._dynExp}`:"变量绑定",type:a.value?"primary":"",onClick:p[0]||(p[0]=l=>d())},{icon:u(()=>[re]),_:1},8,["title","type"])]),_:1},8,["size","compact"])}}}),pe=s=>(q("data-v-dcd1c0f1"),s=s(),F(),s),me={class:"config-select"},_e=pe(()=>N("div",{class:"iconfont icon-brackets-curly"},null,-1)),ve=I({__name:"ConfigSelect",props:{data:{required:!0,default:{_value:"",_mode:"static",_dynExp:""}},dataModifiers:{}},emits:["update:data"],setup(s){const e=D(s,"data"),t=L(()=>e.value._mode==="dynamic"),o=()=>{e.value._mode=e.value._mode==="dynamic"?"static":"dynamic"};return(n,a)=>{const d=Z,y=U,c=M;return i(),w("div",me,[t.value?(i(),v(y,{key:1,value:e.value._dynExp,"onUpdate:value":a[1]||(a[1]=p=>e.value._dynExp=p),style:{width:"calc(100% - 35px)"},prefix:"{",suffix:"}"},null,8,["value"])):(i(),v(d,P({key:0,style:{width:"calc(100% - 35px)"}},n.$attrs,{value:e.value._value,"onUpdate:value":a[0]||(a[0]=p=>e.value._value=p)}),null,16,["value"])),r(c,{title:t.value?`绑定中:${e.value._dynExp}`:"变量绑定",type:t.value?"primary":"",onClick:a[2]||(a[2]=p=>o())},{icon:u(()=>[_e]),_:1},8,["title","type"])])}}}),ye=W(ve,[["__scopeId","data-v-dcd1c0f1"]]),fe=s=>(q("data-v-8fc419f7"),s=s(),F(),s),he={class:"config-radio"},xe=fe(()=>N("div",{class:"iconfont icon-brackets-curly"},null,-1)),ge=I({__name:"ConfigRadio",props:z({options:{default:()=>[]},fields:{default:()=>({label:"label",value:"value",title:"title"})},icon:{type:Boolean,default:!1}},{data:{required:!0,default:{_value:"",_mode:"static",_dynExp:""}},dataModifiers:{}}),emits:["update:data"],setup(s){const e=D(s,"data"),t=s,{options:o,fields:n}=G(t),a=L(()=>e.value._mode==="dynamic"),d=()=>{e.value._mode=e.value._mode==="dynamic"?"static":"dynamic"};return(y,c)=>{const p=te,k=ae,E=U,m=M;return i(),w("div",he,[a.value?(i(),v(E,{key:1,value:e.value._dynExp,"onUpdate:value":c[1]||(c[1]=l=>e.value._dynExp=l),style:{width:"calc(100% - 35px)"},prefix:"{",suffix:"}"},null,8,["value"])):(i(),v(k,P({key:0},y.$attrs,{style:{width:"calc(100% - 35px)"},value:e.value._value,"onUpdate:value":c[0]||(c[0]=l=>e.value._value=l),"button-style":"solid"}),{default:u(()=>[(i(!0),w(B,null,R(b(o),l=>(i(),v(p,{key:l[b(n).value],title:l[b(n).title]||l[b(n).label],value:l[b(n).value]},{default:u(()=>[y.icon?(i(),w("div",{key:0,class:ee(["iconfont",l.label])},null,2)):(i(),w(B,{key:1},[$(K(l[b(n).label]),1)],64))]),_:2},1032,["title","value"]))),128))]),_:1},16,["value"])),r(m,{title:a.value?`绑定中:${e.value._dynExp}`:"变量绑定",type:a.value?"primary":"",onClick:c[2]||(c[2]=l=>d())},{icon:u(()=>[xe]),_:1},8,["title","type"])])}}}),be=W(ge,[["__scopeId","data-v-8fc419f7"]]);class ke{constructor(e){C(this,"libs");C(this,"scripts",[]);C(this,"styles",[]);C(this,"componentsMap",new Map);C(this,"components",{});this.libs=e,this.init()}init(){window.Vue||(window.Vue=ne),this.handleLibs(),this.handleUrls()}handleUrls(){this.libs.map(t=>t.urls).flat().forEach(t=>{t.endsWith("js")?this.scripts.push(t):t.endsWith("css")&&this.styles.push(t)})}load(){return new Promise((e,t)=>{Promise.allSettled([...this.styles.map(o=>this.loadStyle(o)),...this.scripts.map(o=>this.loadScript(o))]).then(()=>{this.registerComponents(),e(this.components)}).catch(o=>{t(o)})})}registerComponents(){for(const[e,t]of this.componentsMap)Array.isArray(t)?t.forEach(o=>{this.components[o.componentName]=window[e][o.exportName]}):this.components[t.componentName]=window[t.exportName]}handleLibChildren(e){const t=e.children.map(o=>({exportName:o.exportName,componentName:o.componentName}));this.componentsMap.set(e.exportName,t)}handleLibs(e=this.libs){e.forEach(t=>{this.isLibTree(t)?this.handleLibChildren(t):this.componentsMap.set(t.exportName,{exportName:t.exportName,componentName:t.componentName})})}isLibTree(e){return"children"in e}loadScript(e){return new Promise((t,o)=>{const n=document.createElement("script");n.src=e,n.async=!1,n.onload=t,n.onerror=o,document.body.appendChild(n)})}loadStyle(e){return new Promise((t,o)=>{const n=document.createElement("link");n.rel="stylesheet",n.href=e,n.onload=t,n.onerror=o,document.head.appendChild(n)})}}const Ee={class:"config-array"},we=N("div",{class:"iconfont icon-brackets-curly"},null,-1),Se=N("div",{class:"iconfont icon-brackets-curly"},null,-1),Ce=I({__name:"ConfigArray",props:z({title:{default:"标题"},closable:{type:Boolean,default:!0}},{data:{required:!0,default:{_value:[],_mode:"static",_dynExp:""}},dataModifiers:{}}),emits:["update:data"],setup(s){const e=s,{title:t,closable:o}=G(e),n=_(0),a=D(s,"data"),d=L(()=>a.value._mode==="dynamic"),y=()=>{a.value._mode=a.value._mode==="dynamic"?"static":"dynamic"},c=_(0),p=()=>{n.value=++c.value,a.value._value.push({})},k=m=>{let l=0;a.value._value.forEach((S,h)=>{S.key===m&&(l=h-1)}),a.value._value=a.value._value.filter(S=>S.key!==m),a.value._value.length&&n.value===m&&(l>=0?n.value=a.value._value[l].key:n.value=a.value._value[0].key)},E=(m,l)=>{l==="add"?p():k(m)};return(m,l)=>{const S=oe,h=M,x=le,j=U;return i(),w("div",Ee,[d.value?T("",!0):(i(),v(x,{key:0,activeKey:n.value,"onUpdate:activeKey":l[1]||(l[1]=f=>n.value=f),type:"editable-card",onEdit:E,class:"config-array-tab"},{rightExtra:u(()=>[r(h,{title:d.value?`绑定中:${a.value._dynExp}`:"变量绑定",type:d.value?"primary":"",onClick:l[0]||(l[0]=f=>y())},{icon:u(()=>[we]),_:1},8,["title","type"])]),default:u(()=>[(i(!0),w(B,null,R(a.value._value,(f,V)=>(i(),v(S,{key:V+1,tab:`${b(t)}${V+1}`,closable:b(o)},{default:u(()=>[$(" #TODO 表单渲染组件 ")]),_:2},1032,["tab","closable"]))),128))]),_:1},8,["activeKey"])),d.value?(i(),v(j,{key:1,value:a.value._dynExp,"onUpdate:value":l[2]||(l[2]=f=>a.value._dynExp=f),style:{width:"calc(100% - 35px)"},prefix:"{",suffix:"}"},null,8,["value"])):T("",!0),d.value?(i(),v(h,{key:2,title:d.value?`绑定中:${a.value._dynExp}`:"变量绑定",type:d.value?"primary":"",onClick:l[3]||(l[3]=f=>y())},{icon:u(()=>[Se]),_:1},8,["title","type"])):T("",!0)])}}}),Ve=I({__name:"HomeView",setup(s){const e=_({input:{_value:"",_mode:"static",_dynExp:""},select:{_value:"",_mode:"static",_dynExp:""},test:"123",radio:{},arr:{_value:[{title:"测试"}],_mode:"static",_dynExp:""}}),t=_({string:"配置表单",arr:[1,2,3,4],number:125654}),o=_([{label:"1",value:"1"},{label:"2",value:"2"}]),n=_([{label:"icon-lock1",value:"1",title:"锁定"},{label:"icon-unlock1",value:"2",title:"解锁"}]),a=_(!1),d=()=>{e.value,a.value=!0},y=()=>{new ce(t.value).processObject(e.value)},c=_("测试");_({package:"ConfigInput",version:"",exportName:"",main:"",cdn:"",componentName:""});const p=[{title:"element",package:"element-plus",version:"1.0.2",exportName:"ElementPlus",urls:["https://cdn.jsdelivr.net/npm/element-plus@2.9.2/dist/index.full.min.js","https://cdn.jsdelivr.net/npm/element-plus@2.9.2/dist/index.min.css"],children:[{componentName:"ElButton",exportName:"ElButton"},{componentName:"ElInput",exportName:"ElInput"}]},{title:"",package:"drag-grid-layout-v3",version:"1.0.0",exportName:"drag-grid-layout-v3",children:[{componentName:"GridLayout",exportName:"GridLayout"}],urls:["https://cdn.jsdelivr.net/npm/drag-grid-layout-v3@0.0.4/lib/drag-grid-layout-v3.umd.js","https://cdn.jsdelivr.net/npm/drag-grid-layout-v3@0.0.4/lib/style.css"]}],k=_(),E=_(),m=_(),l=new ke(p),S=_([{key:1,id:1,rowStart:1,colStart:1,rowSpan:20,colSpan:3,extra:{color:"red"}},{key:1,id:2,rowStart:2,colStart:4,rowSpan:40,colSpan:2,extra:{color:"blue"}},{key:1,id:3,rowStart:4,colStart:6,rowSpan:10,colSpan:5,extra:{color:"pink"}},{key:1,id:4,rowStart:5,colStart:1,rowSpan:30,colSpan:6,extra:{color:"green"}}]);return l.load().then(h=>{k.value=h.ElButton,E.value=h.ElInput,m.value=h.GridLayout}),(h,x)=>{const j=Q,f=ue,V=se,A=M;return i(),w(B,null,[r(j,{value:JSON.stringify(t.value,null,4),disabled:""},null,8,["value"]),r(V,null,{default:u(()=>[r(f,{label:"输入框"},{default:u(()=>[r(de,{data:e.value.input,"onUpdate:data":x[0]||(x[0]=g=>e.value.input=g)},null,8,["data"])]),_:1}),r(f,{label:"选择框"},{default:u(()=>[r(ye,{data:e.value.select,"onUpdate:data":x[1]||(x[1]=g=>e.value.select=g),options:o.value},null,8,["data","options"])]),_:1}),r(f,{label:"单选框"},{default:u(()=>[r(be,{data:e.value.radio,"onUpdate:data":x[2]||(x[2]=g=>e.value.radio=g),options:n.value,icon:!0},null,8,["data","options"])]),_:1}),r(f,{label:"数组"},{default:u(()=>[r(Ce,{data:e.value.arr,"onUpdate:data":x[3]||(x[3]=g=>e.value.arr=g),title:"数组",closable:""},null,8,["data"])]),_:1})]),_:1}),r(A,{onClick:d},{default:u(()=>[$("配置项")]),_:1}),r(A,{onClick:y},{default:u(()=>[$("数据")]),_:1}),(i(),v(O(k.value),{type:"success"},{default:u(()=>[$("el")]),_:1})),(i(),v(O(E.value),{placeholder:"请输入内容",Value:c.value},null,8,["Value"])),(i(),v(O(m.value),{placeholder:"请输入内容",list:S.value},{"layout-item":u(({item:g})=>[N("div",{style:ie({backgroundColor:g.extra.color,width:"100%",height:"100%"})},K(g),5)]),_:1},8,["list"]))],64)}}});export{Ve as default};
