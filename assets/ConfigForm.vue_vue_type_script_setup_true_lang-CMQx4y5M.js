var q=Object.defineProperty;var K=(o,e,a)=>e in o?q(o,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):o[e]=a;var B=(o,e,a)=>(K(o,typeof e!="symbol"?e+"":e,a),a);import{t as N,g,E as $,r as A,o as c,y as h,l as b,w as y,M as x,T as D,h as v,i as d,b2 as L,b1 as W,J as O,K as C,O as E,aS as w,F as S,a4 as I,R as U,bx as G,G as J,L as P,I as X,aa as H,ab as Q,an as j,ao as M,W as Y,aX as Z,aT as ee,aU as te,aV as ae,aW as ne,a6 as oe,B as le,a3 as T,a5 as se}from"./.pnpm-BfHkGPSW.js";import{_ as V}from"./_plugin-vue_export-helper-DlAUqK2U.js";class De{constructor(e){B(this,"state",{});e&&(this.state=e)}getValue(e){const{_value:a,_mode:l,_dynExp:n}=e;return l==="static"?a:this.resolveDynamicValue(n)}createDynamicConfigData(e){return{_value:e||"",_mode:"static",_dynExp:""}}resolveDynamicValue(e){try{return new Function("state",`return ${e}`)(this.state)}catch(a){return console.error("评估动态表达式时出错:",a),null}}isDynamicConfigData(e){return typeof e=="object"&&e!==null&&["static","dynamic"].includes(e._mode)}processObject(e){const a=N(e);if(Array.isArray(a))return a.map(l=>this.processObject(l));if(typeof a=="object"&&a!==null){const l={};for(const n in a){const t=a[n];this.isDynamicConfigData(t)?l[n]=this.getValue(t):typeof t=="object"&&t!==null?l[n]=this.processObject(t):l[n]=t}return l}else return a}}const ue={class:"config-array"},ce=g({__name:"ConfigArray",props:{title:{default:"标题"},closable:{type:Boolean,default:!0},schema:{default:()=>({})},data:{}},setup(o){const e=o,{title:a,closable:l,data:n}=$(e),t=A(0),f=()=>{t.value=n.value.length||0,n.value.push({})},s=u=>{let p=0;n.value.forEach((r,m)=>{r.key===u&&(p=m-1)}),n.value=n.value.filter(r=>r.key!==u),n.value.length&&t.value===u&&(p>=0?t.value=n.value[p].key:t.value=n.value[0].key)},i=(u,p)=>{p==="add"?f():s(u)};return(u,p)=>{const r=L,m=W;return c(),h("div",ue,[b(m,{activeKey:t.value,"onUpdate:activeKey":p[0]||(p[0]=_=>t.value=_),type:"editable-card",onEdit:i,class:"config-array-tab",size:"small"},{default:y(()=>[(c(!0),h(x,null,D(d(n),(_,k)=>(c(),v(r,{key:k+1,tab:`${d(a)}${k+1}`,closable:d(l)},{default:y(()=>[b(F,{schema:u.schema,data:d(n)[k],"onUpdate:data":R=>d(n)[k]=R},null,8,["schema","data","onUpdate:data"])]),_:2},1032,["tab","closable"]))),128))]),_:1},8,["activeKey"])])}}}),ie=S("div",{class:"iconfont icon-brackets-curly"},null,-1),z=g({__name:"ConfigInput",props:O({compact:{type:Boolean,default:!0},size:{default:"default"}},{data:{required:!0,default:{_value:"",_mode:"static",_dynExp:""}},dataModifiers:{}}),emits:["update:data"],setup(o){const e=C(o,"data"),a=o,{size:l,compact:n}=$(a),t=E(()=>e.value._mode==="dynamic"),f=()=>{e.value._mode=e.value._mode==="dynamic"?"static":"dynamic"},s=i=>{e.value._mode==="dynamic"?e.value._dynExp=i.target.value:e.value._value=i.target.value};return(i,u)=>{const p=I,r=U,m=G;return c(),v(m,{size:d(l),compact:d(n)},{default:y(()=>[b(p,w({value:t.value?e.value._dynExp:e.value._value,onChange:s,style:{width:"calc(100% - 35px)"},prefix:t.value?"{":"",suffix:t.value?"}":""},i.$attrs),null,16,["value","prefix","suffix"]),b(r,{title:t.value?`绑定中:${e.value._dynExp}`:"变量绑定",type:t.value?"primary":"",onClick:u[0]||(u[0]=_=>f())},{icon:y(()=>[ie]),_:1},8,["title","type"])]),_:1},8,["size","compact"])}}}),de=o=>(j("data-v-8fc419f7"),o=o(),M(),o),re={class:"config-radio"},_e=de(()=>S("div",{class:"iconfont icon-brackets-curly"},null,-1)),pe=g({__name:"ConfigRadio",props:O({options:{default:()=>[]},fields:{default:()=>({label:"label",value:"value",title:"title"})},icon:{type:Boolean,default:!1}},{data:{required:!0,default:{_value:"",_mode:"static",_dynExp:""}},dataModifiers:{}}),emits:["update:data"],setup(o){const e=C(o,"data"),a=o,{options:l,fields:n}=$(a),t=E(()=>e.value._mode==="dynamic"),f=()=>{e.value._mode=e.value._mode==="dynamic"?"static":"dynamic"};return(s,i)=>{const u=H,p=Q,r=I,m=U;return c(),h("div",re,[t.value?(c(),v(r,{key:1,value:e.value._dynExp,"onUpdate:value":i[1]||(i[1]=_=>e.value._dynExp=_),style:{width:"calc(100% - 35px)"},prefix:"{",suffix:"}"},null,8,["value"])):(c(),v(p,w({key:0},s.$attrs,{style:{width:"calc(100% - 35px)"},value:e.value._value,"onUpdate:value":i[0]||(i[0]=_=>e.value._value=_),"button-style":"solid"}),{default:y(()=>[(c(!0),h(x,null,D(d(l),_=>(c(),v(u,{key:_[d(n).value],title:_[d(n).title]||_[d(n).label],value:_[d(n).value]},{default:y(()=>[s.icon?(c(),h("div",{key:0,class:J(["iconfont",_.label])},null,2)):(c(),h(x,{key:1},[P(X(_[d(n).label]),1)],64))]),_:2},1032,["title","value"]))),128))]),_:1},16,["value"])),b(m,{title:t.value?`绑定中:${e.value._dynExp}`:"变量绑定",type:t.value?"primary":"",onClick:i[2]||(i[2]=_=>f())},{icon:y(()=>[_e]),_:1},8,["title","type"])])}}}),ve=V(pe,[["__scopeId","data-v-8fc419f7"]]),me=o=>(j("data-v-dcd1c0f1"),o=o(),M(),o),fe={class:"config-select"},ye=me(()=>S("div",{class:"iconfont icon-brackets-curly"},null,-1)),he=g({__name:"ConfigSelect",props:{data:{required:!0,default:{_value:"",_mode:"static",_dynExp:""}},dataModifiers:{}},emits:["update:data"],setup(o){const e=C(o,"data"),a=E(()=>e.value._mode==="dynamic"),l=()=>{e.value._mode=e.value._mode==="dynamic"?"static":"dynamic"};return(n,t)=>{const f=Y,s=I,i=U;return c(),h("div",fe,[a.value?(c(),v(s,{key:1,value:e.value._dynExp,"onUpdate:value":t[1]||(t[1]=u=>e.value._dynExp=u),style:{width:"calc(100% - 35px)"},prefix:"{",suffix:"}"},null,8,["value"])):(c(),v(f,w({key:0,style:{width:"calc(100% - 35px)"}},n.$attrs,{value:e.value._value,"onUpdate:value":t[0]||(t[0]=u=>e.value._value=u)}),null,16,["value"])),b(i,{title:a.value?`绑定中:${e.value._dynExp}`:"变量绑定",type:a.value?"primary":"",onClick:t[2]||(t[2]=u=>l())},{icon:y(()=>[ye]),_:1},8,["title","type"])])}}}),be=V(he,[["__scopeId","data-v-dcd1c0f1"]]),ge=o=>(j("data-v-4206e5c3"),o=o(),M(),o),xe={class:"config-switch"},$e=ge(()=>S("div",{class:"iconfont icon-brackets-curly"},null,-1)),ke=g({__name:"ConfigSwitch",props:{data:{required:!0,default:{__value:!1,_mode:"static",_dynExp:""}},dataModifiers:{}},emits:["update:data"],setup(o){const e=C(o,"data"),a=E(()=>e.value._mode==="dynamic"),l=()=>{e.value._mode=e.value._mode==="dynamic"?"static":"dynamic"};return(n,t)=>{const f=Z,s=I,i=U;return c(),h("div",xe,[a.value?(c(),v(s,{key:1,value:e.value._dynExp,"onUpdate:value":t[1]||(t[1]=u=>e.value._dynExp=u),style:{width:"calc(100% - 35px)"},prefix:"{",suffix:"}"},null,8,["value"])):(c(),v(f,w({key:0},n.$attrs,{checked:e.value._value,"onUpdate:checked":t[0]||(t[0]=u=>e.value._value=u)}),null,16,["checked"])),b(i,{title:a.value?`绑定中:${e.value._dynExp}`:"变量绑定",type:a.value?"primary":"",onClick:t[2]||(t[2]=u=>l())},{icon:y(()=>[$e]),_:1},8,["title","type"])])}}}),Ce=V(ke,[["__scopeId","data-v-4206e5c3"]]),Ee={class:"config-array"},we=g({__name:"ConfigObject",props:{title:{default:"标题"},field:{default:""},schema:{default:()=>({})},data:{}},setup(o){const e=o,{title:a,field:l,data:n}=$(e),t=ee()+l.value;return(f,s)=>{const i=ae,u=ne;return c(),h("div",Ee,[b(u,null,{default:y(()=>[(c(),v(i,{key:t,header:d(a)},{default:y(()=>[b(F,{schema:f.schema,data:d(n),"onUpdate:data":s[0]||(s[0]=p=>te(n)?n.value=p:null)},null,8,["schema","data"])]),_:1},8,["header"]))]),_:1})])}}}),F=g({__name:"ConfigForm",props:{schema:{default:()=>({})},data:{default:()=>({})}},setup(o){const e=o,{schema:a,data:l}=$(e),n=()=>{Object.keys(a.value).forEach(s=>{l.value[s]?typeof l.value[s]!="object"&&(l.value[s]=t(a.value[s].type,l.value[s])):l.value[s]=t(a.value[s].type)})},t=(s,i)=>{switch(s){case"array":return[];case"object":return{};case"input":case"select":case"radio":return{_value:i||"",_mode:"static",_dynExp:""};case"switch":return{_value:typeof i=="boolean"?i:!1,_mode:"static",_dynExp:""};default:return{_value:i||"",_mode:"static",_dynExp:""}}};n();const f=s=>{switch(s){case"input":return z;case"radio":return ve;case"select":return be;case"switch":return Ce;default:return z}};return(s,i)=>{const u=se,p=oe;return c(),v(p,{model:d(l)},{default:y(()=>[(c(!0),h(x,null,D(d(a),(r,m)=>(c(),h(x,{key:m},[r.type!=="object"?(c(),v(u,{key:0,label:r.label,name:m},{default:y(()=>[r.type==="array"?(c(),v(ce,{key:0,schema:r.items,data:d(l)[m]},null,8,["schema","data"])):(c(),v(le(f(r.type)),{key:1,data:d(l)[m],"onUpdate:data":_=>d(l)[m]=_},null,40,["data","onUpdate:data"]))]),_:2},1032,["label","name"])):T("",!0),r.type==="object"?(c(),v(we,{key:1,schema:r.properties,data:d(l)[m],title:r.label},null,8,["schema","data","title"])):T("",!0)],64))),128))]),_:1},8,["model"])}}});export{De as D,F as _};
