import{_ as ue}from"./CodeEditor.vue_vue_type_script_setup_true_name_EvCode_lang-af-FBJ48.js";import{c as re}from"./componentsSchema-CXBH1gc0.js";import{f as de,r as f,Q as A,g as z,s as F,x as J,o as c,y as g,B as n,O as q,W as V,J as ie,K as H,l as e,i as w,ak as P,N as U,w as a,t as ce,v as K,a2 as X,ap as Z,aq as ee,bh as j,a6 as te,a7 as ae,U as Q,b6 as le,a8 as oe,b2 as pe,h as ne,b3 as me,I as _e,b4 as ve,Y as fe}from"./.pnpm-CNbA6tN1.js";import{_ as Y}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as be}from"./ConfigForm.vue_vue_type_script_setup_true_lang-B_ycgKLR.js";import{S as ge}from"./SchemaForm-CCK807lg.js";import"./main-BmbtOdKc.js";import"./iconfont-RswF9Ywb.js";/* empty css                   */const G=de("dashboardDesign",()=>{const u=f([]),h=d=>{u.value.push(d)},y=A(()=>{const d={};return u.value.map(p=>{p.children.forEach(b=>{d[b.componentName]=b.schema})}),d}),D=A(()=>{let d=[];return u.value.forEach(p=>{const b=p.children.map(x=>({label:x.componentName,value:x.exportName}));d=d.concat(b)}),d}),N=f({datasets:[],vars:[{name:"test",type:"string",defaultValue:"这是一段测试文本"}]});return{customModules:u,customCompSchema:y,onAddModules:h,customComps:D,varPools:N,getContentWindow:()=>document.querySelector(".standalone-iframe").contentWindow}}),se=u=>(Z("data-v-168494c5"),u=u(),ee(),u),ye={class:"material-area"},he={class:"material-layout-area"},xe=se(()=>n("div",{class:"title"},"内置组件",-1)),Ce={class:"content"},ke=["data-material"],Se={class:"material-label"},we={class:"material-data-area"},De=se(()=>n("div",{class:"title"},"自定义组件",-1)),Ne={class:"content"},Ue=["data-material"],$e={style:{height:"650px"}},Me={style:{height:"80px","overflow-y":"auto"}},Ie={style:{height:"200px","overflow-y":"auto"}},qe=z({__name:"MaterialArea",setup(u){const h=G(),{customModules:y,customComps:D}=F(h),{onAddModules:N}=h,r=f({internalComp:re,customComp:[]}),d=_=>{var i,s;const o=_.target;(i=_.dataTransfer)==null||i.setData("material",o.dataset.material),(s=_.dataTransfer)==null||s.setData("material-type",o.dataset.materialType)},p=f(!1),b=()=>{p.value=!0,l.value=ce(x.value)},x=f({title:"element",package:"element-plus",version:"2.9.2",exportName:"ElementPlus",urls:["https://cdn.jsdelivr.net/npm/element-plus@2.9.2/dist/index.full.min.js","https://cdn.jsdelivr.net/npm/element-plus@2.9.2/dist/index.min.css"],children:[{componentName:"ElButton",exportName:"ElButton",id:"1",schema:`{
    "type": {
        "type": "input",
        "label": "按钮类型"
    }

      }`}]}),l=f({}),$=()=>{p.value=!1},C=()=>{N(l.value),r.value.customComp=r.value.customComp.concat(D.value),k==null||k.postMessage({type:"add-custom-comp",data:K(l.value)}),$()},T=()=>{l.value.children.push({componentName:"",exportName:"",id:new Date().getTime().toString()})},M=_=>{const o=l.value.children.findIndex(i=>i.id==_.id);o!=-1&&l.value.children.splice(o,1)},I=()=>{l.value.urls.push("")},m=_=>{const o=l.value.urls.findIndex(i=>i==_);o!=-1&&l.value.urls.splice(o,1)};let k=null;return J(()=>{k=document.querySelector(".standalone-iframe").contentWindow}),(_,o)=>{const i=te,s=ae,W=Q,B=le,E=ue,v=oe,O=X;return c(),g("div",ye,[n("div",he,[xe,n("div",Ce,[(c(!0),g(q,null,V(r.value.internalComp,t=>(c(),g("div",{key:t.name,draggable:"true",onDragstart:d,"data-material":t.name,"data-material-type":"internal",class:"material-item"},[n("span",{class:ie(["iconfont material-icon",t.icon])},null,2),n("span",Se,H(t.label),1)],40,ke))),128))])]),n("div",we,[De,n("div",Ne,[(c(!0),g(q,null,V(r.value.customComp,t=>(c(),g("div",{type:"dashed",key:t.value,draggable:"true",onDragstart:d,"data-material":t.value,"data-material-type":"custom",class:"material-item"},H(t.label),41,Ue))),128)),n("div",{type:"dashed",onClick:b,class:"material-item"},[n("span",null,[e(w(P)),U(" 添加组件 ")])])])]),e(O,{title:"添加自定义组件",width:"800px",open:p.value,"onUpdate:open":o[4]||(o[4]=t=>p.value=t),onOk:C,onCancel:$},{default:a(()=>[n("div",$e,[e(v,{model:l.value,"label-col":{style:{width:"150px"}}},{default:a(()=>[e(s,{label:"名称"},{default:a(()=>[e(i,{value:l.value.title,"onUpdate:value":o[0]||(o[0]=t=>l.value.title=t)},null,8,["value"])]),_:1}),e(s,{label:"组件库名称"},{default:a(()=>[e(i,{value:l.value.package,"onUpdate:value":o[1]||(o[1]=t=>l.value.package=t)},null,8,["value"])]),_:1}),e(s,{label:"版本"},{default:a(()=>[e(i,{value:l.value.version,"onUpdate:value":o[2]||(o[2]=t=>l.value.version=t)},null,8,["value"])]),_:1}),e(s,{label:"导出名称"},{default:a(()=>[e(i,{value:l.value.exportName,"onUpdate:value":o[3]||(o[3]=t=>l.value.exportName=t)},null,8,["value"])]),_:1}),e(s,{label:"CDN地址"},{default:a(()=>[n("div",Me,[(c(!0),g(q,null,V(l.value.urls,(t,L)=>(c(),g("div",{key:t,style:{display:"flex","margin-bottom":"8px"},align:"baseline"},[e(i,{value:l.value.urls[L],"onUpdate:value":S=>l.value.urls[L]=S},null,8,["value","onUpdate:value"]),e(w(j),{onClick:S=>m(t),style:{padding:"0 10px"}},null,8,["onClick"])]))),128))]),e(s,null,{default:a(()=>[e(W,{type:"dashed",block:"",onClick:I},{default:a(()=>[e(w(P)),U(" 增加CDN地址 ")]),_:1})]),_:1})]),_:1}),e(s,{label:"子组件"},{default:a(()=>[n("div",Ie,[(c(!0),g(q,null,V(l.value.children,(t,L)=>(c(),g("div",{key:t.id,style:{display:"flex","margin-bottom":"8px","border-bottom":"1px solid #ccc"},align:"baseline"},[e(B,null,{default:a(()=>[n("div",null,[e(B,null,{default:a(()=>[e(s,{label:"组件名",rules:{required:!0}},{default:a(()=>[e(i,{value:t.componentName,"onUpdate:value":S=>t.componentName=S},null,8,["value","onUpdate:value"])]),_:2},1024),e(s,{label:"导出名称",rules:{required:!0}},{default:a(()=>[e(i,{value:t.exportName,"onUpdate:value":S=>t.exportName=S},null,8,["value","onUpdate:value"])]),_:2},1024)]),_:2},1024),e(s,{label:"配置Schema",rules:{required:!0}},{default:a(()=>[e(E,{value:t.schema,"onUpdate:value":S=>t.schema=S,theme:"light",height:"110"},null,8,["value","onUpdate:value"])]),_:2},1024)]),e(w(j),{onClick:S=>M(t)},null,8,["onClick"])]),_:2},1024)]))),128))]),e(s,null,{default:a(()=>[e(W,{type:"dashed",block:"",onClick:T},{default:a(()=>[e(w(P)),U(" 增加子组件 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])])]),_:1},8,["open"])])}}}),Ve=Y(qe,[["__scopeId","data-v-168494c5"]]),Te={text:{type:"input",label:"文本内容"}},We={src:{type:"input",label:"图片地址"}},Be={src:{type:"input",label:"页面地址"}},Pe=u=>({dataset:{type:"select",label:"数据集",options:u},dimension:{type:"select",label:"维度",options:[],mode:"multiple"},target:{type:"select",label:"指标",options:[],mode:"multiple"}}),R={"qb-text":Te,"qb-image":We,"qb-iframe":Be,"qb-chart":Pe},Ee={title1:{type:"divider",label:"布局",component:{title:"布局"},formLayout:!1},paddingLeft:{type:"string",label:"左边距",tooltip:"请注明单位，一般为：px"},paddingTop:{type:"string",label:"上边距",tooltip:"请注明单位，一般为：px"},paddingRight:{type:"string",label:"右边距",tooltip:"请注明单位，一般为：px"},paddingBottom:{type:"string",label:"下边距",tooltip:"请注明单位，一般为：px"},title2:{type:"divider",label:"背景",component:{title:"背景"},formLayout:!1},backgroundColor:{type:"string",label:"背景色",component:{name:"color-picker"}},title3:{type:"divider",label:"边框",component:{title:"边框"},formLayout:!1},borderWidth:{type:"string",label:"边框宽度",tooltip:"请注明单位，一般为：px"},borderColor:{type:"string",label:"边框颜色",component:{name:"color-picker"}},borderStyle:{type:"radio",label:"边框样式",component:{dataSource:[{label:"无边框",value:"none"},{label:"虚线",value:"dashed"},{label:"实线",value:"solid"}],buttonStyle:"solid"}},borderRadius:{type:"string",label:"边框圆角",tooltip:"请注明单位，可以为%或者px"}},Oe={class:"material-cfg"},Le={class:"material-cfg-btn"},Re=z({__name:"MaterialCfg",setup(u){const h=G(),{customCompSchema:y}=F(h),{getContentWindow:D}=h,N=f({}),r=f({}),d=f({}),p=f({}),b=f({layout:{labelAlign:"left",layout:"horizontal",labelCol:{style:{width:"100px"}}},properties:Ee});window.addEventListener("message",C=>{C.data.type==="select"&&(r.value=C.data.data,r.value,r.value.type==="custom"?y.value&&(d.value=JSON.parse(y.value[r.value.component])):typeof R[r.value.component]=="function"?d.value=R[r.value.component]([]):d.value=R[r.value.component],N.value=C.data.data.props,p.value=r.value.style)});let x=null;const l=C=>{if(x)x.postMessage({type:"refresh",data:C});else throw new Error("contentWindow is null")},$=()=>{l(K(r.value))};return J(()=>{x=D()}),(C,T)=>{const M=me,I=pe,m=Q;return c(),g("div",Oe,[e(I,{size:"small"},{default:a(()=>[e(M,{key:"prop",tab:"属性"},{default:a(()=>[(c(),ne(be,{class:"material-cfg-contain",key:r.value.id,data:N.value,schema:d.value},null,8,["data","schema"]))]),_:1}),e(M,{key:"style",tab:"样式"},{default:a(()=>[e(w(ge),{schema:b.value,size:"small",formData:p.value},null,8,["schema","formData"])]),_:1})]),_:1}),n("div",Le,[e(m,{onClick:$},{default:a(()=>[U("刷新")]),_:1})])])}}}),Ae=Y(Re,[["__scopeId","data-v-c4a772f5"]]),je=u=>(Z("data-v-9747f432"),u=u(),ee(),u),ze={class:"dg-design"},Fe={class:"dg-design-container"},Je=je(()=>n("div",{class:"middle-part"},[n("iframe",{width:"100%",height:"100%",src:"/standalone/standalone.html",style:{border:"0"},class:"standalone-iframe"})],-1)),Ke={style:{height:"300px","overflow-y":"auto"}},Qe=z({__name:"DashboardDesign",props:{id:{}},setup(u){const h=G(),{varPools:y}=F(h);let D;const{getContentWindow:N}=h;window.name="dg-design";const r=u,{id:d}=_e(r),p=A(()=>d.value),b=f(!1),x=()=>{b.value=!0},l=()=>{};J(()=>{D=N()});const $=()=>{D.postMessage({type:"refresh-var",data:K(y.value)})},C=()=>{y.value.vars.push({name:"",type:"",defaultValue:""})},T=f([{label:"字符串",value:"string"},{label:"数字",value:"number"},{label:"布尔",value:"boolean"},{label:"数组",value:"array"},{label:"对象",value:"object"}]),M=I=>{const m=y.value.vars.findIndex(k=>k.name===I.name);m!=-1&&y.value.vars.splice(m,1)};return(I,m)=>{const k=te,_=le,o=Q,i=ve,s=ae,W=fe,B=oe,E=X;return c(),g(q,null,[n("div",ze,[e(i,{subTitle:p.value,ghost:!1,style:{border:"1px solid rgb(235, 237, 240)",padding:"10px 24px"}},{title:a(()=>[e(k,{bordered:!1,class:"form-name"})]),extra:a(()=>[e(_),e(_),e(_,null,{default:a(()=>[e(o,{type:"primary",onClick:m[0]||(m[0]=v=>x())},{default:a(()=>[U("变量池")]),_:1}),e(o,{class:"preview-btn"},{default:a(()=>[U(" 预览 ")]),_:1}),e(o,{onClick:m[1]||(m[1]=v=>l()),type:"primary",class:"save-btn"},{default:a(()=>[U(" 保存 ")]),_:1})]),_:1})]),_:1},8,["subTitle"]),n("div",Fe,[e(Ve,{class:"left-part"}),Je,e(Ae,{class:"right-part"})])]),e(E,{title:"变量池",open:b.value,"onUpdate:open":m[2]||(m[2]=v=>b.value=v),width:"800px",footer:null,onCancel:$},{default:a(()=>[e(B,null,{default:a(()=>[n("div",Ke,[(c(!0),g(q,null,V(w(y).vars,(v,O)=>(c(),ne(_,{key:O,style:{display:"flex","margin-bottom":"8px"},align:"baseline"},{default:a(()=>[e(s,{label:"变量名",required:!0},{default:a(()=>[e(k,{value:v.name,"onUpdate:value":t=>v.name=t},null,8,["value","onUpdate:value"])]),_:2},1024),e(s,{label:"变量类型",required:!0},{default:a(()=>[e(W,{style:{width:"150px"},value:v.type,"onUpdate:value":t=>v.type=t,options:T.value},null,8,["value","onUpdate:value","options"])]),_:2},1024),e(s,{label:"默认值",required:!0},{default:a(()=>[e(k,{value:v.defaultValue,"onUpdate:value":t=>v.defaultValue=t},null,8,["value","onUpdate:value"])]),_:2},1024),e(w(j),{onClick:t=>M(v)},null,8,["onClick"])]),_:2},1024))),128))]),e(s,null,{default:a(()=>[e(o,{type:"dashed",block:"",onClick:C},{default:a(()=>[e(w(P)),U(" 添加变量 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])],64)}}}),ot=Y(Qe,[["__scopeId","data-v-9747f432"]]);export{ot as default};
